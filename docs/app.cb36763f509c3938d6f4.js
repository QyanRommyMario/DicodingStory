/*! For license information please see app.cb36763f509c3938d6f4.js.LICENSE.txt */
(()=>{"use strict";var t,e={177:(t,e,r)=>{r.d(e,{A:()=>s});var n=r(354),o=r.n(n),i=r(314),a=r.n(i)()(o());a.push([t.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/styles/styles.css"],names:[],mappings:"AAAA;QACS,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const s=a},903:(t,e,r)=>{r(153),r(612),r(423),r(426),r(303);var n=r(72),o=r.n(n),i=r(825),a=r.n(i),s=r(659),u=r.n(s),c=r(56),l=r.n(c),f=r(540),h=r.n(f),p=r(113),d=r.n(p),v=r(177),y={};y.styleTagTransform=d(),y.setAttributes=l(),y.insert=u().bind(null,"head"),y.domAPI=a(),y.insertStyleElement=h();o()(v.A,y);v.A&&v.A.locals&&v.A.locals;var m=r(465),g=r.n(m);function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function w(){w=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==b(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function S(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function P(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(b(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},_(x.prototype),u(x.prototype,a,(function(){return this})),e.AsyncIterator=x,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new x(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},_(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=P,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),S(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:P(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function _(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}var x=function(){var t,e=(t=w().mark((function t(){var e,r;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator){t.next=3;break}return t.abrupt("return",null);case 3:return t.prev=3,t.next=6,navigator.serviceWorker.register("/service-worker.js");case 6:return e=t.sent,r=!1,navigator.serviceWorker.addEventListener("controllerchange",(function(){r||(r=!0,window.location.reload())})),e.waiting&&k(e),e.addEventListener("updatefound",(function(){var t=e.installing;t.addEventListener("statechange",(function(){"installed"===t.state&&navigator.serviceWorker.controller?k(e):"activated"!==t.state||navigator.serviceWorker.controller||g().fire({title:"Aplikasi siap offline!",text:"Anda dapat menggunakan aplikasi ini tanpa koneksi internet.",icon:"success",confirmButtonColor:"#2563EB",confirmButtonText:"OK"})}))})),t.abrupt("return",e);case 15:return t.prev=15,t.t0=t.catch(3),t.abrupt("return",null);case 19:case"end":return t.stop()}}),t,null,[[3,15]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){_(i,n,o,a,s,"next",t)}function s(t){_(i,n,o,a,s,"throw",t)}a(void 0)}))});return function(){return e.apply(this,arguments)}}();function k(t){g().fire({title:"Update tersedia!",text:"Aplikasi telah diperbarui. Refresh untuk melihat versi terbaru.",icon:"info",showCancelButton:!0,confirmButtonColor:"#2563EB",cancelButtonColor:"#6B7280",confirmButtonText:"Refresh",cancelButtonText:"Nanti"}).then((function(e){e.isConfirmed&&function(t){if(!t.waiting)return;t.waiting.postMessage({type:"SKIP_WAITING"})}(t)}))}const E={BASE_URL:"https://story-api.dicoding.dev/v1",ENDPOINTS:{REGISTER:"/register",LOGIN:"/login",STORIES:"/stories",GUEST_STORY:"/stories/guest",NOTIFICATIONS_SUBSCRIBE:"/notifications/subscribe"},DEFAULT_HEADERS:{"Content-Type":"application/json"},MAP:{DEFAULT_CENTER:[-6.2088,106.8456],DEFAULT_ZOOM:13,TILE_LAYER:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",ATTRIBUTION:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',SECONDARY_TILE_LAYER:{name:"Satellite",url:"https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",attribution:"&copy; Google Maps",maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}},WEB_PUSH:{VAPID_PUBLIC_KEY:"BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk"}};function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function O(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return P(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?P(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function j(){j=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==S(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function O(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(S(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=O,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:O(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function T(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function I(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){T(i,n,o,a,s,"next",t)}function s(t){T(i,n,o,a,s,"throw",t)}a(void 0)}))}}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,C(n.key),n)}}function C(t){var e=function(t,e){if("object"!=S(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==S(e)?e:e+""}const B=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.baseURL=E.BASE_URL,this.defaultHeaders=E.DEFAULT_HEADERS},e=[{key:"_getToken",value:function(){return localStorage.getItem("auth_token")}},{key:"_getAuthHeader",value:function(){var t=this._getToken();return t?{Authorization:"Bearer ".concat(t)}:{}}},{key:"_handleResponse",value:(c=I(j().mark((function t(e){var r,n;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ok){t.next=6;break}return t.next=3,e.json().catch((function(){return{}}));case 3:throw r=t.sent,n=r.message||e.statusText||"Server error",new Error(n);case 6:return t.abrupt("return",e.json());case 7:case"end":return t.stop()}}),t)}))),function(t){return c.apply(this,arguments)})},{key:"_buildUrl",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URLSearchParams;Object.entries(e).forEach((function(t){var e=O(t,2),n=e[0],o=e[1];null!=o&&r.append(n,o)}));var n=r.toString();return"".concat(this.baseURL).concat(t).concat(n?"?".concat(n):"")}},{key:"_createHeaders",value:function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e={};return(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&Object.assign(e,this._getAuthHeader()),t?e["Content-Type"]=t:!1!==t&&Object.assign(e,this.defaultHeaders),e}},{key:"get",value:(u=I(j().mark((function t(e){var r,n,o,i,a,s=arguments;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=!(s.length>2&&void 0!==s[2])||s[2],o=this._buildUrl(e,r),i=this._createHeaders(n),t.next=6,fetch(o,{method:"GET",headers:i});case 6:return a=t.sent,t.abrupt("return",this._handleResponse(a));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"post",value:(s=I(j().mark((function t(e){var r,n,o,i,a,s=arguments;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=!(s.length>2&&void 0!==s[2])||s[2],o=this._buildUrl(e),i=this._createHeaders(n,"application/json"),t.next=6,fetch(o,{method:"POST",headers:i,body:JSON.stringify(r)});case 6:return a=t.sent,t.abrupt("return",this._handleResponse(a));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"postForm",value:(a=I(j().mark((function t(e,r){var n,o,i,a,s=arguments;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!(s.length>2&&void 0!==s[2])||s[2],o=this._buildUrl(e),i=this._createHeaders(n,!1),t.next=5,fetch(o,{method:"POST",headers:i,body:r});case 5:return a=t.sent,t.abrupt("return",this._handleResponse(a));case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"put",value:(i=I(j().mark((function t(e){var r,n,o,i,a,s=arguments;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=!(s.length>2&&void 0!==s[2])||s[2],o=this._buildUrl(e),i=this._createHeaders(n,"application/json"),t.next=6,fetch(o,{method:"PUT",headers:i,body:JSON.stringify(r)});case 6:return a=t.sent,t.abrupt("return",this._handleResponse(a));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"patch",value:(o=I(j().mark((function t(e){var r,n,o,i,a,s=arguments;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=!(s.length>2&&void 0!==s[2])||s[2],o=this._buildUrl(e),i=this._createHeaders(n,"application/json"),t.next=6,fetch(o,{method:"PATCH",headers:i,body:JSON.stringify(r)});case 6:return a=t.sent,t.abrupt("return",this._handleResponse(a));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"delete",value:(n=I(j().mark((function t(e){var r,n,o,i,a,s=arguments;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=!(s.length>2&&void 0!==s[2])||s[2],o=this._buildUrl(e),i=this._createHeaders(n,"application/json"),t.next=6,fetch(o,{method:"DELETE",headers:i,body:JSON.stringify(r)});case 6:return a=t.sent,t.abrupt("return",this._handleResponse(a));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})}],e&&N(t.prototype,e),r&&N(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s,u,c}());var A=r(148);function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function G(){G=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==F(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(F(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function R(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function M(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){R(i,n,o,a,s,"next",t)}function s(t){R(i,n,o,a,s,"throw",t)}a(void 0)}))}}var H="stories",D=(0,A.P2)("story-app-db",1,{upgrade:function(t){t.objectStoreNames.contains(H)||t.createObjectStore(H,{keyPath:"id"})}});const U={saveStory:function(t){return M(G().mark((function e(){var r,n,o;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D;case 3:return r=e.sent,n=r.transaction(H,"readwrite"),o=n.objectStore(H),e.next=8,o.put(t);case 8:return e.next=10,n.done;case 10:return e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))()},saveStories:function(t){return M(G().mark((function e(){var r,n,o;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D;case 3:return r=e.sent,n=r.transaction(H,"readwrite"),o=n.objectStore(H),e.next=8,Promise.all(t.map((function(t){return o.put(t)})));case 8:return e.next=10,n.done;case 10:return e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))()},getAllStories:function(){return M(G().mark((function t(){var e,r,n,o;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D;case 3:return e=t.sent,r=e.transaction(H,"readonly"),n=r.objectStore(H),t.next=8,n.getAll();case 8:return o=t.sent,t.abrupt("return",o);case 12:return t.prev=12,t.t0=t.catch(0),t.abrupt("return",[]);case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))()},getStoryById:function(t){return M(G().mark((function e(){var r,n,o,i;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D;case 3:return r=e.sent,n=r.transaction(H,"readonly"),o=n.objectStore(H),e.next=8,o.get(t);case 8:return i=e.sent,e.abrupt("return",i);case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},deleteStory:function(t){return M(G().mark((function e(){var r,n,o;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D;case 3:return r=e.sent,n=r.transaction(H,"readwrite"),o=n.objectStore(H),e.next=8,o.delete(t);case 8:return e.next=10,n.done;case 10:return e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))()},clearAllStories:function(){return M(G().mark((function t(){var e,r,n;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D;case 3:return e=t.sent,r=e.transaction(H,"readwrite"),n=r.objectStore(H),t.next=8,n.clear();case 8:return t.next=10,r.done;case 10:return t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t.catch(0),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,null,[[0,14]])})))()}};function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function q(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return z(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?z(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function W(){W=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Y(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Y(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function V(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function K(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){V(i,n,o,a,s,"next",t)}function s(t){V(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Q(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,J(n.key),n)}}function J(t){var e=function(t,e){if("object"!=Y(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Y(e)?e:e+""}var Z=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.offlineQueueKey="offline_story_queue",this.offlineAssetsKey="offline_story_assets",this.syncInProgress=!1,this._setupPeriodicSync()},e=[{key:"isOnline",value:function(){return navigator.onLine}},{key:"getStories",value:(g=K(W().mark((function t(){var e,r,n,o,i,a,s,u=arguments;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(e=u.length>0&&void 0!==u[0]?u[0]:{}).page,n=e.size,o=e.location,t.prev=1,!this.isOnline()){t.next=13;break}return t.next=5,B.get(E.ENDPOINTS.STORIES,{page:r,size:n,location:o});case 5:if(!1!==(i=t.sent).error||!i.listStory){t.next=10;break}return t.next=9,U.saveStories(i.listStory);case 9:this._cacheStoryImages(i.listStory);case 10:return t.abrupt("return",i);case 13:return t.next=15,U.getAllStories();case 15:return a=t.sent,t.abrupt("return",{error:!1,message:"Stories loaded from offline storage",listStory:a});case 17:t.next=28;break;case 19:if(t.prev=19,t.t0=t.catch(1),this.isOnline()&&!t.t0.message.includes("Failed to fetch")){t.next=27;break}return t.next=25,U.getAllStories();case 25:return s=t.sent,t.abrupt("return",{error:!1,message:"Stories loaded from offline storage",listStory:s});case 27:throw t.t0;case 28:case"end":return t.stop()}}),t,this,[[1,19]])}))),function(){return g.apply(this,arguments)})},{key:"getStoryById",value:(m=K(W().mark((function t(e){var r,n,o;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("Story ID is required");case 2:if(t.prev=2,!this.isOnline()){t.next=14;break}return t.next=6,B.get("".concat(E.ENDPOINTS.STORIES,"/").concat(e));case 6:if(!1!==(r=t.sent).error||!r.story){t.next=11;break}return t.next=10,U.saveStory(r.story);case 10:r.story.photoUrl&&this._cacheStoryImage(r.story.photoUrl);case 11:return t.abrupt("return",r);case 14:return t.next=16,U.getStoryById(e);case 16:if(!(n=t.sent)){t.next=21;break}return t.abrupt("return",{error:!1,message:"Story loaded from offline storage",story:n});case 21:return t.abrupt("return",{error:!0,message:"Story not found in offline storage"});case 22:t.next=34;break;case 24:if(t.prev=24,t.t0=t.catch(2),this.isOnline()&&!t.t0.message.includes("Failed to fetch")){t.next=33;break}return t.next=30,U.getStoryById(e);case 30:if(!(o=t.sent)){t.next=33;break}return t.abrupt("return",{error:!1,message:"Story loaded from offline storage",story:o});case 33:throw t.t0;case 34:case"end":return t.stop()}}),t,this,[[2,24]])}))),function(t){return m.apply(this,arguments)})},{key:"addStory",value:(y=K(W().mark((function t(e){var r,n,o,i,a,s,u,c,l,f,h=arguments;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.description,n=e.photo,o=e.lat,i=e.lon,a=!(h.length>1&&void 0!==h[1])||h[1],r&&n){t.next=4;break}throw new Error("Description and photo are required");case 4:if(this.isOnline()){t.next=15;break}return t.next=7,this._tryCompressImage(n);case 7:return s=t.sent,t.next=10,this._addToOfflineQueue({description:r,photo:s,lat:o,lon:i},a);case 10:return u=t.sent,c={id:u,description:r,photoUrl:URL.createObjectURL(s),createdAt:(new Date).toISOString(),lat:o,lon:i,isPending:!0},t.next=14,U.saveStory(c);case 14:return t.abrupt("return",{error:!1,message:"Story saved offline and will be uploaded when online",tempId:u,tempStory:c});case 15:return l=a?E.ENDPOINTS.STORIES:E.ENDPOINTS.GUEST_STORY,(f=new FormData).append("description",r),f.append("photo",n),void 0!==o&&void 0!==i&&(f.append("lat",o),f.append("lon",i)),t.abrupt("return",B.postForm(l,f,a));case 21:case"end":return t.stop()}}),t,this)}))),function(t){return y.apply(this,arguments)})},{key:"_tryCompressImage",value:(v=K(W().mark((function t(e){var r,n,o=arguments;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:1,t.prev=1,"function"!=typeof imageCompression){t.next=8;break}return n={maxSizeMB:r,maxWidthOrHeight:1920,useWebWorker:!0},t.next=7,imageCompression(e,n);case 7:return t.abrupt("return",t.sent);case 8:return t.abrupt("return",e);case 11:return t.prev=11,t.t0=t.catch(1),t.abrupt("return",e);case 15:case"end":return t.stop()}}),t,null,[[1,11]])}))),function(t){return v.apply(this,arguments)})},{key:"_addToOfflineQueue",value:(d=K(W().mark((function t(e,r){var n,o,i;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="temp_".concat(Date.now(),"_").concat(Math.floor(1e4*Math.random())),JSON.parse(localStorage.getItem(this.offlineAssetsKey)||"{}"),!(e.photo instanceof Blob)){t.next=7;break}return t.next=5,this._storePhotoOffline(n,e.photo);case 5:e.photoRef=n,delete e.photo;case 7:return o={id:n,data:e,useAuth:r,timestamp:Date.now(),type:"add",status:"pending",retries:0},(i=JSON.parse(localStorage.getItem(this.offlineQueueKey)||"[]")).push(o),localStorage.setItem(this.offlineQueueKey,JSON.stringify(i)),this._registerBackgroundSync(),t.abrupt("return",n);case 13:case"end":return t.stop()}}),t,this)}))),function(t,e){return d.apply(this,arguments)})},{key:"_storePhotoOffline",value:(p=K(W().mark((function t(e,r){var n;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,indexedDB.open("offline-assets-db",1);case 3:return(n=t.sent).onupgradeneeded=function(t){var e=t.target.result;e.objectStoreNames.contains("photos")||e.createObjectStore("photos",{keyPath:"id"})},t.abrupt("return",new Promise((function(t,o){n.onsuccess=function(n){var i=n.target.result,a=i.transaction("photos","readwrite"),s=a.objectStore("photos").put({id:e,photo:r});s.onsuccess=function(){return t(!0)},s.onerror=function(){return o(s.error)},a.oncomplete=function(){return i.close()}},n.onerror=function(t){o(t.target.error)}})));case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t,null,[[0,8]])}))),function(t,e){return p.apply(this,arguments)})},{key:"_getOfflinePhoto",value:(h=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.abrupt("return",new Promise((function(t,r){var n=indexedDB.open("offline-assets-db",1);n.onsuccess=function(n){var o=n.target.result,i=o.transaction("photos","readonly"),a=i.objectStore("photos").get(e);a.onsuccess=function(){var e;t((null===(e=a.result)||void 0===e?void 0:e.photo)||null)},a.onerror=function(){r(a.error)},i.oncomplete=function(){return o.close()}},n.onerror=function(t){r(t.target.error)}})));case 4:return t.prev=4,t.t0=t.catch(0),t.abrupt("return",null);case 8:case"end":return t.stop()}}),t,null,[[0,4]])}))),function(t){return h.apply(this,arguments)})},{key:"syncOfflineQueue",value:(f=K(W().mark((function t(){var e,r,n,o,i,a,s,u,c;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isOnline()&&!this.syncInProgress){t.next=2;break}return t.abrupt("return");case 2:if(this.syncInProgress=!0,t.prev=3,0!==(e=JSON.parse(localStorage.getItem(this.offlineQueueKey)||"[]")).length){t.next=8;break}return this.syncInProgress=!1,t.abrupt("return");case 8:r=[],n=0,o=e.filter((function(t){return"pending"===t.status})).length,o>0&&window.dispatchEvent(new CustomEvent("offline-sync-start",{detail:{total:o}})),i=q(e),t.prev=13,i.s();case 15:if((a=i.n()).done){t.next=63;break}if("pending"===(s=a.value).status){t.next=20;break}return r.push(s),t.abrupt("continue",61);case 20:if(t.prev=20,"add"!==s.type){t.next=51;break}if(!s.data.photoRef||s.data.photo){t.next=32;break}return t.next=25,this._getOfflinePhoto(s.data.photoRef);case 25:if(!(u=t.sent)){t.next=30;break}s.data.photo=u,t.next=31;break;case 30:throw new Error("Failed to retrieve offline photo");case 31:delete s.data.photoRef;case 32:return t.next=34,this.addStory(s.data,s.useAuth);case 34:if((c=t.sent).error){t.next=47;break}if(s.status="completed",s.response=c,!c.story){t.next=43;break}return t.next=41,U.deleteStory(s.id);case 41:return t.next=43,U.saveStory(c.story);case 43:this._notifyStoryUploaded(s),s.data.photoRef&&this._deleteOfflinePhoto(s.data.photoRef),t.next=51;break;case 47:s.status="failed",s.error=c.message,s.retries+=1,s.retries<3&&(s.status="pending",r.push(s));case 51:n++,window.dispatchEvent(new CustomEvent("offline-sync-progress",{detail:{current:n,total:o}})),t.next=61;break;case 55:t.prev=55,t.t0=t.catch(20),s.status="failed",s.error=t.t0.message,s.retries+=1,s.retries<3&&(s.status="pending",r.push(s));case 61:t.next=15;break;case 63:t.next=68;break;case 65:t.prev=65,t.t1=t.catch(13),i.e(t.t1);case 68:return t.prev=68,i.f(),t.finish(68);case 71:localStorage.setItem(this.offlineQueueKey,JSON.stringify(r)),window.dispatchEvent(new CustomEvent("offline-sync-complete",{detail:{success:n,failed:o-n}}));case 73:return t.prev=73,this.syncInProgress=!1,t.finish(73);case 76:case"end":return t.stop()}}),t,this,[[3,,73,76],[13,65,68,71],[20,55]])}))),function(){return f.apply(this,arguments)})},{key:"_deleteOfflinePhoto",value:(l=K(W().mark((function t(e){var r;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,indexedDB.open("offline-assets-db",1);case 3:return r=t.sent,t.abrupt("return",new Promise((function(t,n){r.onsuccess=function(r){var o=r.target.result,i=o.transaction("photos","readwrite"),a=i.objectStore("photos").delete(e);a.onsuccess=function(){return t(!0)},a.onerror=function(){return n(a.error)},i.oncomplete=function(){return o.close()}},r.onerror=function(t){n(t.target.error)}})));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(t){return l.apply(this,arguments)})},{key:"_notifyStoryUploaded",value:function(t){var e;if("Notification"in window&&"granted"===Notification.permission)try{var r;new Notification("Story Uploaded",{body:"Your offline story has been successfully uploaded!",icon:"/favicon.ico",data:{url:"/story/".concat((null===(r=t.response)||void 0===r||null===(r=r.story)||void 0===r?void 0:r.id)||""),timestamp:(new Date).getTime()}})}catch(t){}window.dispatchEvent(new CustomEvent("story-uploaded",{detail:{tempId:t.id,story:null===(e=t.response)||void 0===e?void 0:e.story}}))}},{key:"subscribeToPushNotifications",value:(c=K(W().mark((function t(e){var r;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=E.ENDPOINTS.NOTIFICATIONS_SUBSCRIBE,t.abrupt("return",B.post(r,e,!0));case 2:case"end":return t.stop()}}),t)}))),function(t){return c.apply(this,arguments)})},{key:"unsubscribeFromPushNotifications",value:(u=K(W().mark((function t(e){var r;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=E.ENDPOINTS.NOTIFICATIONS_SUBSCRIBE,t.abrupt("return",B.delete("".concat(r,"?endpoint=").concat(encodeURIComponent(e)),!0));case 2:case"end":return t.stop()}}),t)}))),function(t){return u.apply(this,arguments)})},{key:"_registerBackgroundSync",value:function(){"serviceWorker"in navigator&&"SyncManager"in window&&navigator.serviceWorker.ready.then((function(t){t.sync.register("sync-new-stories").catch((function(t){}))}))}},{key:"_setupPeriodicSync",value:(s=K(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("serviceWorker"in navigator)){t.next=11;break}return t.prev=1,t.next=4,navigator.permissions.query({name:"periodic-background-sync"});case 4:"granted"===t.sent.state&&navigator.serviceWorker.ready.then(function(){var t=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("periodicSync"in e)){t.next=4;break}return t.next=3,e.periodicSync.register("sync-stories",{minInterval:864e5});case 3:case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1);case 11:case"end":return t.stop()}}),t,null,[[1,8]])}))),function(){return s.apply(this,arguments)})},{key:"_cacheStoryImages",value:(a=K(W().mark((function t(e){var r,n,o,i,a;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("caches"in window){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,caches.open("story-images-cache");case 5:r=t.sent,n=e.filter((function(t){return t.photoUrl})).map((function(t){return t.photoUrl})),o=q(n),t.prev=8,a=W().mark((function t(){var e;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.value,t.next=3,r.match(e);case 3:t.sent||fetch(e,{mode:"no-cors"}).then((function(t){return r.put(e,t)})).catch((function(t){}));case 5:case"end":return t.stop()}}),t)})),o.s();case 11:if((i=o.n()).done){t.next=15;break}return t.delegateYield(a(),"t0",13);case 13:t.next=11;break;case 15:t.next=20;break;case 17:t.prev=17,t.t1=t.catch(8),o.e(t.t1);case 20:return t.prev=20,o.f(),t.finish(20);case 23:t.next=28;break;case 25:t.prev=25,t.t2=t.catch(2);case 28:case"end":return t.stop()}}),t,null,[[2,25],[8,17,20,23]])}))),function(t){return a.apply(this,arguments)})},{key:"_cacheStoryImage",value:(i=K(W().mark((function t(e){var r;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("caches"in window&&e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,caches.open("story-images-cache");case 5:return r=t.sent,t.next=8,r.match(e);case 8:t.sent||fetch(e,{mode:"no-cors"}).then((function(t){return r.put(e,t)})).catch((function(t){})),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2);case 15:case"end":return t.stop()}}),t,null,[[2,12]])}))),function(t){return i.apply(this,arguments)})},{key:"_getConnectionQuality",value:(o=K(W().mark((function t(){var e;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("connection"in navigator)){t.next=6;break}if(!(e=navigator.connection).saveData){t.next=4;break}return t.abrupt("return","save-data");case 4:if(!e.effectiveType){t.next=6;break}return t.abrupt("return",e.effectiveType);case 6:return t.abrupt("return","unknown");case 7:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"cleanupExpiredCache",value:(n=K(W().mark((function t(){var e,r,n,o,i,a,s,u,c,l;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("caches"in window)){t.next=39;break}return t.prev=1,t.next=4,caches.open("story-images-cache");case 4:return e=t.sent,t.next=7,e.keys();case 7:r=t.sent,n=Date.now(),o=2592e6,i=q(r),t.prev=11,i.s();case 13:if((a=i.n()).done){t.next=26;break}return s=a.value,t.next=17,e.match(s);case 17:if(u=t.sent,!(c=null==u?void 0:u.headers)||!c.get("date")){t.next=24;break}if(l=new Date(c.get("date")).getTime(),!(n-l>o)){t.next=24;break}return t.next=24,e.delete(s);case 24:t.next=13;break;case 26:t.next=31;break;case 28:t.prev=28,t.t0=t.catch(11),i.e(t.t0);case 31:return t.prev=31,i.f(),t.finish(31);case 34:t.next=39;break;case 36:t.prev=36,t.t1=t.catch(1);case 39:case"end":return t.stop()}}),t,null,[[1,36],[11,28,31,34]])}))),function(){return n.apply(this,arguments)})}],e&&Q(t.prototype,e),r&&Q(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s,u,c,l,f,h,p,d,v,y,m,g}(),$=new Z;window.addEventListener("online",(function(){$.syncOfflineQueue()})),navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",(function(t){t.data&&"SYNC_OFFLINE_STORIES"===t.data.type&&$.syncOfflineQueue()})),$.cleanupExpiredCache();const X=$;function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(){et=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==tt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(tt(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function rt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function nt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){rt(i,n,o,a,s,"next",t)}function s(t){rt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ot(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,it(n.key),n)}}function it(t){var e=function(t,e){if("object"!=tt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==tt(e)?e:e+""}var at=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._swRegistration=null,this._isSubscribed=!1,this._initialized=!1},e=[{key:"init",value:function(){var t=nt(et().mark((function t(){return et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._initialized){t.next=2;break}return t.abrupt("return",this._isSubscribed);case 2:if(this._isPushSupported()){t.next=5;break}return t.abrupt("return",!1);case 5:return t.prev=5,t.next=8,navigator.serviceWorker.ready;case 8:return this._swRegistration=t.sent,t.next=11,this._checkSubscription();case 11:return this._isSubscribed=t.sent,this._initialized=!0,t.abrupt("return",this._isSubscribed);case 17:return t.prev=17,t.t0=t.catch(5),t.abrupt("return",!1);case 21:case"end":return t.stop()}}),t,this,[[5,17]])})));return function(){return t.apply(this,arguments)}}()},{key:"_isPushSupported",value:function(){return"serviceWorker"in navigator&&"PushManager"in window}},{key:"subscribe",value:(a=nt(et().mark((function t(){var e,r,n;return et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=!this._initialized,!t.t0){t.next=5;break}return t.next=4,this.init();case 4:t.t0=!t.sent;case 5:if(!t.t0){t.next=7;break}throw new Error("Web Push Helper initialization failed");case 7:return t.prev=7,t.next=10,this._swRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this._urlBase64ToUint8Array(E.WEB_PUSH.VAPID_PUBLIC_KEY)});case 10:return e=t.sent,r=this._formatSubscriptionForApi(e),t.next=14,X.subscribeToPushNotifications(r);case 14:return this._isSubscribed=!0,this._showSuccessNotification("Notifikasi Aktif!","Anda akan menerima notifikasi saat ada story baru."),t.abrupt("return",r);case 19:throw t.prev=19,t.t1=t.catch(7),n="Gagal mengaktifkan notifikasi.","NotAllowedError"===t.t1.name?n="Izin notifikasi ditolak. Mohon aktifkan izin notifikasi di pengaturan browser Anda.":"InvalidStateError"===t.t1.name&&(n="Anda sudah berlangganan notifikasi sebelumnya."),this._showErrorNotification("Gagal Aktivasi Notifikasi",n),t.t1;case 25:case"end":return t.stop()}}),t,this,[[7,19]])}))),function(){return a.apply(this,arguments)})},{key:"unsubscribe",value:(i=nt(et().mark((function t(){var e,r;return et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=!this._initialized,!t.t0){t.next=5;break}return t.next=4,this.init();case 4:t.t0=!t.sent;case 5:if(!t.t0){t.next=7;break}throw new Error("Web Push Helper initialization failed");case 7:return t.prev=7,t.next=10,this._swRegistration.pushManager.getSubscription();case 10:if(e=t.sent){t.next=14;break}return this._isSubscribed=!1,t.abrupt("return",!0);case 14:return r=e.endpoint,t.next=17,e.unsubscribe();case 17:if(t.sent){t.next=20;break}throw new Error("Failed to unsubscribe from push service");case 20:return t.next=22,X.unsubscribeFromPushNotifications(r);case 22:return this._isSubscribed=!1,this._showInfoNotification("Notifikasi Dinonaktifkan","Anda tidak akan menerima notifikasi lagi."),t.abrupt("return",!0);case 27:return t.prev=27,t.t1=t.catch(7),this._showErrorNotification("Gagal Menonaktifkan Notifikasi",t.t1.message||"Terjadi kesalahan saat menonaktifkan notifikasi."),t.abrupt("return",!1);case 31:case"end":return t.stop()}}),t,this,[[7,27]])}))),function(){return i.apply(this,arguments)})},{key:"_checkSubscription",value:(o=nt(et().mark((function t(){var e;return et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._swRegistration){t.next=2;break}return t.abrupt("return",!1);case 2:return t.prev=2,t.next=5,this._swRegistration.pushManager.getSubscription();case 5:return e=t.sent,t.abrupt("return",Boolean(e));case 9:return t.prev=9,t.t0=t.catch(2),t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t,this,[[2,9]])}))),function(){return o.apply(this,arguments)})},{key:"_formatSubscriptionForApi",value:function(t){var e=t.toJSON();return{endpoint:e.endpoint,keys:{p256dh:e.keys.p256dh,auth:e.keys.auth}}}},{key:"_urlBase64ToUint8Array",value:function(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(e),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}},{key:"_showSuccessNotification",value:function(t,e){g().fire({title:t,text:e,icon:"success",confirmButtonColor:"#2563EB"})}},{key:"_showErrorNotification",value:function(t,e){g().fire({title:t,text:e,icon:"error",confirmButtonColor:"#2563EB"})}},{key:"_showInfoNotification",value:function(t,e){g().fire({title:t,text:e,icon:"info",confirmButtonColor:"#2563EB"})}},{key:"requestPermission",value:(n=nt(et().mark((function t(){var e=this;return et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Notification"in window){t.next=2;break}throw new Error("Browser ini tidak mendukung notifikasi");case 2:return t.abrupt("return",new Promise((function(t){g().fire({title:"Aktifkan Notifikasi?",text:"Kami akan memberi tahu Anda saat ada story baru.",icon:"question",showCancelButton:!0,confirmButtonColor:"#2563EB",cancelButtonColor:"#6B7280",confirmButtonText:"Ya, aktifkan!",cancelButtonText:"Nanti saja"}).then(function(){var r=nt(et().mark((function r(n){var o;return et().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n.isConfirmed){r.next=20;break}return r.prev=1,r.next=4,Notification.requestPermission();case 4:if("granted"!==(o=r.sent)){r.next=10;break}return r.next=8,e.subscribe();case 8:r.next=11;break;case 10:e._showInfoNotification("Notifikasi Tidak Diizinkan","Anda dapat mengaktifkannya nanti melalui pengaturan browser.");case 11:t(o),r.next=18;break;case 14:r.prev=14,r.t0=r.catch(1),e._showErrorNotification("Terjadi Kesalahan","Gagal meminta izin notifikasi. Silakan coba lagi nanti."),t("denied");case 18:r.next=21;break;case 20:t("dismissed");case 21:case"end":return r.stop()}}),r,null,[[1,14]])})));return function(t){return r.apply(this,arguments)}}())})));case 3:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"isSubscribed",value:function(){return this._isSubscribed}},{key:"getRegistration",value:function(){return this._swRegistration}}],e&&ot(t.prototype,e),r&&ot(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a}();const st=new at;function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function ct(){ct=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==ut(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ut(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function lt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function ft(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){lt(i,n,o,a,s,"next",t)}function s(t){lt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ht(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pt(n.key),n)}}function pt(t){var e=function(t,e){if("object"!=ut(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ut(e)?e:e+""}var dt=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._authStorageKey="auth_token",this._userDataKey="user_data",this._offlineAuthDbName="auth-offline-db",this._offlineAuthStoreName="auth-store",this._initDatabase(),this._setupEventListeners()},e=[{key:"_initDatabase",value:(h=ft(ct().mark((function t(){return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,A.P2)(this._offlineAuthDbName,1,{upgrade:function(t){t.objectStoreNames.contains("auth-store")||t.createObjectStore("auth-store",{keyPath:"id"})}});case 3:this._db=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return h.apply(this,arguments)})},{key:"_setupEventListeners",value:function(){var t=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",(function(e){e.data&&"SYNC_AUTH_DATA"===e.data.type&&t.syncOnlineStatus()}))}},{key:"register",value:(f=ft(ct().mark((function t(e){var r,n,o;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.name,n=e.email,o=e.password,t.prev=1,t.next=4,B.post(E.ENDPOINTS.REGISTER,{name:r,email:n,password:o},!1);case 4:return t.abrupt("return",t.sent);case 7:if(t.prev=7,t.t0=t.catch(1),navigator.onLine){t.next=12;break}throw this._showOfflineNotification("Tidak dapat mendaftar saat offline"),new Error("Tidak dapat mendaftar saat offline. Coba lagi nanti.");case 12:throw t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,7]])}))),function(t){return f.apply(this,arguments)})},{key:"login",value:(l=ft(ct().mark((function t(e){var r,n,o,i;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.email,n=e.password,t.prev=1,t.next=4,B.post(E.ENDPOINTS.LOGIN,{email:r,password:n},!1);case 4:if(!(o=t.sent).loginResult){t.next=10;break}return t.next=8,this._saveAuthData(o.loginResult);case 8:return t.next=10,this._saveCredentialsOffline(r,o.loginResult);case 10:return t.abrupt("return",o);case 13:if(t.prev=13,t.t0=t.catch(1),navigator.onLine){t.next=26;break}return t.next=18,this._tryOfflineLogin(r);case 18:if(!(i=t.sent)){t.next=24;break}return this._showOfflineNotification("Login offline berhasil"),t.abrupt("return",{loginResult:i});case 24:throw this._showOfflineNotification("Login offline gagal"),new Error("Tidak dapat login saat offline. Kredensial tidak tersedia.");case 26:throw t.t0;case 27:case"end":return t.stop()}}),t,this,[[1,13]])}))),function(t){return l.apply(this,arguments)})},{key:"_saveCredentialsOffline",value:(c=ft(ct().mark((function t(e,r){var n,o;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._db){t.next=3;break}return t.next=3,this._initDatabase();case 3:return t.prev=3,n=this._db.transaction(this._offlineAuthStoreName,"readwrite"),o=n.objectStore(this._offlineAuthStoreName),t.next=8,o.put({id:e,loginResult:r,timestamp:Date.now()});case 8:return t.next=10,n.done;case 10:return t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t.catch(3),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,this,[[3,14]])}))),function(t,e){return c.apply(this,arguments)})},{key:"_tryOfflineLogin",value:(u=ft(ct().mark((function t(e){var r,n,o;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._db){t.next=3;break}return t.next=3,this._initDatabase();case 3:return t.prev=3,r=this._db.transaction(this._offlineAuthStoreName,"readonly"),n=r.objectStore(this._offlineAuthStoreName),t.next=8,n.get(e);case 8:if(!(o=t.sent)||!o.loginResult){t.next=11;break}return t.abrupt("return",o.loginResult);case 11:return t.abrupt("return",null);case 14:return t.prev=14,t.t0=t.catch(3),t.abrupt("return",null);case 18:case"end":return t.stop()}}),t,this,[[3,14]])}))),function(t){return u.apply(this,arguments)})},{key:"logout",value:(s=ft(ct().mark((function t(){var e,r;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(localStorage.removeItem(this._authStorageKey),localStorage.removeItem(this._userDataKey),!("serviceWorker"in navigator)){t.next=20;break}return t.prev=3,t.next=6,navigator.serviceWorker.getRegistration();case 6:if(!(e=t.sent)||!e.pushManager){t.next=15;break}return t.next=10,e.pushManager.getSubscription();case 10:if(!(r=t.sent)){t.next=15;break}return t.next=14,r.unsubscribe();case 14:case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(3);case 20:window.dispatchEvent(new Event("user-logged-out"));case 21:case"end":return t.stop()}}),t,this,[[3,17]])}))),function(){return s.apply(this,arguments)})},{key:"syncOnlineStatus",value:(a=ft(ct().mark((function t(){return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!navigator.onLine||!this.isAuthenticated()){t.next=13;break}return t.prev=1,t.next=4,B.get(E.ENDPOINTS.USER_INFO);case 4:return t.abrupt("return",!0);case 8:return t.prev=8,t.t0=t.catch(1),this.logout(),t.abrupt("return",!1);case 13:return t.abrupt("return",this.isAuthenticated());case 14:case"end":return t.stop()}}),t,this,[[1,8]])}))),function(){return a.apply(this,arguments)})},{key:"isAuthenticated",value:function(){return!!this.getToken()}},{key:"getToken",value:function(){return localStorage.getItem(this._authStorageKey)}},{key:"getUserData",value:function(){var t=localStorage.getItem(this._userDataKey);return t?JSON.parse(t):null}},{key:"_saveAuthData",value:(i=ft(ct().mark((function t(e){var r,n,o;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.token,n=e.userId,o=e.name,localStorage.setItem(this._authStorageKey,r),localStorage.setItem(this._userDataKey,JSON.stringify({userId:n,name:o})),this._registerBackgroundSync(),window.dispatchEvent(new Event("user-logged-in"));case 5:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"_registerBackgroundSync",value:(o=ft(ct().mark((function t(){var e;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("serviceWorker"in navigator)||!("SyncManager"in window)){t.next=13;break}return t.prev=1,t.next=4,navigator.serviceWorker.ready;case 4:return e=t.sent,t.next=7,e.sync.register("sync-auth-data");case 7:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1);case 13:case"end":return t.stop()}}),t,null,[[1,10]])}))),function(){return o.apply(this,arguments)})},{key:"_showOfflineNotification",value:function(t){g().fire({title:"Status Koneksi",text:t,icon:"info",confirmButtonColor:"#2563EB",timer:3e3})}},{key:"setupPWAFeatures",value:(n=ft(ct().mark((function t(){var e=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window.addEventListener("online",ft(ct().mark((function t(){return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isAuthenticated()){t.next=10;break}return t.prev=1,t.next=4,e.syncOnlineStatus();case 4:e._showOfflineNotification("Koneksi kembali tersedia. Data akun telah disinkronkan."),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1);case 10:case"end":return t.stop()}}),t,null,[[1,7]])})))),window.addEventListener("offline",(function(){e.isAuthenticated()&&e._showOfflineNotification("Anda sedang offline. Beberapa fitur mungkin terbatas.")})),setInterval(ft(ct().mark((function t(){return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!navigator.onLine||!e.isAuthenticated()){t.next=3;break}return t.next=3,e.syncOnlineStatus();case 3:case"end":return t.stop()}}),t)}))),18e5),t.abrupt("return",!0);case 4:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}],e&&ht(t.prototype,e),r&&ht(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s,u,c,l,f,h}());document.addEventListener("DOMContentLoaded",(function(){dt.setupPWAFeatures().then((function(){})).catch((function(t){}))}));const vt=dt;function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gt(n.key),n)}}function gt(t){var e=function(t,e){if("object"!=yt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=yt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==yt(e)?e:e+""}function bt(t,e,r){return e=kt(e),function(t,e){if(e&&("object"==yt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_t()?Reflect.construct(e,r||[],kt(t).constructor):e.apply(t,r))}function wt(t){var e="function"==typeof Map?new Map:void 0;return wt=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(_t())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&xt(o,r.prototype),o}(t,arguments,kt(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),xt(r,t)},wt(t)}function _t(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_t=function(){return!!t})()}function xt(t,e){return xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xt(t,e)}function kt(t){return kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},kt(t)}var Et=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=bt(this,e))._isAuthenticated=vt.isAuthenticated(),t._handleAuthChange=t._handleAuthChange.bind(t),t._handleLogout=t._handleLogout.bind(t),t._handleMenuToggle=t._handleMenuToggle.bind(t),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xt(t,e)}(e,t),r=e,(n=[{key:"connectedCallback",value:function(){this.render(),window.addEventListener("user-logged-in",this._handleAuthChange),window.addEventListener("user-logged-out",this._handleAuthChange),this._attachEventListeners()}},{key:"disconnectedCallback",value:function(){window.removeEventListener("user-logged-in",this._handleAuthChange),window.removeEventListener("user-logged-out",this._handleAuthChange);var t=this.querySelector(".menu-toggle");t&&t.removeEventListener("click",this._handleMenuToggle);var e=this.querySelector("#logoutButton");e&&e.removeEventListener("click",this._handleLogout)}},{key:"render",value:function(){var t=vt.getUserData()||{};this.innerHTML='\n      <nav class="app-nav">\n        <div class="app-nav__brand">\n          <a href="#/" class="app-nav__title">Dicoding Story</a>\n        </div>\n        \n        <button class="menu-toggle" aria-label="Toggle menu">\n          <i class="fas fa-bars"></i>\n        </button>\n        \n        <ul class="app-nav__list '.concat(this._isAuthenticated?"":"app-nav__list--guest",'">\n          <li class="app-nav__item">\n            <a href="#/" class="app-nav__link">\n              <i class="fas fa-home"></i>\n              <span>Home</span>\n            </a>\n          </li>\n          \n          ').concat(this._isAuthenticated?'\n                <li class="app-nav__item">\n                  <a href="#/add" class="app-nav__link">\n                    <i class="fas fa-plus-circle"></i>\n                    <span>Add Story</span>\n                  </a>\n                </li>\n                <li class="app-nav__item app-nav__item--user">\n                  <span class="app-nav__user">\n                    <i class="fas fa-user-circle"></i>\n                    <span>'.concat(t.name||"User",'</span>\n                  </span>\n                  <button id="logoutButton" class="app-nav__button">\n                    <i class="fas fa-sign-out-alt"></i>\n                    <span>Logout</span>\n                  </button>\n                </li>\n              '):'\n                <li class="app-nav__item">\n                  <a href="#/login" class="app-nav__link">\n                    <i class="fas fa-sign-in-alt"></i>\n                    <span>Login</span>\n                  </a>\n                </li>\n                <li class="app-nav__item">\n                  <a href="#/register" class="app-nav__link app-nav__link--register">\n                    <i class="fas fa-user-plus"></i>\n                    <span>Register</span>\n                  </a>\n                </li>\n              ',"\n        </ul>\n      </nav>\n    "),this._attachEventListeners()}},{key:"_attachEventListeners",value:function(){var t=this.querySelector("#logoutButton");t&&t.addEventListener("click",this._handleLogout);var e=this.querySelector(".menu-toggle");e&&e.addEventListener("click",this._handleMenuToggle)}},{key:"_handleAuthChange",value:function(){this._isAuthenticated=vt.isAuthenticated(),this.render()}},{key:"_handleLogout",value:function(t){t.preventDefault(),vt.logout(),window.location.hash="#/"}},{key:"_handleMenuToggle",value:function(){this.querySelector(".app-nav__list").classList.toggle("app-nav__list--open")}}])&&mt(r.prototype,n),o&&mt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(wt(HTMLElement));customElements.define("app-bar",Et);const St=function(t){var e=t.isLoading,r=void 0!==e&&e,n=t.error,o=void 0===n?null:n,i=t.stories,a=void 0===i?[]:i;if(r)return'\n      <section class="home">\n        <h2 class="home__title">Recent Stories</h2>\n        \n        <div class="loading-indicator">\n          <div class="loading-spinner"></div>\n          <p>Loading stories...</p>\n        </div>\n      </section>\n    ';if(o)return'\n      <section class="home">\n        <h2 class="home__title">Recent Stories</h2>\n        \n        <div class="error-container">\n          <i class="fas fa-exclamation-circle error-icon"></i>\n          <p class="error-message">'.concat(o,'</p>\n          <button class="button" id="retryButton">\n            <i class="fas fa-redo"></i> Try Again\n          </button>\n        </div>\n      </section>\n    ');var s=a.length>0?'<div class="stories-list" id="storiesList"></div>':'\n    <div class="stories-empty">\n      <i class="fas fa-book-open stories-empty__icon"></i>\n      <p>No stories available yet. Be the first to share your story!</p>\n      <a href="#/add" class="button">\n        <i class="fas fa-plus-circle"></i> Add New Story\n      </a>\n    </div>\n  ';return'\n    <section class="home">\n      <h2 class="home__title">Recent Stories</h2>\n      \n      '.concat(a.some((function(t){return t.lat&&t.lon}))?'\n    <div class="map-container">\n      <h3 class="map-title">\n        <i class="fas fa-map-marked-alt"></i>\n        Story Locations\n      </h3>\n      <div id="storyMap" class="story-map"></div>\n    </div>\n  ':"",'\n      \n      <div class="home__content">\n        ').concat(s,"\n      </div>\n    </section>\n  ")};function Ot(t){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ot(t)}function Pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jt(n.key),n)}}function jt(t){var e=function(t,e){if("object"!=Ot(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ot(e)?e:e+""}function Tt(t,e,r){return e=Ct(e),function(t,e){if(e&&("object"==Ot(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,It()?Reflect.construct(e,r||[],Ct(t).constructor):e.apply(t,r))}function Lt(t){var e="function"==typeof Map?new Map:void 0;return Lt=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(It())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&Nt(o,r.prototype),o}(t,arguments,Ct(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Nt(r,t)},Lt(t)}function It(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(It=function(){return!!t})()}function Nt(t,e){return Nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Nt(t,e)}function Ct(t){return Ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ct(t)}var Bt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Tt(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nt(t,e)}(e,t),r=e,n=[{key:"story",set:function(t){this._story=t,this.render()}},{key:"_formatDate",value:function(t){var e=new Date(t);return new Intl.DateTimeFormat("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)}},{key:"_truncateText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;return!t||t.length<=e?t:t.substring(0,e)+"..."}},{key:"render",value:function(){if(this._story){var t=this._story,e=t.id,r=t.name,n=t.description,o=t.photoUrl,i=t.createdAt,a=t.lat,s=t.lon,u=a&&s&&!isNaN(parseFloat(a))&&!isNaN(parseFloat(s));this.innerHTML='\n      <article class="story-item">\n        <div class="story-item__image-container">\n          <img \n            src="'.concat(o,'" \n            alt="Story by ').concat(r,'"\n            class="story-item__image"\n            loading="lazy"\n          />\n        </div>\n        \n        <div class="story-item__content">\n          <div class="story-item__meta">\n            <span class="story-item__author">\n              <i class="fas fa-user"></i>\n              ').concat(r,'\n            </span>\n            <span class="story-item__date">\n              <i class="fas fa-calendar-alt"></i>\n              ').concat(this._formatDate(i),"\n            </span>\n            ").concat(u?'\n              <span class="story-item__location">\n                <i class="fas fa-map-marker-alt"></i>\n                Location Available\n              </span>':"",'\n          </div>\n          \n          <h3 class="story-item__title">\n            <a href="#/detail/').concat(e,'" class="story-item__link">\n              Story by ').concat(r,'\n            </a>\n          </h3>\n          \n          <p class="story-item__description">\n            ').concat(this._truncateText(n),'\n          </p>\n          \n          <div class="story-item__actions">\n            <a href="#/detail/').concat(e,'" class="story-item__button">\n              Read More\n              <i class="fas fa-arrow-right"></i>\n            </a>\n          </div>\n        </div>\n      </article>\n    ')}else this.innerHTML='<div class="story-item__error">No story data available</div>'}}],n&&Pt(r.prototype,n),o&&Pt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Lt(HTMLElement));customElements.define("story-item",Bt);var At=r(481),Ft=r.n(At);function Gt(t){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gt(t)}function Rt(){Rt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Gt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Gt(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Mt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ht(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Dt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ht(Object(r),!0).forEach((function(e){Ut(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ht(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ut(t,e,r){return(e=qt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qt(n.key),n)}}function qt(t){var e=function(t,e){if("object"!=Gt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Gt(e)?e:e+""}var zt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._map=null,this._markers=[],this._selectedLocation=null,this._mapOptions={center:E.MAP.DEFAULT_CENTER,zoom:E.MAP.DEFAULT_ZOOM},this._baseLayers={}},e=[{key:"initMap",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)throw new Error("Container element is required");var r=Dt(Dt({},this._mapOptions),e);return this._map=Ft().map(t,{center:r.center,zoom:r.zoom,scrollWheelZoom:!0,zoomControl:!0}),this._addDefaultTileLayer(),(e.addSecondaryTileLayer||r.addSecondaryTileLayer)&&this._addSecondaryTileLayer(E.MAP.SECONDARY_TILE_LAYER),Object.keys(this._baseLayers).length>1&&Ft().control.layers(this._baseLayers).addTo(this._map),this._map}},{key:"addStoryMarkers",value:function(t){var e=this;if(!this._map)throw new Error("Map not initialized. Call initMap first.");this.clearMarkers();var r=t.filter((function(t){return t.lat&&t.lon&&!isNaN(t.lat)&&!isNaN(t.lon)}));if(0!==r.length)if(r.forEach((function(t){var r=Ft().marker([t.lat,t.lon]);r.bindPopup(e._createPopupContent(t)),r.addTo(e._map),e._markers.push(r)})),this._markers.length>1){var n=Ft().featureGroup(this._markers);this._map.fitBounds(n.getBounds().pad(.1))}else 1===this._markers.length&&this._map.setView([r[0].lat,r[0].lon],15)}},{key:"setupLocationSelector",value:function(t){var e=this;if(!this._map)throw new Error("Map not initialized. Call initMap first.");this.clearMarkers(),this._map.on("click",(function(r){var n=r.latlng,o=n.lat,i=n.lng;e.clearMarkers();var a=Ft().marker([o,i]).addTo(e._map);e._markers.push(a),e._selectedLocation={lat:o,lon:i},"function"==typeof t&&t(e._selectedLocation)}))}},{key:"getUserLocation",value:(n=Rt().mark((function t(){var e=this;return Rt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(r){var n={lat:r.coords.latitude,lon:r.coords.longitude};if(e._map){e._map.setView([n.lat,n.lon],15),e.clearMarkers();var o=Ft().marker([n.lat,n.lon]).addTo(e._map).bindPopup("Your location").openPopup();e._markers.push(o),e._selectedLocation=n}t(n)}),(function(t){r(new Error("Could not get your location: ".concat(t.message)))})):r(new Error("Geolocation is not supported by your browser"))})));case 1:case"end":return t.stop()}}),t)})),o=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){Mt(i,r,o,a,s,"next",t)}function s(t){Mt(i,r,o,a,s,"throw",t)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"getSelectedLocation",value:function(){return this._selectedLocation}},{key:"clearMarkers",value:function(){var t=this;this._map&&(this._markers.forEach((function(e){return t._map.removeLayer(e)})),this._markers=[])}},{key:"_addDefaultTileLayer",value:function(){var t=Ft().tileLayer(E.MAP.TILE_LAYER,{attribution:E.MAP.ATTRIBUTION,maxZoom:19}).addTo(this._map);this._baseLayers.OpenStreetMap=t}},{key:"_addSecondaryTileLayer",value:function(t){if(t&&t.url){var e=Ft().tileLayer(t.url,{attribution:t.attribution||"",maxZoom:t.maxZoom||19,subdomains:t.subdomains||[]});this._baseLayers[t.name||"Satellite"]=e}}},{key:"_createPopupContent",value:function(t){var e=document.createElement("div");e.className="map-popup";var r=document.createElement("img");r.src=t.photoUrl,r.alt="Photo by ".concat(t.name),r.className="map-popup__thumbnail",e.appendChild(r);var n=document.createElement("div");n.className="map-popup__info";var o=document.createElement("h4");o.textContent=t.name,n.appendChild(o);var i=document.createElement("p");i.textContent=this._truncateText(t.description,100),n.appendChild(i);var a=document.createElement("a");return a.href="#/detail/".concat(t.id),a.textContent="View details",a.className="map-popup__link",n.appendChild(a),e.appendChild(n),e}},{key:"_truncateText",value:function(t,e){return!t||t.length<=e?t:t.substring(0,e)+"..."}}],e&&Yt(t.prototype,e),r&&Yt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();const Wt=zt;function Vt(t){return Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vt(t)}function Kt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qt(n.key),n)}}function Qt(t){var e=function(t,e){if("object"!=Vt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Vt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Vt(e)?e:e+""}const Jt=function(){return t=function t(e){var r=e.stories,n=void 0===r?[]:r,o=e.isLoading,i=void 0!==o&&o,a=e.error,s=void 0===a?null:a,u=e.container;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._stories=n,this._isLoading=i,this._error=s,this._container=u,this._mapHelper=new Wt,this._mapInitialized=!1,this._retryHandler=null},(e=[{key:"render",value:function(){this._container.innerHTML=St({isLoading:this._isLoading,error:this._error,stories:this._stories}),!this._isLoading&&!this._error&&this._stories.length>0&&(this._renderStories(),this._initMap()),this._error&&this._attachRetryHandler()}},{key:"_renderStories",value:function(){var t=document.getElementById("storiesList");t&&(t.innerHTML="",this._stories.forEach((function(e){var r=document.createElement("story-item");r.story=e,t.appendChild(r)})))}},{key:"_initMap",value:function(){if(0!==this._stories.filter((function(t){return t.lat&&t.lon&&!isNaN(t.lat)&&!isNaN(t.lon)})).length){var t=document.getElementById("storyMap");t&&(this._mapHelper.initMap(t,{addSecondaryTileLayer:!0}),this._mapHelper.addStoryMarkers(this._stories),this._mapInitialized=!0)}}},{key:"_attachRetryHandler",value:function(){var t=document.getElementById("retryButton");t&&this._retryHandler&&t.addEventListener("click",this._retryHandler)}},{key:"setRetryHandler",value:function(t){this._retryHandler=t,this._error&&this._attachRetryHandler()}},{key:"cleanup",value:function(){this._mapInitialized&&this._mapHelper&&this._mapHelper.clearMarkers()}}])&&Kt(t.prototype,e),r&&Kt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Zt(t){return Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zt(t)}function $t(){$t=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Zt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Zt(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Xt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function te(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Xt(i,n,o,a,s,"next",t)}function s(t){Xt(i,n,o,a,s,"throw",t)}a(void 0)}))}}var ee=function(){var t=te($t().mark((function t(e){var r;return $t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(document.startViewTransition){t.next=4;break}return t.next=3,e();case 3:return t.abrupt("return");case 4:return r=document.startViewTransition(te($t().mark((function t(){return $t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:case"end":return t.stop()}}),t)})))),t.abrupt("return",r.finished);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),re=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.name,n=void 0===r?"fade":r,o=e.duration,i=void 0===o?300:o,a=e.easing,s=void 0===a?"ease":a,u=document.querySelector(t);if(u){u.style.viewTransitionName=n;var c=document.createElement("style");c.textContent="\n      @keyframes ".concat(n,"-in {\n        from { opacity: 0; transform: translateY(20px); }\n        to { opacity: 1; transform: translateY(0); }\n      }\n  \n      @keyframes ").concat(n,"-out {\n        from { opacity: 1; transform: translateY(0); }\n        to { opacity: 0; transform: translateY(-20px); }\n      }\n  \n      ::view-transition-old(").concat(n,") {\n        animation: ").concat(i,"ms ").concat(s," both ").concat(n,"-out;\n      }\n  \n      ::view-transition-new(").concat(n,") {\n        animation: ").concat(i,"ms ").concat(s," both ").concat(n,"-in;\n      }\n    "),document.head.appendChild(c),setTimeout((function(){document.head.removeChild(c)}),i+100)}};function ne(t){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ne(t)}function oe(){oe=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==ne(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ne(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function ie(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function ae(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ie(i,n,o,a,s,"next",t)}function s(t){ie(i,n,o,a,s,"throw",t)}a(void 0)}))}}function se(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ue(n.key),n)}}function ue(t){var e=function(t,e){if("object"!=ne(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ne(e)?e:e+""}var ce=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._params=e,this._view=null,this._container=document.querySelector("#pageContent"),this._isLoading=!1,this._error=null,this._stories=[],this._fetchStories=this._fetchStories.bind(this),this._handleRetry=this._handleRetry.bind(this)},e=[{key:"init",value:function(){var t=ae(oe().mark((function t(){return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._renderLoading(),re("#pageContent",{name:"home-transition",duration:400}),t.next=4,this._fetchStories();case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_fetchStories",value:(n=ae(oe().mark((function t(){var e;return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this._isLoading=!0,this._error=null,this._renderLoading(),vt.isAuthenticated()){t.next=11;break}return this._stories=[],this._isLoading=!1,this._renderView(),g().fire({title:"Welcome to Dicoding Story!",text:"Log in to see and share stories from the Dicoding community.",icon:"info",confirmButtonColor:"#2563EB",confirmButtonText:"Log In",showCancelButton:!0,cancelButtonText:"Maybe Later"}).then((function(t){t.isConfirmed&&(window.location.hash="#/login")})),t.abrupt("return");case 11:return t.next=13,X.getStories({location:1});case 13:e=t.sent,this._stories=e.listStory||[],this._isLoading=!1,this._renderView(),t.next=25;break;case 19:t.prev=19,t.t0=t.catch(0),this._isLoading=!1,this._error=t.t0.message||"Failed to load stories. Please try again.",this._renderError();case 25:case"end":return t.stop()}}),t,this,[[0,19]])}))),function(){return n.apply(this,arguments)})},{key:"_renderLoading",value:function(){this._view=new Jt({isLoading:!0,stories:[],error:null,container:this._container}),this._view.render()}},{key:"_renderError",value:function(){this._view=new Jt({isLoading:!1,stories:[],error:this._error,container:this._container}),this._view.render(),this._view.setRetryHandler(this._handleRetry)}},{key:"_renderView",value:function(){this._view=new Jt({isLoading:this._isLoading,stories:this._stories,error:this._error,container:this._container}),this._view.render(),this._error&&this._view.setRetryHandler(this._handleRetry)}},{key:"_handleRetry",value:function(){this._fetchStories()}},{key:"cleanup",value:function(){this._view&&this._view.cleanup()}}],e&&se(t.prototype,e),r&&se(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const le=ce;const fe=function(t){var e=t.isLoading,r=void 0!==e&&e,n=t.error,o=void 0===n?null:n,i=t.story,a=void 0===i?null:i;if(r)return'\n        <section class="detail">\n          <div class="detail__header">\n            <h2 class="detail__title">Story Details</h2>\n            <a href="#/" class="button secondary">\n              <i class="fas fa-arrow-left"></i> Back to Home\n            </a>\n          </div>\n          \n          <div class="loading-indicator">\n            <div class="loading-spinner"></div>\n            <p>Loading story details...</p>\n          </div>\n        </section>\n      ';if(o)return'\n        <section class="detail">\n          <div class="detail__header">\n            <h2 class="detail__title">Story Details</h2>\n            <a href="#/" class="button secondary">\n              <i class="fas fa-arrow-left"></i> Back to Home\n            </a>\n          </div>\n          \n          <div class="error-container">\n            <i class="fas fa-exclamation-circle error-icon"></i>\n            <p class="error-message">'.concat(o,'</p>\n            <button class="button" id="retryButton">\n              <i class="fas fa-redo"></i> Try Again\n            </button>\n          </div>\n        </section>\n      ');if(!a)return'\n        <section class="detail">\n          <div class="detail__header">\n            <h2 class="detail__title">Story Details</h2>\n            <a href="#/" class="button secondary">\n              <i class="fas fa-arrow-left"></i> Back to Home\n            </a>\n          </div>\n          \n          <div class="error-container">\n            <i class="fas fa-search error-icon"></i>\n            <p class="error-message">Story not found</p>\n            <a href="#/" class="button">\n              <i class="fas fa-home"></i> Back to Home\n            </a>\n          </div>\n        </section>\n      ';var s,u,c=a.lat&&a.lon?'\n        <div class="story-detail__map-container">\n          <h4 class="story-detail__map-title">\n            <i class="fas fa-map-marker-alt"></i> Story Location\n          </h4>\n          <div id="detailMap" class="story-detail__map"></div>\n        </div>\n      ':"";return'\n      <section class="detail">\n        <div class="detail__header">\n          <h2 class="detail__title">Story Details</h2>\n          <a href="#/" class="button secondary">\n            <i class="fas fa-arrow-left"></i> Back to Home\n          </a>\n        </div>\n        \n        <article class="story-detail">\n          <div class="story-detail__image-container">\n            <img \n              src="'.concat(a.photoUrl,'" \n              alt="Story by ').concat(a.name,'"\n              class="story-detail__image"\n            />\n          </div>\n          \n          <div class="story-detail__content">\n            <div class="story-detail__meta">\n              <div class="story-detail__author">\n                <i class="fas fa-user"></i>\n                <span>').concat(a.name,'</span>\n              </div>\n              <div class="story-detail__date">\n                <i class="fas fa-calendar-alt"></i>\n                <span>').concat((s=a.createdAt,u=new Date(s),new Intl.DateTimeFormat("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(u)),'</span>\n              </div>\n            </div>\n            \n            <h3 class="story-detail__title">Story by ').concat(a.name,'</h3>\n            \n            <div class="story-detail__description">\n              ').concat(a.description,"\n            </div>\n            \n            ").concat(c,"\n          </div>\n        </article>\n      </section>\n    ")};function he(t){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(t)}function pe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,de(n.key),n)}}function de(t){var e=function(t,e){if("object"!=he(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=he(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==he(e)?e:e+""}const ve=function(){return t=function t(e){var r=e.story,n=void 0===r?null:r,o=e.isLoading,i=void 0!==o&&o,a=e.error,s=void 0===a?null:a,u=e.container;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._story=n,this._isLoading=i,this._error=s,this._container=u,this._mapHelper=new Wt,this._mapInitialized=!1,this._retryHandler=null},(e=[{key:"render",value:function(){this._container.innerHTML=fe({isLoading:this._isLoading,error:this._error,story:this._story}),!this._story||this._isLoading||this._error||this._initMap(),this._error&&this._attachRetryHandler()}},{key:"_initMap",value:function(){var t=this._story,e=t.lat,r=t.lon;if(e&&r&&!isNaN(e)&&!isNaN(r)&&!this._mapInitialized){var n=document.getElementById("detailMap");if(n){var o=this._mapHelper.initMap(n,{center:[e,r],zoom:15});L.marker([e,r]).addTo(o).bindPopup('\n      <div class="map-popup">\n        <strong>'.concat(this._story.name,"</strong>\n        <p>Posted this story from here</p>\n      </div>\n    ")).openPopup(),this._mapInitialized=!0}}}},{key:"_attachRetryHandler",value:function(){var t=document.getElementById("retryButton");t&&this._retryHandler&&t.addEventListener("click",this._retryHandler)}},{key:"setRetryHandler",value:function(t){this._retryHandler=t,this._error&&this._attachRetryHandler()}},{key:"cleanup",value:function(){this._mapInitialized&&this._mapHelper&&this._mapHelper.clearMarkers()}}])&&pe(t.prototype,e),r&&pe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function ye(t){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(t)}function me(){me=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==ye(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ye(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function ge(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function be(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ge(i,n,o,a,s,"next",t)}function s(t){ge(i,n,o,a,s,"throw",t)}a(void 0)}))}}function we(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_e(n.key),n)}}function _e(t){var e=function(t,e){if("object"!=ye(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ye(e)?e:e+""}var xe=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._params=e,this._storyId=e.id,this._view=null,this._container=document.querySelector("#pageContent"),this._isLoading=!1,this._error=null,this._story=null,this._fetchStory=this._fetchStory.bind(this),this._handleRetry=this._handleRetry.bind(this)},e=[{key:"init",value:function(){var t=be(me().mark((function t(){return me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._storyId){t.next=4;break}return this._error="Story ID is required",this._renderError(),t.abrupt("return");case 4:return this._renderLoading(),re("#pageContent",{name:"detail-transition",duration:400}),t.next=8,this._fetchStory();case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_fetchStory",value:(n=be(me().mark((function t(){var e;return me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._isLoading=!0,this._error=null,this._renderLoading(),t.next=6,X.getStoryById(this._storyId);case 6:e=t.sent,this._story=e.story,this._isLoading=!1,this._renderView(),t.next=18;break;case 12:t.prev=12,t.t0=t.catch(0),this._isLoading=!1,this._error=t.t0.message||"Failed to load story details. Please try again.",this._renderError();case 18:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return n.apply(this,arguments)})},{key:"_renderLoading",value:function(){this._view=new ve({isLoading:!0,story:null,error:null,container:this._container}),this._view.render()}},{key:"_renderError",value:function(){this._view=new ve({isLoading:!1,story:null,error:this._error,container:this._container}),this._view.render(),this._view.setRetryHandler(this._handleRetry)}},{key:"_renderView",value:function(){this._view=new ve({isLoading:!1,story:this._story,error:null,container:this._container}),this._view.render()}},{key:"_handleRetry",value:function(){this._fetchStory()}},{key:"cleanup",value:function(){this._view&&this._view.cleanup()}}],e&&we(t.prototype,e),r&&we(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const ke=xe;const Ee=function(t){var e=t.isLoading,r=void 0!==e&&e,n=r?'<i class="fas fa-spinner fa-spin"></i> Posting...':'<i class="fas fa-paper-plane"></i> Post Story';return'\n      <section class="add-story">\n        <div class="add-story__header">\n          <h2 class="add-story__title">Add New Story</h2>\n          <a href="#/" class="button secondary">\n            <i class="fas fa-arrow-left"></i> Back to Home\n          </a>\n        </div>\n        \n        <form id="addStoryForm" class="add-story-form">\n          <div class="form-group">\n            <label for="description" class="form-label">Description</label>\n            <textarea \n              id="description" \n              name="description" \n              class="form-textarea" \n              placeholder="Share your story..." \n              required\n              '.concat(r?"disabled":"",'\n            ></textarea>\n          </div>\n          \n          <div class="form-group">\n            <label class="form-label">Photo</label>\n            <div class="photo-capture">\n              <div class="photo-capture__preview-container">\n                <video id="cameraPreview" class="photo-capture__camera" autoplay playsinline></video>\n                <canvas id="photoCanvas" class="photo-capture__canvas"></canvas>\n                <div id="photoPreview" class="photo-capture__preview"></div>\n              </div>\n              \n              <div class="photo-capture__actions">\n                <button \n                  type="button" \n                  id="startCameraButton" \n                  class="button photo-capture__button"\n                  ').concat(r?"disabled":"",'\n                >\n                  <i class="fas fa-camera"></i> Open Camera\n                </button>\n                \n                <button \n                  type="button" \n                  id="takePictureButton" \n                  class="button photo-capture__button" \n                  disabled\n                >\n                  <i class="fas fa-camera-retro"></i> Take Photo\n                </button>\n                \n                <button \n                  type="button" \n                  id="switchCameraButton" \n                  class="button photo-capture__button" \n                  disabled\n                >\n                  <i class="fas fa-sync"></i> Switch Camera\n                </button>\n                \n                <button \n                  type="button" \n                  id="resetPhotoButton" \n                  class="button photo-capture__button" \n                  disabled\n                >\n                  <i class="fas fa-trash"></i> Reset\n                </button>\n              </div>\n              \n              <div class="photo-capture__file-input">\n                <label for="photoInput" class="form-label">Or upload a photo:</label>\n                <input \n                  type="file" \n                  id="photoInput" \n                  name="photo" \n                  accept="image/*" \n                  class="form-input"\n                  ').concat(r?"disabled":"",'\n                />\n              </div>\n            </div>\n          </div>\n          \n          <div class="form-group">\n            <label class="form-label">Location (Optional)</label>\n            <div class="location-picker">\n              <div id="locationMap" class="location-picker__map"></div>\n              \n              <div class="location-picker__actions">\n                <button \n                  type="button" \n                  id="getUserLocationButton" \n                  class="button location-picker__button"\n                  ').concat(r?"disabled":"",'\n                >\n                  <i class="fas fa-map-marker-alt"></i> Use My Location\n                </button>\n                \n                <p class="location-picker__hint">\n                  <i class="fas fa-info-circle"></i> \n                  Or click on the map to select a location\n                </p>\n                \n                <div id="selectedLocation" class="location-picker__selected">\n                  No location selected\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <div class="form-actions">\n            <button \n              type="submit" \n              id="submitButton" \n              class="button"\n              ').concat(r?"disabled":"","\n            >\n              ").concat(n,"\n            </button>\n          </div>\n        </form>\n      </section>\n    ")};function Se(t){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Se(t)}function Oe(){Oe=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Se(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Se(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Pe(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function je(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Pe(Object(r),!0).forEach((function(e){Te(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pe(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Te(t,e,r){return(e=Ce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Le(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ie(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Le(i,n,o,a,s,"next",t)}function s(t){Le(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Ne(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ce(n.key),n)}}function Ce(t){var e=function(t,e){if("object"!=Se(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Se(e)?e:e+""}const Be=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._stream=null,this._videoElement=null,this._canvasElement=null},e=[{key:"initCamera",value:(i=Ie(Oe().mark((function t(e){var r,n,o=arguments;return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:{},e){t.next=3;break}throw new Error("Video element is required");case 3:return this._videoElement=e,n=je(je({},{video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}},audio:!1}),r),t.prev=6,this.stopCamera(),t.next=10,navigator.mediaDevices.getUserMedia(n);case 10:return this._stream=t.sent,this._videoElement.srcObject=this._stream,t.next=14,this._videoElement.play();case 14:return t.abrupt("return",this._stream);case 17:throw t.prev=17,t.t0=t.catch(6),new Error("Could not access camera: ".concat(t.t0.message));case 21:case"end":return t.stop()}}),t,this,[[6,17]])}))),function(t){return i.apply(this,arguments)})},{key:"stopCamera",value:function(){this._stream&&(this._stream.getTracks().forEach((function(t){return t.stop()})),this._stream=null),this._videoElement&&(this._videoElement.srcObject=null)}},{key:"takePhoto",value:function(t){if(!t)throw new Error("Canvas element is required");if(!this._stream||!this._videoElement)throw new Error("Camera not initialized. Call initCamera first.");this._canvasElement=t;var e=this._videoElement.videoWidth,r=this._videoElement.videoHeight;return this._canvasElement.width=e,this._canvasElement.height=r,this._canvasElement.getContext("2d").drawImage(this._videoElement,0,0,e,r),this._getBlobFromCanvas()}},{key:"getPhotoFile",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"photo.jpg";if(!this._canvasElement)throw new Error("No photo has been taken. Call takePhoto first.");return this._getBlobFromCanvas().then((function(e){return new File([e],t,{type:"image/jpeg"})}))}},{key:"switchCamera",value:(o=Ie(Oe().mark((function t(){var e,r,n,o;return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._videoElement){t.next=2;break}throw new Error("Camera not initialized. Call initCamera first.");case 2:return e=this._stream.getVideoTracks()[0],r=e.getSettings(),n="user"===r.facingMode?"environment":"user",o={video:{facingMode:n,width:{ideal:1280},height:{ideal:720}},audio:!1},t.abrupt("return",this.initCamera(this._videoElement,o));case 7:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"_getBlobFromCanvas",value:function(){var t=this;return new Promise((function(e){t._canvasElement.toBlob((function(t){return e(t)}),"image/jpeg",.8)}))}}],r=[{key:"isCameraSupported",value:(n=Ie(Oe().mark((function t(){return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){t.next=2;break}return t.abrupt("return",!1);case 2:return t.prev=2,t.next=5,navigator.mediaDevices.getUserMedia({video:!0});case 5:return t.sent.getTracks().forEach((function(t){return t.stop()})),t.abrupt("return",!0);case 10:return t.prev=10,t.t0=t.catch(2),t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,null,[[2,10]])}))),function(){return n.apply(this,arguments)})}],e&&Ne(t.prototype,e),r&&Ne(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}();function Ae(t){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ae(t)}function Fe(){Fe=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Ae(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ae(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Ge(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Re(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ge(i,n,o,a,s,"next",t)}function s(t){Ge(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Me(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,He(n.key),n)}}function He(t){var e=function(t,e){if("object"!=Ae(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ae(e)?e:e+""}const De=function(){return t=function t(e){var r=e.isLoading,n=void 0!==r&&r,o=e.container;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._isLoading=n,this._container=o,this._mapHelper=new Wt,this._cameraHelper=new Be,this._selectedLocation=null,this._photoFile=null,this._isCameraActive=!1,this._submitHandler=null,this._bindMethods()},e=[{key:"_bindMethods",value:function(){this._initCamera=this._initCamera.bind(this),this._stopCamera=this._stopCamera.bind(this),this._takePhoto=this._takePhoto.bind(this),this._switchCamera=this._switchCamera.bind(this),this._onLocationSelected=this._onLocationSelected.bind(this),this._getUserLocation=this._getUserLocation.bind(this),this._resetPhoto=this._resetPhoto.bind(this),this._handleFileInput=this._handleFileInput.bind(this)}},{key:"render",value:function(){this._container.innerHTML=Ee({isLoading:this._isLoading}),this._initMap(),this._attachEventListeners()}},{key:"_initMap",value:function(){var t=document.getElementById("locationMap");t&&(this._mapHelper.initMap(t),this._mapHelper.setupLocationSelector(this._onLocationSelected))}},{key:"_attachEventListeners",value:function(){var t=this,e={startCameraButton:document.getElementById("startCameraButton"),takePictureButton:document.getElementById("takePictureButton"),switchCameraButton:document.getElementById("switchCameraButton"),resetPhotoButton:document.getElementById("resetPhotoButton"),getUserLocationButton:document.getElementById("getUserLocationButton"),photoInput:document.getElementById("photoInput"),form:document.getElementById("addStoryForm")};e.startCameraButton&&e.startCameraButton.addEventListener("click",this._initCamera),e.takePictureButton&&e.takePictureButton.addEventListener("click",this._takePhoto),e.switchCameraButton&&e.switchCameraButton.addEventListener("click",this._switchCamera),e.resetPhotoButton&&e.resetPhotoButton.addEventListener("click",this._resetPhoto),e.getUserLocationButton&&e.getUserLocationButton.addEventListener("click",this._getUserLocation),e.photoInput&&e.photoInput.addEventListener("change",this._handleFileInput),e.form&&e.form.addEventListener("submit",(function(e){e.preventDefault(),t._validateForm()&&"function"==typeof t._submitHandler&&t._submitHandler(t._getFormData())}))}},{key:"_initCamera",value:(a=Re(Fe().mark((function t(){var e;return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isCameraActive){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,e=document.getElementById("cameraPreview")){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,this._cameraHelper.initCamera(e);case 8:this._isCameraActive=!0,this._updateCameraUI(!0),this._showVideoPreview(),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),alert("Could not access camera: ".concat(t.t0.message));case 17:case"end":return t.stop()}}),t,this,[[2,13]])}))),function(){return a.apply(this,arguments)})},{key:"_stopCamera",value:function(){this._isCameraActive&&(this._cameraHelper.stopCamera(),this._isCameraActive=!1,this._updateCameraUI(!1))}},{key:"_takePhoto",value:(i=Re(Fe().mark((function t(){var e;return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isCameraActive){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,e=document.getElementById("photoCanvas")){t.next=6;break}return t.abrupt("return");case 6:return this._cameraHelper.takePhoto(e),t.next=9,this._cameraHelper.getPhotoFile();case 9:this._photoFile=t.sent,this._showPhotoPreview(),this._updatePhotoUI(!0),this._stopCamera(),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(2),alert("Could not take photo: ".concat(t.t0.message));case 19:case"end":return t.stop()}}),t,this,[[2,15]])}))),function(){return i.apply(this,arguments)})},{key:"_switchCamera",value:(o=Re(Fe().mark((function t(){return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isCameraActive){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,this._cameraHelper.switchCamera();case 5:t.next=11;break;case 7:t.prev=7,t.t0=t.catch(2),alert("Could not switch camera: ".concat(t.t0.message));case 11:case"end":return t.stop()}}),t,this,[[2,7]])}))),function(){return o.apply(this,arguments)})},{key:"_onLocationSelected",value:function(t){this._selectedLocation=t,this._updateLocationUI()}},{key:"_getUserLocation",value:(n=Re(Fe().mark((function t(){return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._mapHelper.getUserLocation();case 3:this._selectedLocation=t.sent,this._updateLocationUI(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),alert("Could not get your location: ".concat(t.t0.message));case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return n.apply(this,arguments)})},{key:"_resetPhoto",value:function(){var t=document.getElementById("photoPreview"),e=document.getElementById("photoCanvas"),r=document.getElementById("photoInput");t&&(t.style.backgroundImage="none"),e&&e.getContext("2d").clearRect(0,0,e.width,e.height),r&&(r.value=""),this._photoFile=null,this._updatePhotoUI(!1)}},{key:"_handleFileInput",value:function(t){var e=this,r=t.target.files[0];if(r){if(!r.type.startsWith("image/"))return alert("Please select an image file"),void(t.target.value="");this._photoFile=r;var n=new FileReader;n.onload=function(t){var r=document.getElementById("photoPreview");r&&(r.style.backgroundImage="url(".concat(t.target.result,")"),e._showPhotoPreview())},n.readAsDataURL(r),this._updatePhotoUI(!0)}}},{key:"_validateForm",value:function(){var t=document.getElementById("description");return t&&t.value.trim()?!!this._photoFile||(alert("Please take or upload a photo for your story"),!1):(alert("Please enter a description for your story"),!1)}},{key:"_getFormData",value:function(){var t={description:document.getElementById("description").value.trim(),photo:this._photoFile};return this._selectedLocation&&(t.lat=this._selectedLocation.lat,t.lon=this._selectedLocation.lon),t}},{key:"_showVideoPreview",value:function(){var t={videoElement:document.getElementById("cameraPreview"),photoPreview:document.getElementById("photoPreview"),canvas:document.getElementById("photoCanvas")};t.videoElement&&t.photoPreview&&t.canvas&&(t.videoElement.style.display="block",t.photoPreview.style.display="none",t.canvas.style.display="none")}},{key:"_showPhotoPreview",value:function(){var t={videoElement:document.getElementById("cameraPreview"),photoPreview:document.getElementById("photoPreview"),canvas:document.getElementById("photoCanvas")};if(t.videoElement&&t.photoPreview&&t.canvas){t.videoElement.style.display="none",t.photoPreview.style.display="block";var e=t.canvas.toDataURL("image/jpeg");t.photoPreview.style.backgroundImage="url(".concat(e,")")}}},{key:"_updateCameraUI",value:function(t){var e={startCameraButton:document.getElementById("startCameraButton"),takePictureButton:document.getElementById("takePictureButton"),switchCameraButton:document.getElementById("switchCameraButton")};e.startCameraButton&&e.takePictureButton&&e.switchCameraButton&&(e.startCameraButton.disabled=t,e.takePictureButton.disabled=!t,e.switchCameraButton.disabled=!t)}},{key:"_updatePhotoUI",value:function(t){var e=document.getElementById("resetPhotoButton"),r=document.getElementById("startCameraButton");e&&r&&(e.disabled=!t,r.disabled=t)}},{key:"_updateLocationUI",value:function(){var t=document.getElementById("selectedLocation");if(t)if(this._selectedLocation){var e=this._selectedLocation,r=e.lat,n=e.lon;t.innerHTML='\n        <i class="fas fa-check-circle"></i>\n        Location selected: <br>\n        <strong>Latitude:</strong> '.concat(r.toFixed(6),", \n        <strong>Longitude:</strong> ").concat(n.toFixed(6),"\n      "),t.classList.add("location-picker__selected--active")}else t.textContent="No location selected",t.classList.remove("location-picker__selected--active")}},{key:"showSuccessMessage",value:function(){var t=document.getElementById("addStoryForm");if(t){var e=document.createElement("div");e.className="success-message",e.innerHTML='\n      <i class="fas fa-check-circle"></i>\n      <p>Your story has been posted successfully!</p>\n      <p>Redirecting to home page...</p>\n    ',t.innerHTML="",t.appendChild(e)}}},{key:"setSubmitHandler",value:function(t){"function"==typeof t&&(this._submitHandler=t)}},{key:"setLoading",value:function(t){this._isLoading=t;var e=document.getElementById("submitButton");e&&(e.disabled=t,e.innerHTML=t?'<i class="fas fa-spinner fa-spin"></i> Posting...':'<i class="fas fa-paper-plane"></i> Post Story'),this._container.querySelectorAll("button, input, textarea").forEach((function(e){"takePictureButton"!==e.id&&"switchCameraButton"!==e.id&&"resetPhotoButton"!==e.id&&(e.disabled=t)}))}},{key:"cleanup",value:function(){this._stopCamera()}}],e&&Me(t.prototype,e),r&&Me(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a}();function Ue(t){return Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ue(t)}function Ye(){Ye=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Ue(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ue(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function qe(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function ze(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){qe(i,n,o,a,s,"next",t)}function s(t){qe(i,n,o,a,s,"throw",t)}a(void 0)}))}}function We(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ve(n.key),n)}}function Ve(t){var e=function(t,e){if("object"!=Ue(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ue(e)?e:e+""}var Ke=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._params=e,this._view=null,this._container=document.querySelector("#pageContent"),this._isLoading=!1,this._handleSubmit=this._handleSubmit.bind(this)},e=[{key:"init",value:function(){var t=ze(Ye().mark((function t(){return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(vt.isAuthenticated()){t.next=3;break}return g().fire({title:"Authentication Required",text:"Please login to add a new story",icon:"warning",confirmButtonColor:"#2563EB"}).then((function(){window.location.hash="#/login"})),t.abrupt("return");case 3:re("#pageContent",{name:"add-story-transition",duration:400}),this._renderView();case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_renderView",value:function(){this._view=new De({isLoading:this._isLoading,container:this._container}),this._view.render(),this._view.setSubmitHandler(this._handleSubmit)}},{key:"_handleSubmit",value:(n=ze(Ye().mark((function t(e){var r;return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isLoading){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,this._isLoading=!0,this._view&&this._view.setLoading(!0),r=vt.isAuthenticated(),t.next=8,X.addStory(e,r);case 8:t.sent,this._view&&this._view.showSuccessMessage(),g().fire({title:"Story Posted!",text:"Your story has been successfully shared",icon:"success",timer:2e3,timerProgressBar:!0,showConfirmButton:!1}),setTimeout((function(){window.location.hash="#/"}),2e3),t.next=20;break;case 14:t.prev=14,t.t0=t.catch(2),g().fire({title:"Failed to Post Story",text:t.t0.message||"An error occurred while posting your story",icon:"error",confirmButtonColor:"#2563EB"}),this._isLoading=!1,this._view&&this._view.setLoading(!1);case 20:case"end":return t.stop()}}),t,this,[[2,14]])}))),function(t){return n.apply(this,arguments)})},{key:"cleanup",value:function(){this._view&&this._view.cleanup()}}],e&&We(t.prototype,e),r&&We(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const Qe=Ke;const Je=function(t){var e=t.error,r=void 0===e?null:e,n=t.isLoading,o=void 0!==n&&n,i=r?'\n        <div class="auth-error">\n          <i class="fas fa-exclamation-circle"></i>\n          <p>'.concat(r,"</p>\n        </div>\n      "):"",a=o?'<i class="fas fa-spinner fa-spin"></i> Logging in...':'<i class="fas fa-sign-in-alt"></i> Login';return'\n      <section class="auth">\n        <div class="auth-container">\n          <h2 class="auth__title">Login</h2>\n          \n          '.concat(i,'\n          \n          <form id="loginForm" class="auth-form">\n            <div class="form-group">\n              <label for="email" class="form-label">Email</label>\n              <input \n                type="email" \n                id="email" \n                name="email" \n                class="form-input" \n                placeholder="your.email@example.com" \n                required\n                ').concat(o?"disabled":"",'\n              />\n            </div>\n            \n            <div class="form-group">\n              <label for="password" class="form-label">Password</label>\n              <input \n                type="password" \n                id="password" \n                name="password" \n                class="form-input" \n                placeholder="Your password" \n                required\n                minlength="8"\n                ').concat(o?"disabled":"",'\n              />\n            </div>\n            \n            <div class="form-actions">\n              <button \n                type="submit" \n                id="loginButton" \n                class="button"\n                ').concat(o?"disabled":"","\n              >\n                ").concat(a,'\n              </button>\n            </div>\n          </form>\n          \n          <div class="auth-footer">\n            <p>Don\'t have an account?</p>\n            <a href="#/register" class="auth-link">Register here</a>\n          </div>\n        </div>\n      </section>\n    ')};function Ze(t){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ze(t)}function $e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xe(n.key),n)}}function Xe(t){var e=function(t,e){if("object"!=Ze(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ze(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ze(e)?e:e+""}const tr=function(){return t=function t(e){var r=e.error,n=void 0===r?null:r,o=e.isLoading,i=void 0!==o&&o,a=e.container;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._error=n,this._isLoading=i,this._container=a,this._loginHandler=null},e=[{key:"render",value:function(){this._container.innerHTML=Je({error:this._error,isLoading:this._isLoading}),this._attachEventListeners()}},{key:"_attachEventListeners",value:function(){var t=this,e=document.getElementById("loginForm");e&&!this._isLoading&&e.addEventListener("submit",(function(e){if(e.preventDefault(),t._validateForm()){var r=document.getElementById("email").value.trim(),n=document.getElementById("password").value;t._loginHandler&&t._loginHandler({email:r,password:n})}}))}},{key:"_validateForm",value:function(){var t=document.getElementById("email"),e=document.getElementById("password");return t.validity.valid?!(e.value.length<8&&(this._showFieldError(e,"Password must be at least 8 characters long"),1)):(this._showFieldError(t,"Please enter a valid email address"),!1)}},{key:"_showFieldError",value:function(t,e){t.classList.add("form-input--error");var r=t.nextElementSibling;r&&r.classList.contains("form-error")||((r=document.createElement("p")).className="form-error",t.parentNode.insertBefore(r,t.nextSibling)),r.textContent=e,t.addEventListener("input",(function(){t.classList.remove("form-input--error"),r&&r.parentNode&&r.parentNode.removeChild(r)}),{once:!0})}},{key:"setLoginHandler",value:function(t){this._loginHandler=t}},{key:"setLoading",value:function(t){this._isLoading=t;var e=document.getElementById("loginButton");e&&(e.disabled=t,e.innerHTML=t?'<i class="fas fa-spinner fa-spin"></i> Logging in...':'<i class="fas fa-sign-in-alt"></i> Login'),this._container.querySelectorAll(".form-input").forEach((function(e){e.disabled=t}))}},{key:"cleanup",value:function(){var t=document.getElementById("loginForm");t&&t.removeEventListener("submit",this._handleSubmit)}}],e&&$e(t.prototype,e),r&&$e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function er(t){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},er(t)}function rr(){rr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==er(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(er(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function nr(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function or(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){nr(i,n,o,a,s,"next",t)}function s(t){nr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ir(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ar(n.key),n)}}function ar(t){var e=function(t,e){if("object"!=er(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==er(e)?e:e+""}var sr=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._params=e,this._view=null,this._container=document.querySelector("#pageContent"),this._error=null,this._isLoading=!1,this._handleLogin=this._handleLogin.bind(this)},e=[{key:"init",value:function(){var t=or(rr().mark((function t(){return rr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!vt.isAuthenticated()){t.next=3;break}return window.location.hash="#/",t.abrupt("return");case 3:re("#pageContent",{name:"login-transition",duration:400}),this._renderView();case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_renderView",value:function(){this._view=new tr({error:this._error,isLoading:this._isLoading,container:this._container}),this._view.render(),this._view.setLoginHandler(this._handleLogin)}},{key:"_handleLogin",value:(n=or(rr().mark((function t(e){return rr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isLoading){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,this._isLoading=!0,this._view&&this._view.setLoading(!0),t.next=7,vt.login(e);case 7:g().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:function(t){t.addEventListener("mouseenter",g().stopTimer),t.addEventListener("mouseleave",g().resumeTimer)}}).fire({icon:"success",title:"Login berhasil"}),window.location.hash="#/",t.next=18;break;case 12:t.prev=12,t.t0=t.catch(2),this._error=t.t0.message||"Login failed. Please check your credentials and try again.",this._isLoading=!1,this._renderView();case 18:return t.prev=18,this._isLoading=!1,this._view&&this._view.setLoading(!1),t.finish(18);case 22:case"end":return t.stop()}}),t,this,[[2,12,18,22]])}))),function(t){return n.apply(this,arguments)})},{key:"cleanup",value:function(){this._view&&this._view.cleanup()}}],e&&ir(t.prototype,e),r&&ir(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const ur=sr;const cr=function(t){var e=t.error,r=void 0===e?null:e,n=t.isLoading,o=void 0!==n&&n,i=r?'\n        <div class="auth-error">\n          <i class="fas fa-exclamation-circle"></i>\n          <p>'.concat(r,"</p>\n        </div>\n      "):"",a=o?'<i class="fas fa-spinner fa-spin"></i> Registering...':'<i class="fas fa-user-plus"></i> Register';return'\n      <section class="auth">\n        <div class="auth-container">\n          <h2 class="auth__title">Register</h2>\n          \n          '.concat(i,'\n          \n          <form id="registerForm" class="auth-form">\n            <div class="form-group">\n              <label for="name" class="form-label">Name</label>\n              <input \n                type="text" \n                id="name" \n                name="name" \n                class="form-input" \n                placeholder="Your name" \n                required\n                ').concat(o?"disabled":"",'\n              />\n            </div>\n            \n            <div class="form-group">\n              <label for="email" class="form-label">Email</label>\n              <input \n                type="email" \n                id="email" \n                name="email" \n                class="form-input" \n                placeholder="your.email@example.com" \n                required\n                ').concat(o?"disabled":"",'\n              />\n            </div>\n            \n            <div class="form-group">\n              <label for="password" class="form-label">Password</label>\n              <input \n                type="password" \n                id="password" \n                name="password" \n                class="form-input" \n                placeholder="Min. 8 characters" \n                required\n                minlength="8"\n                ').concat(o?"disabled":"",'\n              />\n              <p class="form-hint">Password must be at least 8 characters</p>\n            </div>\n            \n            <div class="form-group">\n              <label for="confirmPassword" class="form-label">Confirm Password</label>\n              <input \n                type="password" \n                id="confirmPassword" \n                name="confirmPassword" \n                class="form-input" \n                placeholder="Confirm your password" \n                required\n                minlength="8"\n                ').concat(o?"disabled":"",'\n              />\n            </div>\n            \n            <div class="form-actions">\n              <button \n                type="submit" \n                id="registerButton" \n                class="button"\n                ').concat(o?"disabled":"","\n              >\n                ").concat(a,'\n              </button>\n            </div>\n          </form>\n          \n          <div class="auth-footer">\n            <p>Already have an account?</p>\n            <a href="#/login" class="auth-link">Login here</a>\n          </div>\n        </div>\n      </section>\n    ')};function lr(t){return lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lr(t)}function fr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hr(n.key),n)}}function hr(t){var e=function(t,e){if("object"!=lr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=lr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==lr(e)?e:e+""}const pr=function(){return t=function t(e){var r=e.error,n=void 0===r?null:r,o=e.isLoading,i=void 0!==o&&o,a=e.container;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._error=n,this._isLoading=i,this._container=a,this._registerHandler=null},e=[{key:"render",value:function(){this._container.innerHTML=cr({error:this._error,isLoading:this._isLoading}),this._attachEventListeners()}},{key:"_attachEventListeners",value:function(){var t=this,e=document.getElementById("registerForm");e&&!this._isLoading&&e.addEventListener("submit",this._handleSubmit=function(e){if(e.preventDefault(),t._validateForm()){var r=document.getElementById("name").value.trim(),n=document.getElementById("email").value.trim(),o=document.getElementById("password").value;t._registerHandler&&t._registerHandler({name:r,email:n,password:o})}})}},{key:"_validateForm",value:function(){var t=document.getElementById("name"),e=document.getElementById("email"),r=document.getElementById("password"),n=document.getElementById("confirmPassword");return t.value.trim()?e.validity.valid?r.value.length<8?(this._showFieldError(r,"Password must be at least 8 characters long"),!1):r.value===n.value||(this._showFieldError(n,"Passwords do not match"),!1):(this._showFieldError(e,"Please enter a valid email address"),!1):(this._showFieldError(t,"Please enter your name"),!1)}},{key:"_showFieldError",value:function(t,e){t.classList.add("form-input--error");var r=t.nextElementSibling;r&&r.classList.contains("form-error")||((r=document.createElement("p")).className="form-error",t.parentNode.insertBefore(r,t.nextSibling)),r.textContent=e,t.addEventListener("input",(function(){t.classList.remove("form-input--error"),r&&r.parentNode&&r.parentNode.removeChild(r)}),{once:!0})}},{key:"setRegisterHandler",value:function(t){this._registerHandler=t}},{key:"setLoading",value:function(t){this._isLoading=t;var e=document.getElementById("registerButton");e&&(e.disabled=t,e.innerHTML=t?'<i class="fas fa-spinner fa-spin"></i> Registering...':'<i class="fas fa-user-plus"></i> Register'),this._container.querySelectorAll(".form-input").forEach((function(e){e.disabled=t}))}},{key:"showSuccessMessage",value:function(){var t=document.getElementById("registerForm");if(t){var e=document.createElement("div");e.className="success-message",e.innerHTML='\n      <i class="fas fa-check-circle"></i>\n      <p>Registration successful!</p>\n      <p>Redirecting to login page...</p>\n    ',t.innerHTML="",t.appendChild(e)}}},{key:"cleanup",value:function(){var t=document.getElementById("registerForm");t&&t.removeEventListener("submit",this._handleSubmit)}}],e&&fr(t.prototype,e),r&&fr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function dr(t){return dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dr(t)}function vr(){vr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==dr(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(dr(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function yr(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function mr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){yr(i,n,o,a,s,"next",t)}function s(t){yr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function gr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,br(n.key),n)}}function br(t){var e=function(t,e){if("object"!=dr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=dr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==dr(e)?e:e+""}var wr=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._params=e,this._view=null,this._container=document.querySelector("#pageContent"),this._error=null,this._isLoading=!1,this._handleRegister=this._handleRegister.bind(this)},e=[{key:"init",value:function(){var t=mr(vr().mark((function t(){return vr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!vt.isAuthenticated()){t.next=3;break}return g().fire({title:"Already Logged In",text:"You are already logged in. Please log out first to register a new account.",icon:"info",confirmButtonColor:"#2563EB"}).then((function(){window.location.hash="#/"})),t.abrupt("return");case 3:re("#pageContent",{name:"register-transition",duration:400}),this._renderView();case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_renderView",value:function(){this._view=new pr({error:this._error,isLoading:this._isLoading,container:this._container}),this._view.render(),this._view.setRegisterHandler(this._handleRegister)}},{key:"_handleRegister",value:(n=mr(vr().mark((function t(e){return vr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isLoading){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,this._isLoading=!0,this._view&&this._view.setLoading(!0),t.next=7,vt.register(e);case 7:this._view&&this._view.showSuccessMessage(),g().fire({title:"Registration Successful!",text:"Your account has been created. You can now log in.",icon:"success",confirmButtonColor:"#2563EB",confirmButtonText:"Login Now"}).then((function(){window.location.hash="#/login"})),t.next=17;break;case 11:t.prev=11,t.t0=t.catch(2),this._error=t.t0.message||"Registration failed. Please try again.",this._isLoading=!1,this._renderView();case 17:return t.prev=17,this._isLoading=!1,this._view&&this._view.setLoading(!1),t.finish(17);case 21:case"end":return t.stop()}}),t,this,[[2,11,17,21]])}))),function(t){return n.apply(this,arguments)})},{key:"cleanup",value:function(){this._view&&this._view.cleanup()}}],e&&gr(t.prototype,e),r&&gr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function _r(t){return _r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_r(t)}function xr(){xr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==_r(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(_r(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function kr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Er(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Er(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Er(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Sr(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Or(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Sr(i,n,o,a,s,"next",t)}function s(t){Sr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Pr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jr(n.key),n)}}function jr(t){var e=function(t,e){if("object"!=_r(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_r(e)?e:e+""}var Tr={"/":le,"/detail/:id":ke,"/add":Qe,"/login":ur,"/register":wr},Lr=["mainContent","pageContent"];const Ir=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._currentPage=null,this._routes=Tr,this._loadPage=this._loadPage.bind(this),this.navigate=this.navigate.bind(this)},e=[{key:"init",value:function(){window.addEventListener("hashchange",this._loadPage),this._loadPage()}},{key:"_loadPage",value:(n=Or(xr().mark((function t(){var e,r,n,o,i,a,s,u=this;return xr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.location.hash.slice(1)||"/",!Lr.includes(e)){t.next=5;break}return(r=document.getElementById(e))&&(r.hasAttribute("tabindex")||r.setAttribute("tabindex","-1"),r.focus(),r.scrollIntoView()),t.abrupt("return");case 5:n=null,o={},i=xr().mark((function t(){var r,i,c,l,f,h,p;return xr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=kr(s[a],2),i=r[0],c=r[1],l=u._convertRouteToRegex(i),!(f=e.match(l))){t.next=7;break}return i.includes(":")&&(h=i.split("/").filter((function(t){return t.startsWith(":")})).map((function(t){return t.slice(1)})),p=f.slice(1),h.forEach((function(t,e){o[t]=p[e]}))),n=c,t.abrupt("return",1);case 7:case"end":return t.stop()}}),t)})),a=0,s=Object.entries(this._routes);case 9:if(!(a<s.length)){t.next=16;break}return t.delegateYield(i(),"t0",11);case 11:if(!t.t0){t.next=13;break}return t.abrupt("break",16);case 13:a++,t.next=9;break;case 16:if(this._currentPage&&"function"==typeof this._currentPage.cleanup&&this._currentPage.cleanup(),!n){t.next=32;break}if(!this._isProtectedRoute(e)||this._isAuthenticated()){t.next=21;break}return g().fire({title:"Login Required",text:"Please login to access this page",icon:"info",confirmButtonColor:"#2563EB"}).then((function(){u.navigate("/login")})),t.abrupt("return");case 21:return t.prev=21,t.next=24,ee(Or(xr().mark((function t(){return xr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u._currentPage=new n(o),t.next=3,u._currentPage.init();case 3:case"end":return t.stop()}}),t)}))));case 24:t.next=30;break;case 26:t.prev=26,t.t1=t.catch(21),document.querySelector("#pageContent").innerHTML='\n          <div class="error-container">\n            <i class="fas fa-exclamation-circle error-icon"></i>\n            <h2>Oops! Something went wrong</h2>\n            <p class="error-message">'.concat(t.t1.message,'</p>\n            <button class="button" onclick="window.location.reload()">\n              <i class="fas fa-redo"></i> Try Again\n            </button>\n          </div>\n        ');case 30:t.next=33;break;case 32:document.querySelector("#pageContent").innerHTML='\n        <div class="error-container">\n          <i class="fas fa-search error-icon"></i>\n          <h2>Page Not Found</h2>\n          <p class="error-message">The page you\'re looking for doesn\'t exist.</p>\n          <button class="button" onclick="window.location.hash = \'#\'">\n            <i class="fas fa-home"></i> Go to Homepage\n          </button>\n        </div>\n      ';case 33:case"end":return t.stop()}}),t,this,[[21,26]])}))),function(){return n.apply(this,arguments)})},{key:"navigate",value:function(t){window.location.hash=t}},{key:"_isProtectedRoute",value:function(t){return["/add","/detail"].some((function(e){return t.startsWith(e)}))}},{key:"_isAuthenticated",value:function(){return vt.isAuthenticated()}},{key:"_convertRouteToRegex",value:function(t){var e=t.replace(/\//g,"\\/").replace(/:\w+/g,"([^/]+)");return new RegExp("^".concat(e,"$"))}}],e&&Pr(t.prototype,e),r&&Pr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Nr(t){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nr(t)}function Cr(){Cr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Nr(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Nr(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Br(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ar(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Br(i,n,o,a,s,"next",t)}function s(t){Br(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Fr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Gr(n.key),n)}}function Gr(t){var e=function(t,e){if("object"!=Nr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Nr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Nr(e)?e:e+""}document.addEventListener("DOMContentLoaded",(function(){var t=document.querySelector(".skip-link");t&&t.addEventListener("click",(function(t){t.preventDefault();var e=document.getElementById("mainContent");e&&(e.hasAttribute("tabindex")||e.setAttribute("tabindex","-1"),e.focus(),e.scrollIntoView())}));var e=document.getElementById("appBar"),r=document.createElement("app-bar");e.appendChild(r),(new Ir).init()}));var Rr=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._deferredPrompt=null,this._setupEventListeners()},e=[{key:"_setupEventListeners",value:function(){var t=this;window.addEventListener("beforeinstallprompt",(function(e){e.preventDefault(),t._deferredPrompt=e,t._showInstallPromotion()})),window.addEventListener("appinstalled",(function(){t._hideInstallPromotion(),t._deferredPrompt=null,t._showSuccessfulInstallMessage()}))}},{key:"_showInstallPromotion",value:function(){var t=this;if(!this._isAlreadyInstalled()){var e=document.getElementById("install-button");e?(e.style.display="block",e.addEventListener("click",(function(){return t.promptInstall()}))):this._showInstallToast()}}},{key:"_hideInstallPromotion",value:function(){var t=document.getElementById("install-button");t&&(t.style.display="none")}},{key:"_showInstallToast",value:function(){var t=this;setTimeout((function(){g().fire({title:"Pasang Aplikasi?",text:"Pasang aplikasi ini ke layar utama untuk pengalaman yang lebih baik",icon:"info",showCancelButton:!0,confirmButtonColor:"#2563EB",cancelButtonColor:"#6B7280",confirmButtonText:"Pasang Sekarang",cancelButtonText:"Nanti Saja"}).then((function(e){e.isConfirmed&&t.promptInstall()}))}),3e3)}},{key:"_showSuccessfulInstallMessage",value:function(){g().fire({title:"Pemasangan Berhasil!",text:"Aplikasi telah terpasang di layar utama Anda",icon:"success",confirmButtonColor:"#2563EB"})}},{key:"_isAlreadyInstalled",value:function(){return window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone}},{key:"promptInstall",value:(n=Ar(Cr().mark((function t(){return Cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._deferredPrompt){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,this._deferredPrompt.prompt(),t.next=7,this._deferredPrompt.userChoice;case 7:t.sent.outcome,this._deferredPrompt=null,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3);case 15:case"end":return t.stop()}}),t,this,[[3,12]])}))),function(){return n.apply(this,arguments)})},{key:"canInstall",value:function(){return!!this._deferredPrompt}}],e&&Fr(t.prototype,e),r&&Fr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}());function Mr(){return Hr.apply(this,arguments)}function Hr(){return(Hr=Ar(Cr().mark((function t(){var e;return Cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x();case 3:if(!(e=t.sent)){t.next=8;break}return t.next=7,st.init();case 7:case 8:return window.addEventListener("offline",(function(){})),window.addEventListener("online",(function(){X.syncOfflineQueue()})),window.webPushHelper=st,window.swRegistration=e,t.abrupt("return",e);case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",null);case 19:case"end":return t.stop()}}),t,null,[[0,15]])})))).apply(this,arguments)}function Dr(){return Ur.apply(this,arguments)}function Ur(){return(Ur=Ar(Cr().mark((function t(){return Cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,U.getAllStories();case 3:t.sent,window.StoryIdb=U,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))).apply(this,arguments)}function Yr(){return(Yr=Ar(Cr().mark((function t(){return Cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Mr();case 2:return t.next=4,Dr();case 4:navigator.onLine&&X.syncOfflineQueue(),window.installablePWA=Rr;case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}document.addEventListener("DOMContentLoaded",(function(){return Yr.apply(this,arguments)}))}},r={};function n(t){var o=r[t];if(void 0!==o)return o.exports;var i=r[t]={id:t,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.exports}n.m=e,t=[],n.O=(e,r,o,i)=>{if(!r){var a=1/0;for(l=0;l<t.length;l++){for(var[r,o,i]=t[l],s=!0,u=0;u<r.length;u++)(!1&i||a>=i)&&Object.keys(n.O).every((t=>n.O[t](r[u])))?r.splice(u--,1):(s=!1,i<a&&(a=i));if(s){t.splice(l--,1);var c=o();void 0!==c&&(e=c)}}return e}i=i||0;for(var l=t.length;l>0&&t[l-1][2]>i;l--)t[l]=t[l-1];t[l]=[r,o,i]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={524:0};n.O.j=e=>0===t[e];var e=(e,r)=>{var o,i,[a,s,u]=r,c=0;if(a.some((e=>0!==t[e]))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(u)var l=u(n)}for(e&&e(r);c<a.length;c++)i=a[c],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(l)},r=self.webpackChunkdicoding_story=self.webpackChunkdicoding_story||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})(),n.nc=void 0;var o=n.O(void 0,[622],(()=>n(903)));o=n.O(o)})();
//# sourceMappingURL=app.cb36763f509c3938d6f4.js.map