/*! For license information please see app.12c041f4decf5aa6e5ac.js.LICENSE.txt */
(()=>{"use strict";var t,e={177:(t,e,r)=>{r.d(e,{A:()=>s});var n=r(354),o=r.n(n),i=r(314),a=r.n(i)()(o());a.push([t.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/styles/styles.css"],names:[],mappings:"AAAA;QACS,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const s=a},958:(t,e,r)=>{r(153),r(612),r(423),r(426),r(303);var n=r(72),o=r.n(n),i=r(825),a=r.n(i),s=r(659),u=r.n(s),c=r(56),l=r.n(c),f=r(540),h=r.n(f),p=r(113),d=r.n(p),v=r(177),y={};y.styleTagTransform=d(),y.setAttributes=l(),y.insert=u().bind(null,"head"),y.domAPI=a(),y.insertStyleElement=h();o()(v.A,y);v.A&&v.A.locals&&v.A.locals;var m=r(465),g=r.n(m);function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function w(){w=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==b(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function S(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function P(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(b(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},_(x.prototype),u(x.prototype,a,(function(){return this})),e.AsyncIterator=x,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new x(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},_(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=P,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),S(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:P(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function _(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return x(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function k(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function E(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){k(i,n,o,a,s,"next",t)}function s(t){k(i,n,o,a,s,"throw",t)}a(void 0)}))}}var S=function(){var t=E(w().mark((function t(){var e,r,n,o,i,a;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator){t.next=3;break}return t.abrupt("return",null);case 3:return t.prev=3,t.next=6,navigator.serviceWorker.getRegistrations();case 6:e=t.sent,r=_(e);try{for(r.s();!(n=r.n()).done;)o=n.value,o.scope.includes(window.location.origin)}catch(t){r.e(t)}finally{r.f()}return t.next=11,navigator.serviceWorker.register("/service-worker.js",{scope:"/",updateViaCache:"none"});case 11:return i=t.sent,a=!1,navigator.serviceWorker.addEventListener("controllerchange",(function(){a||(a=!0,window.location.reload())})),navigator.serviceWorker.addEventListener("message",(function(t){var e,r;"SYNC_STORIES"===(null===(e=t.data)||void 0===e?void 0:e.type)?window.dispatchEvent(new CustomEvent("sw-sync-stories",{detail:t.data})):"SYNC_AUTH"===(null===(r=t.data)||void 0===r?void 0:r.type)&&window.dispatchEvent(new CustomEvent("sw-sync-auth",{detail:t.data}))})),i.waiting&&O(i),i.addEventListener("updatefound",(function(){var t=i.installing;t&&t.addEventListener("statechange",(function(){"installed"===t.state&&(navigator.serviceWorker.controller?O(i):g().fire({title:"Aplikasi siap offline!",text:"Anda dapat menggunakan aplikasi ini tanpa koneksi internet.",icon:"success",confirmButtonColor:"#2563EB",confirmButtonText:"Mengerti",timer:5e3,timerProgressBar:!0})),t.state}))})),i.active&&!navigator.serviceWorker.controller&&window.location.reload(),setInterval((function(){i.update().catch((function(t){}))}),6e4),t.abrupt("return",i);case 23:return t.prev=23,t.t0=t.catch(3),"SecurityError"===t.t0.name||t.t0.name,t.abrupt("return",null);case 28:case"end":return t.stop()}}),t,null,[[3,23]])})));return function(){return t.apply(this,arguments)}}();function O(t){g().fire({title:"Update tersedia!",text:"Aplikasi telah diperbarui. Refresh untuk melihat versi terbaru.",icon:"info",showCancelButton:!0,confirmButtonColor:"#2563EB",cancelButtonColor:"#6B7280",confirmButtonText:"Refresh Sekarang",cancelButtonText:"Nanti Saja",allowOutsideClick:!1,allowEscapeKey:!1}).then((function(e){e.isConfirmed?j(t):setTimeout((function(){P(t)}),3e5)}))}function P(t){t.waiting&&g().fire({title:"Update masih tersedia",text:"Jangan lupa untuk refresh aplikasi agar mendapatkan fitur terbaru.",icon:"info",showCancelButton:!0,confirmButtonColor:"#2563EB",cancelButtonColor:"#6B7280",confirmButtonText:"Refresh Sekarang",cancelButtonText:"Ingatkan Lagi",timer:1e4,timerProgressBar:!0}).then((function(e){e.isConfirmed?j(t):(e.dismiss===g().DismissReason.timer||e.isDismissed)&&setTimeout((function(){P(t)}),6e5)}))}function j(t){if(t.waiting)try{t.waiting.postMessage({type:"SKIP_WAITING",timestamp:Date.now()})}catch(t){window.location.reload()}}const T={BASE_URL:"https://story-api.dicoding.dev/v1",ENDPOINTS:{REGISTER:"/register",LOGIN:"/login",STORIES:"/stories",GUEST_STORY:"/stories/guest",NOTIFICATIONS_SUBSCRIBE:"/notifications/subscribe"},DEFAULT_HEADERS:{"Content-Type":"application/json"},MAP:{DEFAULT_CENTER:[-6.2088,106.8456],DEFAULT_ZOOM:13,TILE_LAYER:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",ATTRIBUTION:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',SECONDARY_TILE_LAYER:{name:"Satellite",url:"https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",attribution:"&copy; Google Maps",maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}},WEB_PUSH:{VAPID_PUBLIC_KEY:"BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk"}};function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function L(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return I(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function C(){C=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==F(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(F(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function N(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function A(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){N(i,n,o,a,s,"next",t)}function s(t){N(i,n,o,a,s,"throw",t)}a(void 0)}))}}function B(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,G(n.key),n)}}function G(t){var e=function(t,e){if("object"!=F(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==F(e)?e:e+""}const M=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.baseURL=T.BASE_URL,this.defaultHeaders=T.DEFAULT_HEADERS},e=[{key:"_getToken",value:function(){return localStorage.getItem("auth_token")}},{key:"_getAuthHeader",value:function(){var t=this._getToken();return t?{Authorization:"Bearer ".concat(t)}:{}}},{key:"_handleResponse",value:(c=A(C().mark((function t(e){var r,n;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ok){t.next=6;break}return t.next=3,e.json().catch((function(){return{}}));case 3:throw r=t.sent,n=r.message||e.statusText||"Server error",new Error(n);case 6:return t.abrupt("return",e.json());case 7:case"end":return t.stop()}}),t)}))),function(t){return c.apply(this,arguments)})},{key:"_buildUrl",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URLSearchParams;Object.entries(e).forEach((function(t){var e=L(t,2),n=e[0],o=e[1];null!=o&&r.append(n,o)}));var n=r.toString();return"".concat(this.baseURL).concat(t).concat(n?"?".concat(n):"")}},{key:"_createHeaders",value:function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e={};return(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&Object.assign(e,this._getAuthHeader()),t?e["Content-Type"]=t:!1!==t&&Object.assign(e,this.defaultHeaders),e}},{key:"get",value:(u=A(C().mark((function t(e){var r,n,o,i,a,s=arguments;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=!(s.length>2&&void 0!==s[2])||s[2],o=this._buildUrl(e,r),i=this._createHeaders(n),t.next=6,fetch(o,{method:"GET",headers:i});case 6:return a=t.sent,t.abrupt("return",this._handleResponse(a));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"post",value:(s=A(C().mark((function t(e){var r,n,o,i,a,s=arguments;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=!(s.length>2&&void 0!==s[2])||s[2],o=this._buildUrl(e),i=this._createHeaders(n,"application/json"),t.next=6,fetch(o,{method:"POST",headers:i,body:JSON.stringify(r)});case 6:return a=t.sent,t.abrupt("return",this._handleResponse(a));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"postForm",value:(a=A(C().mark((function t(e,r){var n,o,i,a,s=arguments;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!(s.length>2&&void 0!==s[2])||s[2],o=this._buildUrl(e),i=this._createHeaders(n,!1),t.next=5,fetch(o,{method:"POST",headers:i,body:r});case 5:return a=t.sent,t.abrupt("return",this._handleResponse(a));case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"put",value:(i=A(C().mark((function t(e){var r,n,o,i,a,s=arguments;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=!(s.length>2&&void 0!==s[2])||s[2],o=this._buildUrl(e),i=this._createHeaders(n,"application/json"),t.next=6,fetch(o,{method:"PUT",headers:i,body:JSON.stringify(r)});case 6:return a=t.sent,t.abrupt("return",this._handleResponse(a));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"patch",value:(o=A(C().mark((function t(e){var r,n,o,i,a,s=arguments;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=!(s.length>2&&void 0!==s[2])||s[2],o=this._buildUrl(e),i=this._createHeaders(n,"application/json"),t.next=6,fetch(o,{method:"PATCH",headers:i,body:JSON.stringify(r)});case 6:return a=t.sent,t.abrupt("return",this._handleResponse(a));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"delete",value:(n=A(C().mark((function t(e){var r,n,o,i,a,s=arguments;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=!(s.length>2&&void 0!==s[2])||s[2],o=this._buildUrl(e),i=this._createHeaders(n,"application/json"),t.next=6,fetch(o,{method:"DELETE",headers:i,body:JSON.stringify(r)});case 6:return a=t.sent,t.abrupt("return",this._handleResponse(a));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})}],e&&B(t.prototype,e),r&&B(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s,u,c}());var D=r(148);function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function H(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function U(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?H(Object(r),!0).forEach((function(e){q(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function q(t,e,r){return(e=Q(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return z(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?z(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function W(){W=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==R(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(R(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function V(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function K(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){V(i,n,o,a,s,"next",t)}function s(t){V(i,n,o,a,s,"throw",t)}a(void 0)}))}}function J(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Q(n.key),n)}}function Q(t){var e=function(t,e){if("object"!=R(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==R(e)?e:e+""}var $="dicoding-story-db",Z="cached-stories",X="favorite-stories";const tt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=null,r=[{key:"_openDB",value:(j=K(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,D.P2)($,2,{upgrade:function(t,e,r){if(!t.objectStoreNames.contains(Z)){var n=t.createObjectStore(Z,{keyPath:"id"});n.createIndex("createdAt","createdAt"),n.createIndex("cachedAt","cachedAt")}if(!t.objectStoreNames.contains(X)){var o=t.createObjectStore(X,{keyPath:"id"});o.createIndex("savedAt","savedAt"),o.createIndex("createdAt","createdAt")}},blocked:function(){},blocking:function(){}}));case 1:case"end":return t.stop()}}),t)}))),function(){return j.apply(this,arguments)})},{key:"_checkDatabaseHealth",value:(P=K(W().mark((function t(){var e,r,n,o,i;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._openDB();case 3:e=t.sent,r=Array.from(e.objectStoreNames),n=0,o=[Z,X];case 7:if(!(n<o.length)){t.next=14;break}if(i=o[n],r.includes(i)){t.next=11;break}throw new Error("Missing object store: ".concat(i));case 11:n++,t.next=7;break;case 14:return t.abrupt("return",!0);case 18:throw t.prev=18,t.t0=t.catch(0),t.t0;case 22:case"end":return t.stop()}}),t,this,[[0,18]])}))),function(){return P.apply(this,arguments)})},{key:"_performTransaction",value:(O=K(W().mark((function t(e,r,n){var o,i,a,s,u;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=3,i=0;case 2:if(!(i<o)){t.next=28;break}return t.prev=3,t.next=6,this._checkDatabaseHealth();case 6:return t.next=8,this._openDB();case 8:return a=t.sent,s=a.transaction(e,r),t.next=12,n(s);case 12:return u=t.sent,t.next=15,s.done;case 15:return t.abrupt("return",u);case 18:if(t.prev=18,t.t0=t.catch(3),++i!==o){t.next=24;break}throw t.t0;case 24:return t.next=26,new Promise((function(t){return setTimeout(t,100*i)}));case 26:t.next=2;break;case 28:case"end":return t.stop()}}),t,this,[[3,18]])}))),function(t,e,r){return O.apply(this,arguments)})},{key:"cacheStoriesForOffline",value:(S=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Array.isArray(e)){t.next=2;break}return t.abrupt("return");case 2:return t.abrupt("return",this._performTransaction(Z,"readwrite",function(){var t=K(W().mark((function t(r){var n,o,i;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Y(e),t.prev=1,n.s();case 3:if((o=n.n()).done){t.next=9;break}return i=o.value,t.next=7,r.store.put(U(U({},i),{},{cachedAt:(new Date).toISOString()}));case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,11,14,17]])})));return function(e){return t.apply(this,arguments)}}()));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return S.apply(this,arguments)})},{key:"cacheStoryForOffline",value:(E=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._performTransaction(Z,"readwrite",function(){var t=K(W().mark((function t(r){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.store.put(U(U({},e),{},{cachedAt:(new Date).toISOString()}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return E.apply(this,arguments)})},{key:"getCachedStories",value:(k=K(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._performTransaction(Z,"readonly",function(){var t=K(W().mark((function t(e){var r;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.store.getAll();case 2:return r=t.sent,t.abrupt("return",r.sort((function(t,e){return new Date(e.createdAt)-new Date(t.createdAt)})));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",[]);case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return k.apply(this,arguments)})},{key:"getCachedStoryById",value:(x=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._performTransaction(Z,"readonly",function(){var t=K(W().mark((function t(r){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.store.get(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",null);case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return x.apply(this,arguments)})},{key:"removeCachedStory",value:(_=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._performTransaction(Z,"readwrite",function(){var t=K(W().mark((function t(r){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.store.delete(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return _.apply(this,arguments)})},{key:"clearCachedStories",value:(w=K(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._performTransaction(Z,"readwrite",function(){var t=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.store.clear();case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t,this)}))),function(){return w.apply(this,arguments)})},{key:"saveToFavorites",value:(b=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._performTransaction(X,"readwrite",function(){var t=K(W().mark((function t(r){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.store.put(U(U({},e),{},{savedAt:(new Date).toISOString()}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return b.apply(this,arguments)})},{key:"removeFromFavorites",value:(g=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._performTransaction(X,"readwrite",function(){var t=K(W().mark((function t(r){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.store.delete(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return g.apply(this,arguments)})},{key:"getFavorites",value:(m=K(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._performTransaction(X,"readonly",function(){var t=K(W().mark((function t(e){var r;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.store.getAll();case 2:return r=t.sent,t.abrupt("return",r.sort((function(t,e){return new Date(e.savedAt)-new Date(t.savedAt)})));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",[]);case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return m.apply(this,arguments)})},{key:"getFavoriteById",value:(y=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._performTransaction(X,"readonly",function(){var t=K(W().mark((function t(r){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.store.get(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",null);case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return y.apply(this,arguments)})},{key:"isFavorited",value:(v=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._performTransaction(X,"readonly",function(){var t=K(W().mark((function t(r){var n;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.store.get(e);case 2:return n=t.sent,t.abrupt("return",!!n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return v.apply(this,arguments)})},{key:"getFavoritesCount",value:(d=K(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._performTransaction(X,"readonly",function(){var t=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.store.count();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",0);case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return d.apply(this,arguments)})},{key:"clearFavorites",value:(p=K(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._performTransaction(X,"readwrite",function(){var t=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.store.clear();case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"saveStories",value:(h=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.cacheStoriesForOffline(e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"saveStory",value:(f=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.cacheStoryForOffline(e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)})},{key:"getAllStories",value:(l=K(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getCachedStories());case 1:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"getStoryById",value:(c=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getCachedStoryById(e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"deleteStory",value:(u=K(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.removeCachedStory(e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"getStorageUsage",value:(s=K(W().mark((function t(){var e,r,n;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._checkDatabaseHealth();case 3:return t.next=5,this._openDB();case 5:return e=t.sent,t.next=8,e.count(Z);case 8:return r=t.sent,t.next=11,e.count(X);case 11:return n=t.sent,t.abrupt("return",{cachedStories:r,favoriteStories:n,totalStories:r+n});case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",{cachedStories:0,favoriteStories:0,totalStories:0});case 19:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(){return s.apply(this,arguments)})},{key:"cleanup",value:(a=K(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._performTransaction(Z,"readwrite",function(){var t=K(W().mark((function t(e){var r,n,o,i,a;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.store.getAll();case 2:r=t.sent,(n=new Date).setDate(n.getDate()-7),o=Y(r),t.prev=6,o.s();case 8:if((i=o.n()).done){t.next=15;break}if(!((a=i.value).cachedAt&&new Date(a.cachedAt)<n)){t.next=13;break}return t.next=13,e.store.delete(a.id);case 13:t.next=8;break;case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(6),o.e(t.t0);case 20:return t.prev=20,o.f(),t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[6,17,20,23]])})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:t.prev=6,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return a.apply(this,arguments)})},{key:"exportFavorites",value:(i=K(W().mark((function t(){var e,r,n;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getFavorites();case 3:return e=t.sent,r={exportDate:(new Date).toISOString(),version:"1.0",favorites:e},n=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),t.abrupt("return",n);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return i.apply(this,arguments)})},{key:"importFavorites",value:(o=K(W().mark((function t(e){var r;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(r=JSON.parse(e)).favorites&&Array.isArray(r.favorites)){t.next=4;break}throw new Error("Invalid export data format");case 4:return t.next=6,this._performTransaction(X,"readwrite",function(){var t=K(W().mark((function t(e){var n,o,i;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Y(r.favorites),t.prev=1,n.s();case 3:if((o=n.n()).done){t.next=9;break}return i=o.value,t.next=7,e.store.put(i);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:return t.abrupt("return",r.favorites.length);case 18:case"end":return t.stop()}}),t,null,[[1,11,14,17]])})));return function(e){return t.apply(this,arguments)}}());case 6:return t.abrupt("return",t.sent);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(t){return o.apply(this,arguments)})},{key:"resetDatabase",value:(n=K(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,indexedDB.databases();case 3:if(!t.sent.find((function(t){return t.name===$}))){t.next=9;break}return t.next=9,new Promise((function(t,e){var r=indexedDB.deleteDatabase($);r.onsuccess=function(){return t()},r.onerror=function(){return e(r.error)},r.onblocked=function(){}}));case 9:return t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",!1);case 17:case"end":return t.stop()}}),t,null,[[0,13]])}))),function(){return n.apply(this,arguments)})}],e&&J(t.prototype,e),r&&J(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s,u,c,l,f,h,p,d,v,y,m,g,b,w,_,x,k,E,S,O,P,j}();function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function rt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return nt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ot(){ot=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==et(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(et(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function it(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function at(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){it(i,n,o,a,s,"next",t)}function s(t){it(i,n,o,a,s,"throw",t)}a(void 0)}))}}function st(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ut(n.key),n)}}function ut(t){var e=function(t,e){if("object"!=et(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==et(e)?e:e+""}var ct=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.offlineQueueKey="offline_story_queue",this.offlineAssetsKey="offline_story_assets",this.favoritesKey="user_favorites",this.syncInProgress=!1,this._setupPeriodicSync()},e=[{key:"isOnline",value:function(){return navigator.onLine}},{key:"getStories",value:(k=at(ot().mark((function t(){var e,r,n,o,i,a,s,u=arguments;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(e=u.length>0&&void 0!==u[0]?u[0]:{}).page,n=e.size,o=e.location,t.prev=1,!this.isOnline()){t.next=13;break}return t.next=5,M.get(T.ENDPOINTS.STORIES,{page:r,size:n,location:o});case 5:if(!1!==(i=t.sent).error||!i.listStory){t.next=10;break}return t.next=9,tt.cacheStoriesForOffline(i.listStory);case 9:this._cacheStoryImages(i.listStory);case 10:return t.abrupt("return",i);case 13:return t.next=15,tt.getCachedStories();case 15:return a=t.sent,t.abrupt("return",{error:!1,message:"Stories loaded from offline storage",listStory:a});case 17:t.next=28;break;case 19:if(t.prev=19,t.t0=t.catch(1),this.isOnline()&&!t.t0.message.includes("Failed to fetch")){t.next=27;break}return t.next=25,tt.getCachedStories();case 25:return s=t.sent,t.abrupt("return",{error:!1,message:"Stories loaded from offline storage",listStory:s});case 27:throw t.t0;case 28:case"end":return t.stop()}}),t,this,[[1,19]])}))),function(){return k.apply(this,arguments)})},{key:"getStoryById",value:(x=at(ot().mark((function t(e){var r,n,o;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("Story ID is required");case 2:if(t.prev=2,!this.isOnline()){t.next=14;break}return t.next=6,M.get("".concat(T.ENDPOINTS.STORIES,"/").concat(e));case 6:if(!1!==(r=t.sent).error||!r.story){t.next=11;break}return t.next=10,tt.cacheStoryForOffline(r.story);case 10:r.story.photoUrl&&this._cacheStoryImage(r.story.photoUrl);case 11:return t.abrupt("return",r);case 14:return t.next=16,tt.getCachedStoryById(e);case 16:if(!(n=t.sent)){t.next=21;break}return t.abrupt("return",{error:!1,message:"Story loaded from offline storage",story:n});case 21:return t.abrupt("return",{error:!0,message:"Story not found in offline storage"});case 22:t.next=34;break;case 24:if(t.prev=24,t.t0=t.catch(2),this.isOnline()&&!t.t0.message.includes("Failed to fetch")){t.next=33;break}return t.next=30,tt.getCachedStoryById(e);case 30:if(!(o=t.sent)){t.next=33;break}return t.abrupt("return",{error:!1,message:"Story loaded from offline storage",story:o});case 33:throw t.t0;case 34:case"end":return t.stop()}}),t,this,[[2,24]])}))),function(t){return x.apply(this,arguments)})},{key:"saveStoryToFavorites",value:(_=at(ot().mark((function t(e){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,tt.saveToFavorites(e);case 3:return e.photoUrl&&this._cacheStoryImage(e.photoUrl),window.dispatchEvent(new CustomEvent("story-favorited",{detail:{storyId:e.id,story:e}})),t.abrupt("return",{error:!1,message:"Story saved to favorites successfully"});case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",{error:!0,message:"Failed to save story to favorites"});case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(t){return _.apply(this,arguments)})},{key:"removeStoryFromFavorites",value:(w=at(ot().mark((function t(e){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,tt.removeFromFavorites(e);case 3:return window.dispatchEvent(new CustomEvent("story-unfavorited",{detail:{storyId:e}})),t.abrupt("return",{error:!1,message:"Story removed from favorites successfully"});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{error:!0,message:"Failed to remove story from favorites"});case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(t){return w.apply(this,arguments)})},{key:"getFavoriteStories",value:(b=at(ot().mark((function t(){var e;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,tt.getFavorites();case 3:return e=t.sent,t.abrupt("return",{error:!1,listStory:e,message:"Favorite stories loaded successfully"});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{error:!0,listStory:[],message:"Failed to load favorite stories"});case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(){return b.apply(this,arguments)})},{key:"isStoryFavorited",value:(g=at(ot().mark((function t(e){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,tt.isFavorited(e);case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,null,[[0,6]])}))),function(t){return g.apply(this,arguments)})},{key:"toggleStoryFavorite",value:(m=at(ot().mark((function t(e){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.isStoryFavorited(e.id);case 3:if(!t.sent){t.next=10;break}return t.next=7,this.removeStoryFromFavorites(e.id);case 7:case 12:return t.abrupt("return",t.sent);case 10:return t.next=12,this.saveStoryToFavorites(e);case 13:t.next=19;break;case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",{error:!0,message:"Failed to toggle favorite status"});case 19:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(t){return m.apply(this,arguments)})},{key:"addStory",value:(y=at(ot().mark((function t(e){var r,n,o,i,a,s,u,c,l,f,h=arguments;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.description,n=e.photo,o=e.lat,i=e.lon,a=!(h.length>1&&void 0!==h[1])||h[1],r&&n){t.next=4;break}throw new Error("Description and photo are required");case 4:if(this.isOnline()){t.next=15;break}return t.next=7,this._tryCompressImage(n);case 7:return s=t.sent,t.next=10,this._addToOfflineQueue({description:r,photo:s,lat:o,lon:i},a);case 10:return u=t.sent,c={id:u,description:r,photoUrl:URL.createObjectURL(s),createdAt:(new Date).toISOString(),lat:o,lon:i,isPending:!0},t.next=14,tt.cacheStoryForOffline(c);case 14:return t.abrupt("return",{error:!1,message:"Story saved offline and will be uploaded when online",tempId:u,tempStory:c});case 15:return l=a?T.ENDPOINTS.STORIES:T.ENDPOINTS.GUEST_STORY,(f=new FormData).append("description",r),f.append("photo",n),void 0!==o&&void 0!==i&&(f.append("lat",o),f.append("lon",i)),t.abrupt("return",M.postForm(l,f,a));case 21:case"end":return t.stop()}}),t,this)}))),function(t){return y.apply(this,arguments)})},{key:"_tryCompressImage",value:(v=at(ot().mark((function t(e){var r,n,o=arguments;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:1,t.prev=1,"function"!=typeof imageCompression){t.next=8;break}return n={maxSizeMB:r,maxWidthOrHeight:1920,useWebWorker:!0},t.next=7,imageCompression(e,n);case 7:return t.abrupt("return",t.sent);case 8:return t.abrupt("return",e);case 11:return t.prev=11,t.t0=t.catch(1),t.abrupt("return",e);case 15:case"end":return t.stop()}}),t,null,[[1,11]])}))),function(t){return v.apply(this,arguments)})},{key:"_addToOfflineQueue",value:(d=at(ot().mark((function t(e,r){var n,o,i;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="temp_".concat(Date.now(),"_").concat(Math.floor(1e4*Math.random())),!(e.photo instanceof Blob)){t.next=6;break}return t.next=4,this._storePhotoOffline(n,e.photo);case 4:e.photoRef=n,delete e.photo;case 6:return o={id:n,data:e,useAuth:r,timestamp:Date.now(),type:"add",status:"pending",retries:0},(i=JSON.parse(localStorage.getItem(this.offlineQueueKey)||"[]")).push(o),localStorage.setItem(this.offlineQueueKey,JSON.stringify(i)),this._registerBackgroundSync(),t.abrupt("return",n);case 12:case"end":return t.stop()}}),t,this)}))),function(t,e){return d.apply(this,arguments)})},{key:"_storePhotoOffline",value:(p=at(ot().mark((function t(e,r){var n;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,indexedDB.open("offline-assets-db",1);case 3:return(n=t.sent).onupgradeneeded=function(t){var e=t.target.result;e.objectStoreNames.contains("photos")||e.createObjectStore("photos",{keyPath:"id"})},t.abrupt("return",new Promise((function(t,o){n.onsuccess=function(n){var i=n.target.result,a=i.transaction("photos","readwrite"),s=a.objectStore("photos").put({id:e,photo:r});s.onsuccess=function(){return t(!0)},s.onerror=function(){return o(s.error)},a.oncomplete=function(){return i.close()}},n.onerror=function(t){o(t.target.error)}})));case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t,null,[[0,8]])}))),function(t,e){return p.apply(this,arguments)})},{key:"_getOfflinePhoto",value:(h=at(ot().mark((function t(e){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.abrupt("return",new Promise((function(t,r){var n=indexedDB.open("offline-assets-db",1);n.onsuccess=function(n){var o=n.target.result,i=o.transaction("photos","readonly"),a=i.objectStore("photos").get(e);a.onsuccess=function(){var e;t((null===(e=a.result)||void 0===e?void 0:e.photo)||null)},a.onerror=function(){r(a.error)},i.oncomplete=function(){return o.close()}},n.onerror=function(t){r(t.target.error)}})));case 4:return t.prev=4,t.t0=t.catch(0),t.abrupt("return",null);case 8:case"end":return t.stop()}}),t,null,[[0,4]])}))),function(t){return h.apply(this,arguments)})},{key:"syncOfflineQueue",value:(f=at(ot().mark((function t(){var e,r,n,o,i,a,s,u,c;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isOnline()&&!this.syncInProgress){t.next=2;break}return t.abrupt("return");case 2:if(this.syncInProgress=!0,t.prev=3,0!==(e=JSON.parse(localStorage.getItem(this.offlineQueueKey)||"[]")).length){t.next=8;break}return this.syncInProgress=!1,t.abrupt("return");case 8:r=[],n=0,o=e.filter((function(t){return"pending"===t.status})).length,o>0&&window.dispatchEvent(new CustomEvent("offline-sync-start",{detail:{total:o}})),i=rt(e),t.prev=13,i.s();case 15:if((a=i.n()).done){t.next=63;break}if("pending"===(s=a.value).status){t.next=20;break}return r.push(s),t.abrupt("continue",61);case 20:if(t.prev=20,"add"!==s.type){t.next=51;break}if(!s.data.photoRef||s.data.photo){t.next=32;break}return t.next=25,this._getOfflinePhoto(s.data.photoRef);case 25:if(!(u=t.sent)){t.next=30;break}s.data.photo=u,t.next=31;break;case 30:throw new Error("Failed to retrieve offline photo");case 31:delete s.data.photoRef;case 32:return t.next=34,this.addStory(s.data,s.useAuth);case 34:if((c=t.sent).error){t.next=47;break}if(s.status="completed",s.response=c,!c.story){t.next=43;break}return t.next=41,tt.removeCachedStory(s.id);case 41:return t.next=43,tt.cacheStoryForOffline(c.story);case 43:this._notifyStoryUploaded(s),s.data.photoRef&&this._deleteOfflinePhoto(s.data.photoRef),t.next=51;break;case 47:s.status="failed",s.error=c.message,s.retries+=1,s.retries<3&&(s.status="pending",r.push(s));case 51:n++,window.dispatchEvent(new CustomEvent("offline-sync-progress",{detail:{current:n,total:o}})),t.next=61;break;case 55:t.prev=55,t.t0=t.catch(20),s.status="failed",s.error=t.t0.message,s.retries+=1,s.retries<3&&(s.status="pending",r.push(s));case 61:t.next=15;break;case 63:t.next=68;break;case 65:t.prev=65,t.t1=t.catch(13),i.e(t.t1);case 68:return t.prev=68,i.f(),t.finish(68);case 71:localStorage.setItem(this.offlineQueueKey,JSON.stringify(r)),window.dispatchEvent(new CustomEvent("offline-sync-complete",{detail:{success:n,failed:o-n}}));case 73:return t.prev=73,this.syncInProgress=!1,t.finish(73);case 76:case"end":return t.stop()}}),t,this,[[3,,73,76],[13,65,68,71],[20,55]])}))),function(){return f.apply(this,arguments)})},{key:"_deleteOfflinePhoto",value:(l=at(ot().mark((function t(e){var r;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,indexedDB.open("offline-assets-db",1);case 3:return r=t.sent,t.abrupt("return",new Promise((function(t,n){r.onsuccess=function(r){var o=r.target.result,i=o.transaction("photos","readwrite"),a=i.objectStore("photos").delete(e);a.onsuccess=function(){return t(!0)},a.onerror=function(){return n(a.error)},i.oncomplete=function(){return o.close()}},r.onerror=function(t){n(t.target.error)}})));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(t){return l.apply(this,arguments)})},{key:"_notifyStoryUploaded",value:function(t){var e;if("Notification"in window&&"granted"===Notification.permission)try{var r;new Notification("Story Uploaded",{body:"Your offline story has been successfully uploaded!",icon:"/favicon.ico",data:{url:"/story/".concat((null===(r=t.response)||void 0===r||null===(r=r.story)||void 0===r?void 0:r.id)||""),timestamp:(new Date).getTime()}})}catch(t){}window.dispatchEvent(new CustomEvent("story-uploaded",{detail:{tempId:t.id,story:null===(e=t.response)||void 0===e?void 0:e.story}}))}},{key:"subscribeToPushNotifications",value:(c=at(ot().mark((function t(e){var r;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=T.ENDPOINTS.NOTIFICATIONS_SUBSCRIBE,t.abrupt("return",M.post(r,e,!0));case 2:case"end":return t.stop()}}),t)}))),function(t){return c.apply(this,arguments)})},{key:"unsubscribeFromPushNotifications",value:(u=at(ot().mark((function t(e){var r;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=T.ENDPOINTS.NOTIFICATIONS_SUBSCRIBE,t.abrupt("return",M.delete("".concat(r,"?endpoint=").concat(encodeURIComponent(e)),!0));case 2:case"end":return t.stop()}}),t)}))),function(t){return u.apply(this,arguments)})},{key:"_registerBackgroundSync",value:function(){"serviceWorker"in navigator&&"SyncManager"in window&&navigator.serviceWorker.ready.then((function(t){t.sync.register("sync-new-stories").catch((function(t){}))}))}},{key:"_setupPeriodicSync",value:(s=at(ot().mark((function t(){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("serviceWorker"in navigator)){t.next=11;break}return t.prev=1,t.next=4,navigator.permissions.query({name:"periodic-background-sync"});case 4:"granted"===t.sent.state&&navigator.serviceWorker.ready.then(function(){var t=at(ot().mark((function t(e){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("periodicSync"in e)){t.next=4;break}return t.next=3,e.periodicSync.register("sync-stories",{minInterval:864e5});case 3:case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1);case 11:case"end":return t.stop()}}),t,null,[[1,8]])}))),function(){return s.apply(this,arguments)})},{key:"_cacheStoryImages",value:(a=at(ot().mark((function t(e){var r,n,o,i,a;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("caches"in window){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,caches.open("story-images-cache");case 5:r=t.sent,n=e.filter((function(t){return t.photoUrl})).map((function(t){return t.photoUrl})),o=rt(n),t.prev=8,a=ot().mark((function t(){var e;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.value,t.next=3,r.match(e);case 3:t.sent||fetch(e,{mode:"no-cors"}).then((function(t){return r.put(e,t)})).catch((function(t){}));case 5:case"end":return t.stop()}}),t)})),o.s();case 11:if((i=o.n()).done){t.next=15;break}return t.delegateYield(a(),"t0",13);case 13:t.next=11;break;case 15:t.next=20;break;case 17:t.prev=17,t.t1=t.catch(8),o.e(t.t1);case 20:return t.prev=20,o.f(),t.finish(20);case 23:t.next=28;break;case 25:t.prev=25,t.t2=t.catch(2);case 28:case"end":return t.stop()}}),t,null,[[2,25],[8,17,20,23]])}))),function(t){return a.apply(this,arguments)})},{key:"_cacheStoryImage",value:(i=at(ot().mark((function t(e){var r;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("caches"in window&&e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,caches.open("story-images-cache");case 5:return r=t.sent,t.next=8,r.match(e);case 8:t.sent||fetch(e,{mode:"no-cors"}).then((function(t){return r.put(e,t)})).catch((function(t){})),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2);case 15:case"end":return t.stop()}}),t,null,[[2,12]])}))),function(t){return i.apply(this,arguments)})},{key:"_getConnectionQuality",value:(o=at(ot().mark((function t(){var e;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("connection"in navigator)){t.next=6;break}if(!(e=navigator.connection).saveData){t.next=4;break}return t.abrupt("return","save-data");case 4:if(!e.effectiveType){t.next=6;break}return t.abrupt("return",e.effectiveType);case 6:return t.abrupt("return","unknown");case 7:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"cleanupExpiredCache",value:(n=at(ot().mark((function t(){var e,r,n,o,i,a,s,u,c,l;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("caches"in window)){t.next=39;break}return t.prev=1,t.next=4,caches.open("story-images-cache");case 4:return e=t.sent,t.next=7,e.keys();case 7:r=t.sent,n=Date.now(),o=2592e6,i=rt(r),t.prev=11,i.s();case 13:if((a=i.n()).done){t.next=26;break}return s=a.value,t.next=17,e.match(s);case 17:if(u=t.sent,!(c=null==u?void 0:u.headers)||!c.get("date")){t.next=24;break}if(l=new Date(c.get("date")).getTime(),!(n-l>o)){t.next=24;break}return t.next=24,e.delete(s);case 24:t.next=13;break;case 26:t.next=31;break;case 28:t.prev=28,t.t0=t.catch(11),i.e(t.t0);case 31:return t.prev=31,i.f(),t.finish(31);case 34:t.next=39;break;case 36:t.prev=36,t.t1=t.catch(1);case 39:case"end":return t.stop()}}),t,null,[[1,36],[11,28,31,34]])}))),function(){return n.apply(this,arguments)})}],e&&st(t.prototype,e),r&&st(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s,u,c,l,f,h,p,d,v,y,m,g,b,w,_,x,k}(),lt=new ct;window.addEventListener("online",(function(){lt.syncOfflineQueue()})),navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",(function(t){t.data&&"SYNC_OFFLINE_STORIES"===t.data.type&&lt.syncOfflineQueue()})),lt.cleanupExpiredCache();const ft=lt;function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function pt(){pt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==ht(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ht(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function dt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function vt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){dt(i,n,o,a,s,"next",t)}function s(t){dt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mt(n.key),n)}}function mt(t){var e=function(t,e){if("object"!=ht(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ht(e)?e:e+""}var gt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._swRegistration=null,this._isSubscribed=!1,this._initialized=!1},e=[{key:"init",value:function(){var t=vt(pt().mark((function t(){return pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._initialized){t.next=2;break}return t.abrupt("return",this._isSubscribed);case 2:if(this._isPushSupported()){t.next=5;break}return t.abrupt("return",!1);case 5:return t.prev=5,t.next=8,navigator.serviceWorker.ready;case 8:return this._swRegistration=t.sent,t.next=11,this._checkSubscription();case 11:return this._isSubscribed=t.sent,this._initialized=!0,t.abrupt("return",this._isSubscribed);case 17:return t.prev=17,t.t0=t.catch(5),t.abrupt("return",!1);case 21:case"end":return t.stop()}}),t,this,[[5,17]])})));return function(){return t.apply(this,arguments)}}()},{key:"_isPushSupported",value:function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}},{key:"subscribe",value:(s=vt(pt().mark((function t(){var e,r,n;return pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=!this._initialized,!t.t0){t.next=5;break}return t.next=4,this.init();case 4:t.t0=!t.sent;case 5:if(!t.t0){t.next=7;break}throw new Error("Web Push Helper initialization failed");case 7:if(!this._isSubscribed){t.next=10;break}return t.abrupt("return",!0);case 10:return t.prev=10,t.next=14,this._swRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this._urlBase64ToUint8Array(T.WEB_PUSH.VAPID_PUBLIC_KEY)});case 14:return e=t.sent,r=this._formatSubscriptionForApi(e),t.next=20,ft.subscribeToPushNotifications(r);case 20:return this._isSubscribed=!0,this._showSuccessNotification("Notifikasi Aktif!","Anda akan menerima notifikasi saat ada story baru."),t.abrupt("return",r);case 26:throw t.prev=26,t.t1=t.catch(10),n="Gagal mengaktifkan notifikasi.","NotAllowedError"===t.t1.name?n="Izin notifikasi ditolak. Mohon aktifkan izin notifikasi di pengaturan browser Anda.":"InvalidStateError"===t.t1.name?n="Anda sudah berlangganan notifikasi sebelumnya.":t.t1.message&&t.t1.message.includes("API")&&(n="Gagal menyimpan langganan ke server. Silakan coba lagi."),this._showErrorNotification("Gagal Aktivasi Notifikasi",n),t.t1;case 33:case"end":return t.stop()}}),t,this,[[10,26]])}))),function(){return s.apply(this,arguments)})},{key:"unsubscribe",value:(a=vt(pt().mark((function t(){var e,r,n;return pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=!this._initialized,!t.t0){t.next=5;break}return t.next=4,this.init();case 4:t.t0=!t.sent;case 5:if(!t.t0){t.next=7;break}throw new Error("Web Push Helper initialization failed");case 7:return t.prev=7,t.next=10,this._swRegistration.pushManager.getSubscription();case 10:if(e=t.sent){t.next=15;break}return this._isSubscribed=!1,t.abrupt("return",!0);case 15:return r=e.endpoint,t.next=19,e.unsubscribe();case 19:if(t.sent){t.next=22;break}throw new Error("Failed to unsubscribe from push service");case 22:return t.next=25,ft.unsubscribeFromPushNotifications(r);case 25:return this._isSubscribed=!1,this._showInfoNotification("Notifikasi Dinonaktifkan","Anda tidak akan menerima notifikasi lagi."),t.abrupt("return",!0);case 31:return t.prev=31,t.t1=t.catch(7),n=t.t1.message||"Terjadi kesalahan saat menonaktifkan notifikasi.",t.t1.message&&t.t1.message.includes("API")&&(n="Gagal menghapus langganan dari server, tapi notifikasi sudah dinonaktifkan."),this._showErrorNotification("Gagal Menonaktifkan Notifikasi",n),t.abrupt("return",!1);case 38:case"end":return t.stop()}}),t,this,[[7,31]])}))),function(){return a.apply(this,arguments)})},{key:"_checkSubscription",value:(i=vt(pt().mark((function t(){var e,r;return pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._swRegistration){t.next=2;break}return t.abrupt("return",!1);case 2:return t.prev=2,t.next=5,this._swRegistration.pushManager.getSubscription();case 5:return e=t.sent,r=Boolean(e),t.abrupt("return",r);case 11:return t.prev=11,t.t0=t.catch(2),t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t,this,[[2,11]])}))),function(){return i.apply(this,arguments)})},{key:"_formatSubscriptionForApi",value:function(t){var e=t.toJSON();return{endpoint:e.endpoint,keys:{p256dh:e.keys.p256dh,auth:e.keys.auth}}}},{key:"_urlBase64ToUint8Array",value:function(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(e),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}},{key:"_showSuccessNotification",value:function(t,e){g().fire({title:t,text:e,icon:"success",confirmButtonColor:"#2563EB"})}},{key:"_showErrorNotification",value:function(t,e){g().fire({title:t,text:e,icon:"error",confirmButtonColor:"#2563EB"})}},{key:"_showInfoNotification",value:function(t,e){g().fire({title:t,text:e,icon:"info",confirmButtonColor:"#2563EB"})}},{key:"requestPermission",value:(o=vt(pt().mark((function t(){var e=this;return pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Notification"in window){t.next=2;break}throw new Error("Browser ini tidak mendukung notifikasi");case 2:if("granted"!==Notification.permission){t.next=7;break}return t.next=6,this.subscribe();case 6:return t.abrupt("return",t.sent);case 7:if("denied"!==Notification.permission){t.next=9;break}throw new Error("Izin notifikasi sudah ditolak sebelumnya");case 9:return t.abrupt("return",new Promise((function(t){g().fire({title:"Aktifkan Notifikasi?",text:"Kami akan memberi tahu Anda saat ada story baru.",icon:"question",showCancelButton:!0,confirmButtonColor:"#2563EB",cancelButtonColor:"#6B7280",confirmButtonText:"Ya, aktifkan!",cancelButtonText:"Nanti saja"}).then(function(){var r=vt(pt().mark((function r(n){var o;return pt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n.isConfirmed){r.next=23;break}return r.prev=1,r.next=5,Notification.requestPermission();case 5:if("granted"!==(o=r.sent)){r.next=12;break}return r.next=10,e.subscribe();case 10:r.next=13;break;case 12:e._showInfoNotification("Notifikasi Tidak Diizinkan","Anda dapat mengaktifkannya nanti melalui pengaturan browser.");case 13:t(o),r.next=21;break;case 16:r.prev=16,r.t0=r.catch(1),e._showErrorNotification("Terjadi Kesalahan","Gagal meminta izin notifikasi. Silakan coba lagi nanti."),t("denied");case 21:r.next=25;break;case 23:t("dismissed");case 25:case"end":return r.stop()}}),r,null,[[1,16]])})));return function(t){return r.apply(this,arguments)}}())})));case 10:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"isSubscribed",value:function(){return this._isSubscribed}},{key:"getRegistration",value:function(){return this._swRegistration}},{key:"sendTestNotification",value:(n=vt(pt().mark((function t(){return pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isSubscribed){t.next=2;break}throw new Error("Not subscribed to push notifications");case 2:case 9:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}],e&&yt(t.prototype,e),r&&yt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s}();const bt=new gt;function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function _t(){_t=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==wt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(wt(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function xt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function kt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){xt(i,n,o,a,s,"next",t)}function s(t){xt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,St(n.key),n)}}function St(t){var e=function(t,e){if("object"!=wt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=wt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==wt(e)?e:e+""}var Ot=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._authStorageKey="auth_token",this._userDataKey="user_data",this._offlineAuthDbName="auth-offline-db",this._offlineAuthStoreName="auth-store",this._db=null,this._syncInterval=null,this._initDatabase(),this._setupEventListeners()},e=[{key:"_initDatabase",value:(d=kt(_t().mark((function t(){return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,D.P2)(this._offlineAuthDbName,1,{upgrade:function(t){t.objectStoreNames.contains("auth-store")||t.createObjectStore("auth-store",{keyPath:"id"}).createIndex("timestamp","timestamp")}});case 3:this._db=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return d.apply(this,arguments)})},{key:"_setupEventListeners",value:function(){var t=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",(function(e){var r;"SYNC_AUTH_DATA"===(null===(r=e.data)||void 0===r?void 0:r.type)&&t.syncOnlineStatus()})),window.addEventListener("online",(function(){return t._handleOnlineStatus()})),window.addEventListener("offline",(function(){return t._handleOfflineStatus()}))}},{key:"_handleOnlineStatus",value:(p=kt(_t().mark((function t(){return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isAuthenticated()){t.next=11;break}return t.prev=1,t.next=4,this.syncOnlineStatus();case 4:t.sent?this._showNotification("Koneksi kembali tersedia. Data akun telah disinkronkan.","success"):(this.logout(),this._showNotification("Sesi telah berakhir. Silakan login kembali.","warning")),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1);case 11:case"end":return t.stop()}}),t,this,[[1,8]])}))),function(){return p.apply(this,arguments)})},{key:"_handleOfflineStatus",value:function(){this.isAuthenticated()&&this._showNotification("Anda sedang offline. Beberapa fitur mungkin terbatas.","info")}},{key:"register",value:(h=kt(_t().mark((function t(e){var r,n,o;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.name,n=e.email,o=e.password,navigator.onLine){t.next=4;break}throw this._showNotification("Tidak dapat mendaftar saat offline","error"),new Error("Tidak dapat mendaftar saat offline. Coba lagi nanti.");case 4:return t.prev=4,t.next=7,M.post(T.ENDPOINTS.REGISTER,{name:r,email:n,password:o},!1);case 7:return t.abrupt("return",t.sent);case 10:throw t.prev=10,t.t0=t.catch(4),t.t0;case 13:case"end":return t.stop()}}),t,this,[[4,10]])}))),function(t){return h.apply(this,arguments)})},{key:"login",value:(f=kt(_t().mark((function t(e){var r,n,o,i;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.email,n=e.password,t.prev=1,t.next=4,M.post(T.ENDPOINTS.LOGIN,{email:r,password:n},!1);case 4:if(!(o=t.sent).loginResult){t.next=10;break}return t.next=8,this._saveAuthData(o.loginResult);case 8:return t.next=10,this._saveCredentialsOffline(r,o.loginResult);case 10:return t.abrupt("return",o);case 13:if(t.prev=13,t.t0=t.catch(1),navigator.onLine){t.next=28;break}return t.next=18,this._tryOfflineLogin(r,n);case 18:if(!(i=t.sent)){t.next=26;break}return this._showNotification("Login offline berhasil","success"),t.next=23,this._saveAuthData(i);case 23:return t.abrupt("return",{loginResult:i});case 26:throw this._showNotification("Login offline gagal","error"),new Error("Tidak dapat login saat offline. Kredensial tidak tersedia.");case 28:throw t.t0;case 29:case"end":return t.stop()}}),t,this,[[1,13]])}))),function(t){return f.apply(this,arguments)})},{key:"_saveCredentialsOffline",value:(l=kt(_t().mark((function t(e,r){var n,o;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._db){t.next=3;break}return t.next=3,this._initDatabase();case 3:return t.prev=3,n=this._db.transaction(this._offlineAuthStoreName,"readwrite"),o=n.objectStore(this._offlineAuthStoreName),t.next=8,o.put({id:e,loginResult:r,timestamp:Date.now()});case 8:return t.next=10,n.done;case 10:return t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(3),t.abrupt("return",!1);case 17:case"end":return t.stop()}}),t,this,[[3,13]])}))),function(t,e){return l.apply(this,arguments)})},{key:"_tryOfflineLogin",value:(c=kt(_t().mark((function t(e,r){var n,o,i;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._db){t.next=3;break}return t.next=3,this._initDatabase();case 3:return t.prev=3,n=this._db.transaction(this._offlineAuthStoreName,"readonly"),o=n.objectStore(this._offlineAuthStoreName),t.next=8,o.get(e);case 8:return i=t.sent,t.next=11,n.done;case 11:return t.abrupt("return",(null==i?void 0:i.loginResult)||null);case 14:return t.prev=14,t.t0=t.catch(3),t.abrupt("return",null);case 18:case"end":return t.stop()}}),t,this,[[3,14]])}))),function(t,e){return c.apply(this,arguments)})},{key:"logout",value:(u=kt(_t().mark((function t(){var e,r;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,localStorage.removeItem(this._authStorageKey),localStorage.removeItem(this._userDataKey),this._clearSyncInterval(),!("serviceWorker"in navigator)){t.next=21;break}return t.prev=5,t.next=8,navigator.serviceWorker.getRegistration();case 8:if(null==(e=t.sent)||!e.pushManager){t.next=16;break}return t.next=12,e.pushManager.getSubscription();case 12:if(!(r=t.sent)){t.next=16;break}return t.next=16,r.unsubscribe();case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(5);case 21:window.dispatchEvent(new Event("user-logged-out")),t.next=27;break;case 24:t.prev=24,t.t1=t.catch(0);case 27:case"end":return t.stop()}}),t,this,[[0,24],[5,18]])}))),function(){return u.apply(this,arguments)})},{key:"syncOnlineStatus",value:(s=kt(_t().mark((function t(){return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(navigator.onLine&&this.isAuthenticated()){t.next=2;break}return t.abrupt("return",this.isAuthenticated());case 2:return t.prev=2,t.next=5,M.get(T.ENDPOINTS.USER_INFO);case 5:return t.abrupt("return",!0);case 8:return t.prev=8,t.t0=t.catch(2),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t,this,[[2,8]])}))),function(){return s.apply(this,arguments)})},{key:"isAuthenticated",value:function(){return!!this.getToken()}},{key:"getToken",value:function(){return localStorage.getItem(this._authStorageKey)}},{key:"getUserData",value:function(){var t=localStorage.getItem(this._userDataKey);return t?JSON.parse(t):null}},{key:"_saveAuthData",value:(a=kt(_t().mark((function t(e){var r,n,o;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.token,n=e.userId,o=e.name,localStorage.setItem(this._authStorageKey,r),localStorage.setItem(this._userDataKey,JSON.stringify({userId:n,name:o})),t.next=5,this._registerBackgroundSync();case 5:this._startSyncInterval(),window.dispatchEvent(new Event("user-logged-in"));case 7:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"_registerBackgroundSync",value:(i=kt(_t().mark((function t(){var e;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("serviceWorker"in navigator)||!("SyncManager"in window)){t.next=12;break}return t.prev=1,t.next=4,navigator.serviceWorker.ready;case 4:return e=t.sent,t.next=7,e.sync.register("sync-auth-data");case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1);case 12:case"end":return t.stop()}}),t,null,[[1,9]])}))),function(){return i.apply(this,arguments)})},{key:"_startSyncInterval",value:function(){var t=this;this._clearSyncInterval(),this._syncInterval=setInterval(kt(_t().mark((function e(){return _t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!navigator.onLine||!t.isAuthenticated()){e.next=5;break}return e.next=3,t.syncOnlineStatus();case 3:e.sent||t.logout();case 5:case"end":return e.stop()}}),e)}))),18e5)}},{key:"_clearSyncInterval",value:function(){this._syncInterval&&(clearInterval(this._syncInterval),this._syncInterval=null)}},{key:"_showNotification",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r={info:{icon:"info",color:"#2563EB"},success:{icon:"success",color:"#10B981"},warning:{icon:"warning",color:"#F59E0B"},error:{icon:"error",color:"#EF4444"}};g().fire({title:"Status Akun",text:t,icon:r[e].icon,confirmButtonColor:r[e].color,timer:3e3,timerProgressBar:!0,showConfirmButton:!1,toast:!0,position:"top-end"})}},{key:"setupPWAFeatures",value:(o=kt(_t().mark((function t(){var e=this;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isAuthenticated()&&this._startSyncInterval(),window.addEventListener("user-logged-in",(function(){e._startSyncInterval()})),window.addEventListener("user-logged-out",(function(){e._clearSyncInterval()})),t.abrupt("return",!0);case 4:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"clearOfflineData",value:(n=kt(_t().mark((function t(){var e,r;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._db){t.next=3;break}return t.next=3,this._initDatabase();case 3:return t.prev=3,e=this._db.transaction(this._offlineAuthStoreName,"readwrite"),r=e.objectStore(this._offlineAuthStoreName),t.next=8,r.clear();case 8:return t.next=10,e.done;case 10:return t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(3),t.abrupt("return",!1);case 17:case"end":return t.stop()}}),t,this,[[3,13]])}))),function(){return n.apply(this,arguments)})},{key:"destroy",value:function(){this._clearSyncInterval(),this._db&&(this._db.close(),this._db=null)}}],e&&Et(t.prototype,e),r&&Et(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s,u,c,l,f,h,p,d}());document.addEventListener("DOMContentLoaded",(function(){Ot.setupPWAFeatures().then((function(){})).catch((function(t){}))}));const Pt=Ot;function jt(t){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jt(t)}function Tt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Ft(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ft(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Lt(){Lt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==jt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(jt(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function It(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ct(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?It(Object(r),!0).forEach((function(e){Nt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):It(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Nt(t,e,r){return(e=Mt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function At(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Bt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){At(i,n,o,a,s,"next",t)}function s(t){At(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mt(n.key),n)}}function Mt(t){var e=function(t,e){if("object"!=jt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==jt(e)?e:e+""}const Dt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=null,r=[{key:"addToFavorites",value:(y=Bt(Lt().mark((function t(e){var r,n;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e&&e.id){t.next=3;break}throw new Error("Invalid story data: missing id");case 3:return r=Ct(Ct({},e),{},{savedAt:e.savedAt||(new Date).toISOString()}),t.next=6,tt.saveToFavorites(r);case 6:return t.abrupt("return",{success:!0,message:"Story added to favorites"});case 9:if(t.prev=9,t.t0=t.catch(0),null===(n=t.t0.message)||void 0===n||!n.includes("object stores was not found")){t.next=14;break}throw new Error("Database error: Please refresh the page and try again");case 14:throw new Error("Failed to add story to favorites");case 15:case"end":return t.stop()}}),t,null,[[0,9]])}))),function(t){return y.apply(this,arguments)})},{key:"removeFromFavorites",value:(v=Bt(Lt().mark((function t(e){var r;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new Error("Invalid story ID");case 3:return t.next=5,tt.removeFromFavorites(e);case 5:return t.abrupt("return",{success:!0,message:"Story removed from favorites"});case 8:if(t.prev=8,t.t0=t.catch(0),null===(r=t.t0.message)||void 0===r||!r.includes("object stores was not found")){t.next=13;break}throw new Error("Database error: Please refresh the page and try again");case 13:throw new Error("Failed to remove story from favorites");case 14:case"end":return t.stop()}}),t,null,[[0,8]])}))),function(t){return v.apply(this,arguments)})},{key:"getFavorites",value:(d=Bt(Lt().mark((function t(){var e,r;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,tt.getFavorites();case 3:return e=t.sent,t.abrupt("return",e||[]);case 8:if(t.prev=8,t.t0=t.catch(0),null===(r=t.t0.message)||void 0===r||!r.includes("object stores was not found")){t.next=13;break}return t.abrupt("return",[]);case 13:throw new Error("Failed to get favorites");case 14:case"end":return t.stop()}}),t,null,[[0,8]])}))),function(){return d.apply(this,arguments)})},{key:"getFavoriteById",value:(p=Bt(Lt().mark((function t(e){var r;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}return t.abrupt("return",null);case 3:return t.next=5,tt.getFavoriteById(e);case 5:return t.abrupt("return",t.sent);case 8:if(t.prev=8,t.t0=t.catch(0),null===(r=t.t0.message)||void 0===r||!r.includes("object stores was not found")){t.next=13;break}return t.abrupt("return",null);case 13:throw new Error("Failed to get favorite by id");case 14:case"end":return t.stop()}}),t,null,[[0,8]])}))),function(t){return p.apply(this,arguments)})},{key:"isFavorited",value:(h=Bt(Lt().mark((function t(e){var r;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}return t.abrupt("return",!1);case 3:return t.next=5,tt.isFavorited(e);case 5:return r=t.sent,t.abrupt("return",r);case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,null,[[0,10]])}))),function(t){return h.apply(this,arguments)})},{key:"getFavoritesCount",value:(f=Bt(Lt().mark((function t(){return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,tt.getFavoritesCount();case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",0);case 10:case"end":return t.stop()}}),t,null,[[0,6]])}))),function(){return f.apply(this,arguments)})},{key:"clearAllFavorites",value:(l=Bt(Lt().mark((function t(){var e;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,tt.clearFavorites();case 3:return t.abrupt("return",{success:!0,message:"All favorites cleared"});case 6:if(t.prev=6,t.t0=t.catch(0),null===(e=t.t0.message)||void 0===e||!e.includes("object stores was not found")){t.next=11;break}throw new Error("Database error: Please refresh the page and try again");case 11:throw new Error("Failed to clear favorites");case 12:case"end":return t.stop()}}),t,null,[[0,6]])}))),function(){return l.apply(this,arguments)})},{key:"exportFavorites",value:(c=Bt(Lt().mark((function t(){var e;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getFavorites();case 3:if(0!==t.sent.length){t.next=6;break}throw new Error("No favorites to export");case 6:return t.next=8,tt.exportFavorites();case 8:return t.abrupt("return",t.sent);case 11:if(t.prev=11,t.t0=t.catch(0),null===(e=t.t0.message)||void 0===e||!e.includes("object stores was not found")){t.next=16;break}throw new Error("Database error: Please refresh the page and try again");case 16:throw new Error("Failed to export favorites");case 17:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return c.apply(this,arguments)})},{key:"importFavorites",value:(u=Bt(Lt().mark((function t(e){var r,n,o;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,tt.importFavorites(e);case 3:return r=t.sent,t.abrupt("return",{success:!0,message:"Successfully imported ".concat(r," favorites"),count:r});case 7:if(t.prev=7,t.t0=t.catch(0),null===(n=t.t0.message)||void 0===n||!n.includes("object stores was not found")){t.next=12;break}throw new Error("Database error: Please refresh the page and try again");case 12:if(null===(o=t.t0.message)||void 0===o||!o.includes("Invalid export data")){t.next=14;break}throw new Error("Invalid file format: Please select a valid favorites export file");case 14:throw new Error("Failed to import favorites");case 15:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(t){return u.apply(this,arguments)})},{key:"toggleFavorite",value:(s=Bt(Lt().mark((function t(e){var r;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e&&e.id){t.next=3;break}throw new Error("Invalid story data");case 3:return t.next=5,this.isFavorited(e.id);case 5:if(!t.sent){t.next=13;break}return t.next=10,this.removeFromFavorites(e.id);case 10:return t.abrupt("return",{success:!0,action:"removed",message:"Story removed from favorites",isFavorited:!1});case 13:return t.next=15,this.addToFavorites(e);case 15:return t.abrupt("return",{success:!0,action:"added",message:"Story added to favorites",isFavorited:!0});case 16:t.next=24;break;case 18:if(t.prev=18,t.t0=t.catch(0),null===(r=t.t0.message)||void 0===r||!r.includes("object stores was not found")){t.next=23;break}throw new Error("Database error: Please refresh the page and try again");case 23:throw new Error("Failed to toggle favorite");case 24:case"end":return t.stop()}}),t,this,[[0,18]])}))),function(t){return s.apply(this,arguments)})},{key:"addMultipleToFavorites",value:(a=Bt(Lt().mark((function t(e){var r,n,o,i,a,s;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[],n=Tt(e),t.prev=2,n.s();case 4:if((o=n.n()).done){t.next=17;break}return i=o.value,t.prev=6,t.next=9,this.addToFavorites(i);case 9:r.push({id:i.id,success:!0}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(6),r.push({id:i.id,success:!1,error:t.t0.message});case 15:t.next=4;break;case 17:t.next=22;break;case 19:t.prev=19,t.t1=t.catch(2),n.e(t.t1);case 22:return t.prev=22,n.f(),t.finish(22);case 25:return a=r.filter((function(t){return t.success})).length,s=r.filter((function(t){return!t.success})).length,t.abrupt("return",{success:!0,message:"Added ".concat(a," stories to favorites").concat(s>0?", ".concat(s," failed"):""),results:r,successCount:a,failCount:s});case 28:case"end":return t.stop()}}),t,this,[[2,19,22,25],[6,12]])}))),function(t){return a.apply(this,arguments)})},{key:"removeMultipleFromFavorites",value:(i=Bt(Lt().mark((function t(e){var r,n,o,i,a,s;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[],n=Tt(e),t.prev=2,n.s();case 4:if((o=n.n()).done){t.next=17;break}return i=o.value,t.prev=6,t.next=9,this.removeFromFavorites(i);case 9:r.push({id:i,success:!0}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(6),r.push({id:i,success:!1,error:t.t0.message});case 15:t.next=4;break;case 17:t.next=22;break;case 19:t.prev=19,t.t1=t.catch(2),n.e(t.t1);case 22:return t.prev=22,n.f(),t.finish(22);case 25:return a=r.filter((function(t){return t.success})).length,s=r.filter((function(t){return!t.success})).length,t.abrupt("return",{success:!0,message:"Removed ".concat(a," stories from favorites").concat(s>0?", ".concat(s," failed"):""),results:r,successCount:a,failCount:s});case 28:case"end":return t.stop()}}),t,this,[[2,19,22,25],[6,12]])}))),function(t){return i.apply(this,arguments)})},{key:"getFavoritesPaginated",value:(o=Bt(Lt().mark((function t(){var e,r,n,o,i,a,s,u,c=arguments;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=c.length>0&&void 0!==c[0]?c[0]:1,r=c.length>1&&void 0!==c[1]?c[1]:10,t.prev=2,t.next=5,this.getFavorites();case 5:return n=t.sent,o=n.length,a=(i=(e-1)*r)+r,s=n.slice(i,a),t.abrupt("return",{favorites:s,pagination:{currentPage:e,totalPages:Math.ceil(o/r),totalCount:o,hasNextPage:a<o,hasPrevPage:e>1,limit:r}});case 13:if(t.prev=13,t.t0=t.catch(2),null===(u=t.t0.message)||void 0===u||!u.includes("object stores was not found")){t.next=18;break}return t.abrupt("return",{favorites:[],pagination:{currentPage:e,totalPages:0,totalCount:0,hasNextPage:!1,hasPrevPage:!1,limit:r}});case 18:throw new Error("Failed to get paginated favorites");case 19:case"end":return t.stop()}}),t,this,[[2,13]])}))),function(){return o.apply(this,arguments)})},{key:"debugFavorites",value:(n=Bt(Lt().mark((function t(){var e,r;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getFavorites();case 3:return e=t.sent,t.next=6,this.getFavoritesCount();case 6:return r=t.sent,t.abrupt("return",{favorites:e,count:r});case 12:return t.prev=12,t.t0=t.catch(0),t.abrupt("return",{favorites:[],count:0});case 16:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return n.apply(this,arguments)})}],e&&Gt(t.prototype,e),r&&Gt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s,u,c,l,f,h,p,d,v,y}();function Rt(t){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rt(t)}function Ht(){Ht=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Rt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Rt(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Ut(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function qt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ut(i,n,o,a,s,"next",t)}function s(t){Ut(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zt(n.key),n)}}function zt(t){var e=function(t,e){if("object"!=Rt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Rt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Rt(e)?e:e+""}function Wt(t,e,r){return e=Qt(e),function(t,e){if(e&&("object"==Rt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Kt()?Reflect.construct(e,r||[],Qt(t).constructor):e.apply(t,r))}function Vt(t){var e="function"==typeof Map?new Map:void 0;return Vt=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(Kt())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&Jt(o,r.prototype),o}(t,arguments,Qt(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Jt(r,t)},Vt(t)}function Kt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Kt=function(){return!!t})()}function Jt(t,e){return Jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Jt(t,e)}function Qt(t){return Qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qt(t)}var $t=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Wt(this,e))._isAuthenticated=Pt.isAuthenticated(),t._isSubscribed=!1,t._favoritesCount=0,t._handleAuthChange=t._handleAuthChange.bind(t),t._handleLogout=t._handleLogout.bind(t),t._handleMenuToggle=t._handleMenuToggle.bind(t),t._handleSubscribe=t._handleSubscribe.bind(t),t._handleUnsubscribe=t._handleUnsubscribe.bind(t),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jt(t,e)}(e,t),r=e,n=[{key:"connectedCallback",value:(c=qt(Ht().mark((function t(){return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.render(),window.addEventListener("user-logged-in",this._handleAuthChange),window.addEventListener("user-logged-out",this._handleAuthChange),window.addEventListener("favorites-updated",this._handleFavoritesUpdated.bind(this)),this._attachEventListeners(),!this._isAuthenticated){t.next=19;break}return t.prev=6,t.next=9,bt.init();case 9:return this._isSubscribed=t.sent,t.next=12,this._loadFavoritesCount();case 12:this.render(),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(6),this._isSubscribed=!1;case 19:case"end":return t.stop()}}),t,this,[[6,15]])}))),function(){return c.apply(this,arguments)})},{key:"disconnectedCallback",value:function(){window.removeEventListener("user-logged-in",this._handleAuthChange),window.removeEventListener("user-logged-out",this._handleAuthChange),window.removeEventListener("favorites-updated",this._handleFavoritesUpdated);var t=this.querySelector(".menu-toggle");t&&t.removeEventListener("click",this._handleMenuToggle);var e=this.querySelector("#logoutButton");e&&e.removeEventListener("click",this._handleLogout);var r=this.querySelector("#subscribeButton");r&&r.removeEventListener("click",this._handleSubscribe);var n=this.querySelector("#unsubscribeButton");n&&n.removeEventListener("click",this._handleUnsubscribe)}},{key:"_loadFavoritesCount",value:(u=qt(Ht().mark((function t(){return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Dt.getFavoritesCount();case 3:this._favoritesCount=t.sent,t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),this._favoritesCount=0;case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return u.apply(this,arguments)})},{key:"_handleFavoritesUpdated",value:function(){var t=this;this._loadFavoritesCount().then((function(){t._updateFavoritesCount()}))}},{key:"_updateFavoritesCount",value:function(){var t=this.querySelector(".favorites-count-badge");t&&(t.textContent=this._favoritesCount,t.style.display=this._favoritesCount>0?"inline-block":"none")}},{key:"render",value:function(){var t=Pt.getUserData()||{};this.innerHTML='\n      <nav class="app-nav">\n        <div class="app-nav__brand">\n          <a href="#/" class="app-nav__title">Dicoding Story</a>\n        </div>\n        \n        <button class="menu-toggle" aria-label="Toggle menu">\n          <i class="fas fa-bars"></i>\n        </button>\n        \n        <ul class="app-nav__list '.concat(this._isAuthenticated?"":"app-nav__list--guest",'">\n          <li class="app-nav__item">\n            <a href="#/" class="app-nav__link">\n              <i class="fas fa-home"></i>\n              <span>Home</span>\n            </a>\n          </li>\n          \n          ').concat(this._isAuthenticated?'\n                <li class="app-nav__item">\n                  <a href="#/add" class="app-nav__link">\n                    <i class="fas fa-plus-circle"></i>\n                    <span>Add Story</span>\n                  </a>\n                </li>\n                \n                <li class="app-nav__item">\n                  <a href="#/favorites" class="app-nav__link app-nav__link--favorites">\n                    <i class="fas fa-heart"></i>\n                    <span>Favorites</span>\n                    <span class="favorites-count-badge" style="display: '.concat(this._favoritesCount>0?"inline-block":"none",'">').concat(this._favoritesCount,"</span>\n                  </a>\n                </li>\n                \n                ").concat(this._renderNotificationButton(),'\n                \n                <li class="app-nav__item app-nav__item--user">\n                  <span class="app-nav__user">\n                    <i class="fas fa-user-circle"></i>\n                    <span>').concat(t.name||"User",'</span>\n                  </span>\n                  <button id="logoutButton" class="app-nav__button">\n                    <i class="fas fa-sign-out-alt"></i>\n                    <span>Logout</span>\n                  </button>\n                </li>\n              '):'\n                <li class="app-nav__item">\n                  <a href="#/login" class="app-nav__link">\n                    <i class="fas fa-sign-in-alt"></i>\n                    <span>Login</span>\n                  </a>\n                </li>\n                <li class="app-nav__item">\n                  <a href="#/register" class="app-nav__link app-nav__link--register">\n                    <i class="fas fa-user-plus"></i>\n                    <span>Register</span>\n                  </a>\n                </li>\n              ',"\n        </ul>\n      </nav>\n    "),this._attachEventListeners(),this._isAuthenticated&&this._updateFavoritesCount()}},{key:"_renderNotificationButton",value:function(){return this._isAuthenticated&&this._isPushSupported()?this._isSubscribed?'\n        <li class="app-nav__item">\n          <button id="unsubscribeButton" class="app-nav__button app-nav__button--notification app-nav__button--subscribed" title="Nonaktifkan notifikasi">\n            <i class="fas fa-bell"></i>\n            <span>Subscribed</span>\n          </button>\n        </li>\n      ':'\n        <li class="app-nav__item">\n          <button id="subscribeButton" class="app-nav__button app-nav__button--notification" title="Aktifkan notifikasi">\n            <i class="fas fa-bell-slash"></i>\n            <span>Subscribe</span>\n          </button>\n        </li>\n      ':""}},{key:"_isPushSupported",value:function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}},{key:"_attachEventListeners",value:function(){var t=this.querySelector("#logoutButton");t&&t.addEventListener("click",this._handleLogout);var e=this.querySelector(".menu-toggle");e&&e.addEventListener("click",this._handleMenuToggle);var r=this.querySelector("#subscribeButton");r&&r.addEventListener("click",this._handleSubscribe);var n=this.querySelector("#unsubscribeButton");n&&n.addEventListener("click",this._handleUnsubscribe)}},{key:"_handleAuthChange",value:(s=qt(Ht().mark((function t(){var e;return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this._isAuthenticated,this._isAuthenticated=Pt.isAuthenticated(),e||!this._isAuthenticated){t.next=19;break}return this.render(),t.prev=4,t.next=7,bt.init();case 7:return this._isSubscribed=t.sent,t.next=10,this._loadFavoritesCount();case 10:this.render(),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(4),this._isSubscribed=!1;case 17:t.next=21;break;case 19:e&&!this._isAuthenticated&&(this._isSubscribed=!1,this._favoritesCount=0),this.render();case 21:case"end":return t.stop()}}),t,this,[[4,13]])}))),function(){return s.apply(this,arguments)})},{key:"_handleLogout",value:function(t){t.preventDefault(),Pt.logout(),window.location.hash="#/"}},{key:"_handleMenuToggle",value:function(){this.querySelector(".app-nav__list").classList.toggle("app-nav__list--open")}},{key:"_handleSubscribe",value:(a=qt(Ht().mark((function t(e){var r,n;return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),r=e.target.closest("button"),n=r.innerHTML,r.innerHTML='\n      <i class="fas fa-spinner fa-spin"></i>\n      <span>Subscribing...</span>\n    ',r.disabled=!0,t.prev=5,t.next=8,bt.requestPermission();case 8:this._isSubscribed=bt.isSubscribed(),this.render(),t.next=17;break;case 12:t.prev=12,t.t0=t.catch(5),r.innerHTML=n,r.disabled=!1;case 17:case"end":return t.stop()}}),t,this,[[5,12]])}))),function(t){return a.apply(this,arguments)})},{key:"_handleUnsubscribe",value:(i=qt(Ht().mark((function t(e){var r,n;return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),r=e.target.closest("button"),n=r.innerHTML,r.innerHTML='\n      <i class="fas fa-spinner fa-spin"></i>\n      <span>Unsubscribing...</span>\n    ',r.disabled=!0,t.prev=5,t.next=8,bt.unsubscribe();case 8:t.sent?(this._isSubscribed=!1,this.render()):(r.innerHTML=n,r.disabled=!1),t.next=17;break;case 12:t.prev=12,t.t0=t.catch(5),r.innerHTML=n,r.disabled=!1;case 17:case"end":return t.stop()}}),t,this,[[5,12]])}))),function(t){return i.apply(this,arguments)})}],n&&Yt(r.prototype,n),o&&Yt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i,a,s,u,c}(Vt(HTMLElement));customElements.define("app-bar",$t);const Zt=function(t){var e=t.isLoading,r=void 0!==e&&e,n=t.error,o=void 0===n?null:n,i=t.stories,a=void 0===i?[]:i;if(r)return'\n      <section class="home">\n        <h2 class="home__title">Recent Stories</h2>\n        \n        <div class="loading-indicator">\n          <div class="loading-spinner"></div>\n          <p>Loading stories...</p>\n        </div>\n      </section>\n    ';if(o)return'\n      <section class="home">\n        <h2 class="home__title">Recent Stories</h2>\n        \n        <div class="error-container">\n          <i class="fas fa-exclamation-circle error-icon"></i>\n          <p class="error-message">'.concat(o,'</p>\n          <button class="button" id="retryButton">\n            <i class="fas fa-redo"></i> Try Again\n          </button>\n        </div>\n      </section>\n    ');var s=a.length>0?'<div class="stories-list" id="storiesList"></div>':'\n    <div class="stories-empty">\n      <i class="fas fa-book-open stories-empty__icon"></i>\n      <p>No stories available yet. Be the first to share your story!</p>\n      <a href="#/add" class="button">\n        <i class="fas fa-plus-circle"></i> Add New Story\n      </a>\n    </div>\n  ';return'\n    <section class="home">\n      <h2 class="home__title">Recent Stories</h2>\n      \n      '.concat(a.some((function(t){return t.lat&&t.lon}))?'\n    <div class="map-container">\n      <h3 class="map-title">\n        <i class="fas fa-map-marked-alt"></i>\n        Story Locations\n      </h3>\n      <div id="storyMap" class="story-map"></div>\n    </div>\n  ':"",'\n      \n      <div class="home__content">\n        ').concat(s,"\n      </div>\n    </section>\n  ")};function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function te(){te=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Xt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Xt(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function ee(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function re(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ee(i,n,o,a,s,"next",t)}function s(t){ee(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ne(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oe(n.key),n)}}function oe(t){var e=function(t,e){if("object"!=Xt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Xt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Xt(e)?e:e+""}function ie(t,e,r){return e=ce(e),function(t,e){if(e&&("object"==Xt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,se()?Reflect.construct(e,r||[],ce(t).constructor):e.apply(t,r))}function ae(t){var e="function"==typeof Map?new Map:void 0;return ae=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(se())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&ue(o,r.prototype),o}(t,arguments,ce(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),ue(r,t)},ae(t)}function se(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(se=function(){return!!t})()}function ue(t,e){return ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ue(t,e)}function ce(t){return ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ce(t)}var le=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ie(this,e))._story=null,t._isFavorited=!1,t._isLoading=!1,t._handleToggleFavorite=t._handleToggleFavorite.bind(t),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ue(t,e)}(e,t),r=e,n=[{key:"connectedCallback",value:(l=re(te().mark((function t(){return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._story){t.next=4;break}return t.next=3,this._checkFavoriteStatus();case 3:this.render();case 4:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"story",get:function(){return this._story},set:function(t){this._story=t,this._initializeStory()}},{key:"_initializeStory",value:(c=re(te().mark((function t(){return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isConnected||!this._story){t.next=4;break}return t.next=3,this._checkFavoriteStatus();case 3:this.render();case 4:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"_checkFavoriteStatus",value:(u=re(te().mark((function t(){return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._story||!this._story.id){t.next=12;break}return t.prev=1,t.next=4,Dt.isFavorited(this._story.id);case 4:this._isFavorited=t.sent,t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),this._isFavorited=!1;case 12:case"end":return t.stop()}}),t,this,[[1,8]])}))),function(){return u.apply(this,arguments)})},{key:"_handleToggleFavorite",value:(s=re(te().mark((function t(e){var r,n,o;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),e.stopPropagation(),this._story&&!this._isLoading){t.next=4;break}return t.abrupt("return");case 4:return this._isLoading=!0,t.prev=5,(r=this.querySelector(".story-item__favorite-btn"))&&(r.disabled=!0,r.innerHTML='<i class="fas fa-spinner fa-spin"></i> Loading...'),t.next=11,Dt.toggleFavorite(this._story);case 11:n=t.sent,this._isFavorited=n.isFavorited,this._updateFavoriteButton(),this._showToastMessage(n.message,"success"),this.dispatchEvent(new CustomEvent("favoriteToggled",{detail:{storyId:this._story.id,isFavorited:this._isFavorited,action:n.action},bubbles:!0})),t.next=26;break;case 19:return t.prev=19,t.t0=t.catch(5),this._showToastMessage(t.t0.message||"Failed to update favorite. Please try again.","error"),t.next=25,this._checkFavoriteStatus();case 25:this._updateFavoriteButton();case 26:return t.prev=26,this._isLoading=!1,(o=this.querySelector(".story-item__favorite-btn"))&&(o.disabled=!1,this._updateFavoriteButton()),t.finish(26);case 31:case"end":return t.stop()}}),t,this,[[5,19,26,31]])}))),function(t){return s.apply(this,arguments)})},{key:"_updateFavoriteButton",value:function(){var t=this.querySelector(".story-item__favorite-btn");if(t&&!this._isLoading){var e=this._isFavorited?"fas fa-heart":"far fa-heart",r=this._isFavorited?"Favorited":"Favorite",n=this._isFavorited?"story-item__favorite-btn favorited":"story-item__favorite-btn";t.className=n,t.innerHTML='<i class="'.concat(e,'"></i> ').concat(r),t.title=this._isFavorited?"Remove from favorites":"Add to favorites"}}},{key:"_showToastMessage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div");if(r.className="toast toast-".concat(e),r.innerHTML='\n      <div class="toast-content">\n        <i class="fas '.concat("success"===e?"fa-check-circle":"fa-exclamation-circle",'"></i>\n        <span>').concat(t,"</span>\n      </div>\n    "),!document.querySelector("#toast-styles")){var n=document.createElement("style");n.id="toast-styles",n.textContent="\n        .toast {\n          position: fixed;\n          top: 20px;\n          right: 20px;\n          padding: 12px 16px;\n          border-radius: 8px;\n          color: white;\n          font-weight: 500;\n          z-index: 10000;\n          animation: slideInRight 0.3s ease-out;\n          max-width: 300px;\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n        }\n        .toast-success {\n          background-color: #10b981;\n        }\n        .toast-error {\n          background-color: #ef4444;\n        }\n        .toast-content {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n        @keyframes slideInRight {\n          from {\n            transform: translateX(100%);\n            opacity: 0;\n          }\n          to {\n            transform: translateX(0);\n            opacity: 1;\n          }\n        }\n        @keyframes slideOutRight {\n          from {\n            transform: translateX(0);\n            opacity: 1;\n          }\n          to {\n            transform: translateX(100%);\n            opacity: 0;\n          }\n        }\n      ",document.head.appendChild(n)}document.body.appendChild(r),setTimeout((function(){r.style.animation="slideOutRight 0.3s ease-out",setTimeout((function(){r.parentNode&&r.parentNode.removeChild(r)}),300)}),3e3)}},{key:"_formatDate",value:function(t){var e=new Date(t);return new Intl.DateTimeFormat("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)}},{key:"_truncateText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;return!t||t.length<=e?t:t.substring(0,e)+"..."}},{key:"updateFavoriteStatus",value:(a=re(te().mark((function t(e){return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._isFavorited=e,this._updateFavoriteButton();case 2:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"refreshFavoriteStatus",value:(i=re(te().mark((function t(){return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._checkFavoriteStatus();case 2:this._updateFavoriteButton();case 3:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"render",value:function(){if(this._story){var t=this._story,e=t.id,r=t.name,n=t.description,o=t.photoUrl,i=t.createdAt,a=t.lat,s=t.lon,u=a&&s&&!isNaN(parseFloat(a))&&!isNaN(parseFloat(s)),c=this._isFavorited?"story-item__favorite-btn favorited":"story-item__favorite-btn",l=this._isFavorited?"fas fa-heart":"far fa-heart",f=this._isFavorited?"Favorited":"Favorite";this.innerHTML='\n      <article class="story-item">\n        <div class="story-item__image-container">\n          <img \n            src="'.concat(o,'" \n            alt="Story by ').concat(r,'"\n            class="story-item__image"\n            loading="lazy"\n            onerror="this.src=\'/images/placeholder.jpg\'"\n          />\n          <button class="').concat(c,'" \n                  title="').concat(this._isFavorited?"Remove from favorites":"Add to favorites",'"\n                  ').concat(this._isLoading?"disabled":"",'>\n            <i class="').concat(l,'"></i> ').concat(f,'\n          </button>\n        </div>\n        \n        <div class="story-item__content">\n          <div class="story-item__meta">\n            <span class="story-item__author">\n              <i class="fas fa-user"></i>\n              ').concat(r,'\n            </span>\n            <span class="story-item__date">\n              <i class="fas fa-calendar-alt"></i>\n              ').concat(this._formatDate(i),"\n            </span>\n            ").concat(u?'\n              <span class="story-item__location">\n                <i class="fas fa-map-marker-alt"></i>\n                Location Available\n              </span>':"",'\n          </div>\n          \n          <h3 class="story-item__title">\n            <a href="#/detail/').concat(e,'" class="story-item__link">\n              Story by ').concat(r,'\n            </a>\n          </h3>\n          \n          <p class="story-item__description">\n            ').concat(this._truncateText(n),'\n          </p>\n          \n          <div class="story-item__actions">\n            <a href="#/detail/').concat(e,'" class="story-item__button">\n              Read More\n              <i class="fas fa-arrow-right"></i>\n            </a>\n          </div>\n        </div>\n      </article>\n      \n      <style>\n        .story-item {\n          position: relative;\n          border-radius: 12px;\n          overflow: hidden;\n          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n          transition: transform 0.2s ease, box-shadow 0.2s ease;\n        }\n        \n        .story-item:hover {\n          transform: translateY(-2px);\n          box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);\n        }\n        \n        .story-item__image-container {\n          position: relative;\n          width: 100%;\n          height: 200px;\n          overflow: hidden;\n        }\n        \n        .story-item__image {\n          width: 100%;\n          height: 100%;\n          object-fit: cover;\n        }\n        \n        .story-item__favorite-btn {\n          position: absolute;\n          top: 12px;\n          right: 12px;\n          background-color: rgba(0, 0, 0, 0.7);\n          color: white;\n          border: none;\n          border-radius: 20px;\n          padding: 8px 12px;\n          font-size: 0.875rem;\n          cursor: pointer;\n          transition: all 0.3s ease;\n          backdrop-filter: blur(4px);\n          display: flex;\n          align-items: center;\n          gap: 4px;\n          font-weight: 500;\n        }\n        \n        .story-item__favorite-btn:hover {\n          background-color: rgba(239, 68, 68, 0.9);\n          transform: scale(1.05);\n        }\n        \n        .story-item__favorite-btn.favorited {\n          background-color: rgba(239, 68, 68, 0.9);\n        }\n        \n        .story-item__favorite-btn.favorited:hover {\n          background-color: rgba(220, 38, 38, 0.9);\n        }\n        \n        .story-item__favorite-btn:disabled {\n          opacity: 0.6;\n          cursor: not-allowed;\n          transform: none;\n        }\n        \n        .story-item__content {\n          padding: 16px;\n        }\n        \n        .story-item__meta {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 12px;\n          margin-bottom: 8px;\n          font-size: 0.875rem;\n          color: #6b7280;\n        }\n        \n        .story-item__meta span {\n          display: flex;\n          align-items: center;\n          gap: 4px;\n        }\n        \n        .story-item__title {\n          margin: 8px 0;\n          font-size: 1.125rem;\n          font-weight: 600;\n        }\n        \n        .story-item__link {\n          text-decoration: none;\n          color: #1f2937;\n          transition: color 0.2s ease;\n        }\n        \n        .story-item__link:hover {\n          color: #3b82f6;\n        }\n        \n        .story-item__description {\n          color: #6b7280;\n          line-height: 1.5;\n          margin-bottom: 16px;\n        }\n        \n        .story-item__actions {\n          display: flex;\n          justify-content: flex-end;\n        }\n        \n        .story-item__button {\n          display: inline-flex;\n          align-items: center;\n          gap: 6px;\n          padding: 8px 16px;\n          background-color: #3b82f6;\n          color: white;\n          text-decoration: none;\n          border-radius: 6px;\n          font-size: 0.875rem;\n          font-weight: 500;\n          transition: background-color 0.2s ease;\n        }\n        \n        .story-item__button:hover {\n          background-color: #2563eb;\n        }\n        \n        .story-item__error {\n          padding: 20px;\n          text-align: center;\n          color: #ef4444;\n          font-style: italic;\n        }\n      </style>\n    ');var h=this.querySelector(".story-item__favorite-btn");h&&h.addEventListener("click",this._handleToggleFavorite)}else this.innerHTML='<div class="story-item__error">No story data available</div>'}},{key:"disconnectedCallback",value:function(){var t=this.querySelector(".story-item__favorite-btn");t&&t.removeEventListener("click",this._handleToggleFavorite)}}],n&&ne(r.prototype,n),o&&ne(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i,a,s,u,c,l}(ae(HTMLElement));customElements.define("story-item",le);var fe=r(481),he=r.n(fe),pe=r(272),de=r(927),ve=r(980);function ye(t){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(t)}function me(){me=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==ye(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ye(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function ge(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function be(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function we(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?be(Object(r),!0).forEach((function(e){_e(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function _e(t,e,r){return(e=ke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ke(n.key),n)}}function ke(t){var e=function(t,e){if("object"!=ye(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ye(e)?e:e+""}delete he().Icon.Default.prototype._getIconUrl,he().Icon.Default.mergeOptions({iconRetinaUrl:pe,iconUrl:de,shadowUrl:ve});var Ee=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._map=null,this._markers=[],this._selectedLocation=null,this._mapOptions={center:T.MAP.DEFAULT_CENTER,zoom:T.MAP.DEFAULT_ZOOM},this._baseLayers={}},e=[{key:"initMap",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)throw new Error("Container element is required");var r=we(we({},this._mapOptions),e);return this._map=he().map(t,{center:r.center,zoom:r.zoom,scrollWheelZoom:!0,zoomControl:!0}),this._addDefaultTileLayer(),(e.addSecondaryTileLayer||r.addSecondaryTileLayer)&&this._addSecondaryTileLayer(T.MAP.SECONDARY_TILE_LAYER),Object.keys(this._baseLayers).length>1&&he().control.layers(this._baseLayers).addTo(this._map),this._map}},{key:"addStoryMarkers",value:function(t){var e=this;if(!this._map)throw new Error("Map not initialized. Call initMap first.");this.clearMarkers();var r=t.filter((function(t){return t.lat&&t.lon&&!isNaN(t.lat)&&!isNaN(t.lon)}));if(0!==r.length)if(r.forEach((function(t){var r=he().marker([t.lat,t.lon]);r.bindPopup(e._createPopupContent(t)),r.addTo(e._map),e._markers.push(r)})),this._markers.length>1){var n=he().featureGroup(this._markers);this._map.fitBounds(n.getBounds().pad(.1))}else 1===this._markers.length&&this._map.setView([r[0].lat,r[0].lon],15)}},{key:"setupLocationSelector",value:function(t){var e=this;if(!this._map)throw new Error("Map not initialized. Call initMap first.");this.clearMarkers(),this._map.on("click",(function(r){var n=r.latlng,o=n.lat,i=n.lng;e.clearMarkers();var a=he().marker([o,i]).addTo(e._map);e._markers.push(a),e._selectedLocation={lat:o,lon:i},"function"==typeof t&&t(e._selectedLocation)}))}},{key:"getUserLocation",value:(n=me().mark((function t(){var e=this;return me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(r){var n={lat:r.coords.latitude,lon:r.coords.longitude};if(e._map){e._map.setView([n.lat,n.lon],15),e.clearMarkers();var o=he().marker([n.lat,n.lon]).addTo(e._map).bindPopup("Your location").openPopup();e._markers.push(o),e._selectedLocation=n}t(n)}),(function(t){r(new Error("Could not get your location: ".concat(t.message)))})):r(new Error("Geolocation is not supported by your browser"))})));case 1:case"end":return t.stop()}}),t)})),o=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){ge(i,r,o,a,s,"next",t)}function s(t){ge(i,r,o,a,s,"throw",t)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"getSelectedLocation",value:function(){return this._selectedLocation}},{key:"clearMarkers",value:function(){var t=this;this._map&&(this._markers.forEach((function(e){return t._map.removeLayer(e)})),this._markers=[])}},{key:"_addDefaultTileLayer",value:function(){var t=he().tileLayer(T.MAP.TILE_LAYER,{attribution:T.MAP.ATTRIBUTION,maxZoom:19}).addTo(this._map);this._baseLayers.OpenStreetMap=t}},{key:"_addSecondaryTileLayer",value:function(t){if(t&&t.url){var e=he().tileLayer(t.url,{attribution:t.attribution||"",maxZoom:t.maxZoom||19,subdomains:t.subdomains||[]});this._baseLayers[t.name||"Satellite"]=e}}},{key:"_createPopupContent",value:function(t){var e=document.createElement("div");e.className="map-popup";var r=document.createElement("img");r.src=t.photoUrl,r.alt="Photo by ".concat(t.name),r.className="map-popup__thumbnail",r.onerror=function(){this.src="/images/placeholder-image.jpg",this.alt="Image not available"},e.appendChild(r);var n=document.createElement("div");n.className="map-popup__info";var o=document.createElement("h4");o.textContent=t.name,n.appendChild(o);var i=document.createElement("p");i.textContent=this._truncateText(t.description,100),n.appendChild(i);var a=document.createElement("a");return a.href="#/detail/".concat(t.id),a.textContent="View details",a.className="map-popup__link",n.appendChild(a),e.appendChild(n),e}},{key:"_truncateText",value:function(t,e){return!t||t.length<=e?t:t.substring(0,e)+"..."}}],e&&xe(t.prototype,e),r&&xe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();const Se=Ee;function Oe(t){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oe(t)}function Pe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,je(n.key),n)}}function je(t){var e=function(t,e){if("object"!=Oe(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Oe(e)?e:e+""}const Te=function(){return t=function t(e){var r=e.stories,n=void 0===r?[]:r,o=e.isLoading,i=void 0!==o&&o,a=e.error,s=void 0===a?null:a,u=e.container;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._stories=n,this._isLoading=i,this._error=s,this._container=u,this._mapHelper=new Se,this._mapInitialized=!1,this._retryHandler=null},(e=[{key:"render",value:function(){this._container.innerHTML=Zt({isLoading:this._isLoading,error:this._error,stories:this._stories}),!this._isLoading&&!this._error&&this._stories.length>0&&(this._renderStories(),this._initMap()),this._error&&this._attachRetryHandler()}},{key:"_renderStories",value:function(){var t=document.getElementById("storiesList");t&&(t.innerHTML="",this._stories.forEach((function(e){var r=document.createElement("story-item");r.story=e,t.appendChild(r)})))}},{key:"_initMap",value:function(){if(0!==this._stories.filter((function(t){return t.lat&&t.lon&&!isNaN(t.lat)&&!isNaN(t.lon)})).length){var t=document.getElementById("storyMap");t&&(this._mapHelper.initMap(t,{addSecondaryTileLayer:!0}),this._mapHelper.addStoryMarkers(this._stories),this._mapInitialized=!0)}}},{key:"_attachRetryHandler",value:function(){var t=document.getElementById("retryButton");t&&this._retryHandler&&t.addEventListener("click",this._retryHandler)}},{key:"setRetryHandler",value:function(t){this._retryHandler=t,this._error&&this._attachRetryHandler()}},{key:"cleanup",value:function(){this._mapInitialized&&this._mapHelper&&this._mapHelper.clearMarkers()}}])&&Pe(t.prototype,e),r&&Pe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Fe(t){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fe(t)}function Le(){Le=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Fe(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Fe(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Ie(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ce(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ie(i,n,o,a,s,"next",t)}function s(t){Ie(i,n,o,a,s,"throw",t)}a(void 0)}))}}var Ne=function(){var t=Ce(Le().mark((function t(e){var r;return Le().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(document.startViewTransition){t.next=4;break}return t.next=3,e();case 3:return t.abrupt("return");case 4:return r=document.startViewTransition(Ce(Le().mark((function t(){return Le().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:case"end":return t.stop()}}),t)})))),t.abrupt("return",r.finished);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ae=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.name,n=void 0===r?"fade":r,o=e.duration,i=void 0===o?300:o,a=e.easing,s=void 0===a?"ease":a,u=document.querySelector(t);if(u){u.style.viewTransitionName=n;var c=document.createElement("style");c.textContent="\n      @keyframes ".concat(n,"-in {\n        from { opacity: 0; transform: translateY(20px); }\n        to { opacity: 1; transform: translateY(0); }\n      }\n  \n      @keyframes ").concat(n,"-out {\n        from { opacity: 1; transform: translateY(0); }\n        to { opacity: 0; transform: translateY(-20px); }\n      }\n  \n      ::view-transition-old(").concat(n,") {\n        animation: ").concat(i,"ms ").concat(s," both ").concat(n,"-out;\n      }\n  \n      ::view-transition-new(").concat(n,") {\n        animation: ").concat(i,"ms ").concat(s," both ").concat(n,"-in;\n      }\n    "),document.head.appendChild(c),setTimeout((function(){document.head.removeChild(c)}),i+100)}};function Be(t){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Be(t)}function Ge(){Ge=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Be(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Be(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Me(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function De(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Me(i,n,o,a,s,"next",t)}function s(t){Me(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,He(n.key),n)}}function He(t){var e=function(t,e){if("object"!=Be(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Be(e)?e:e+""}var Ue=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._params=e,this._view=null,this._container=document.querySelector("#pageContent"),this._isLoading=!1,this._error=null,this._stories=[],this._fetchStories=this._fetchStories.bind(this),this._handleRetry=this._handleRetry.bind(this)},e=[{key:"init",value:function(){var t=De(Ge().mark((function t(){return Ge().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._renderLoading(),Ae("#pageContent",{name:"home-transition",duration:400}),t.next=4,this._fetchStories();case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_fetchStories",value:(n=De(Ge().mark((function t(){var e;return Ge().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this._isLoading=!0,this._error=null,this._renderLoading(),Pt.isAuthenticated()){t.next=11;break}return this._stories=[],this._isLoading=!1,this._renderView(),g().fire({title:"Welcome to Dicoding Story!",text:"Log in to see and share stories from the Dicoding community.",icon:"info",confirmButtonColor:"#2563EB",confirmButtonText:"Log In",showCancelButton:!0,cancelButtonText:"Maybe Later"}).then((function(t){t.isConfirmed&&(window.location.hash="#/login")})),t.abrupt("return");case 11:return t.next=13,ft.getStories({location:1});case 13:e=t.sent,this._stories=e.listStory||[],this._isLoading=!1,this._renderView(),t.next=25;break;case 19:t.prev=19,t.t0=t.catch(0),this._isLoading=!1,this._error=t.t0.message||"Failed to load stories. Please try again.",this._renderError();case 25:case"end":return t.stop()}}),t,this,[[0,19]])}))),function(){return n.apply(this,arguments)})},{key:"_renderLoading",value:function(){this._view=new Te({isLoading:!0,stories:[],error:null,container:this._container}),this._view.render()}},{key:"_renderError",value:function(){this._view=new Te({isLoading:!1,stories:[],error:this._error,container:this._container}),this._view.render(),this._view.setRetryHandler(this._handleRetry)}},{key:"_renderView",value:function(){this._view=new Te({isLoading:this._isLoading,stories:this._stories,error:this._error,container:this._container}),this._view.render(),this._error&&this._view.setRetryHandler(this._handleRetry)}},{key:"_handleRetry",value:function(){this._fetchStories()}},{key:"cleanup",value:function(){this._view&&this._view.cleanup()}}],e&&Re(t.prototype,e),r&&Re(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const qe=Ue;const Ye=function(t){var e=t.isLoading,r=void 0!==e&&e,n=t.error,o=void 0===n?null:n,i=t.story,a=void 0===i?null:i,s=t.isFavorited,u=void 0!==s&&s;if(r)return'\n        <section class="detail">\n          <div class="detail__header">\n            <h2 class="detail__title">Story Details</h2>\n            <a href="#/" class="button secondary">\n              <i class="fas fa-arrow-left"></i> Back to Home\n            </a>\n          </div>\n          \n          <div class="loading-indicator">\n            <div class="loading-spinner"></div>\n            <p>Loading story details...</p>\n          </div>\n        </section>\n      ';if(o)return'\n        <section class="detail">\n          <div class="detail__header">\n            <h2 class="detail__title">Story Details</h2>\n            <a href="#/" class="button secondary">\n              <i class="fas fa-arrow-left"></i> Back to Home\n            </a>\n          </div>\n          \n          <div class="error-container">\n            <i class="fas fa-exclamation-circle error-icon"></i>\n            <p class="error-message">'.concat(o,'</p>\n            <button class="button" id="retryButton">\n              <i class="fas fa-redo"></i> Try Again\n            </button>\n          </div>\n        </section>\n      ');if(!a)return'\n        <section class="detail">\n          <div class="detail__header">\n            <h2 class="detail__title">Story Details</h2>\n            <a href="#/" class="button secondary">\n              <i class="fas fa-arrow-left"></i> Back to Home\n            </a>\n          </div>\n          \n          <div class="error-container">\n            <i class="fas fa-search error-icon"></i>\n            <p class="error-message">Story not found</p>\n            <a href="#/" class="button">\n              <i class="fas fa-home"></i> Back to Home\n            </a>\n          </div>\n        </section>\n      ';var c,l,f=a.lat&&a.lon?'\n        <div class="story-detail__map-container">\n          <h4 class="story-detail__map-title">\n            <i class="fas fa-map-marker-alt"></i> Story Location\n          </h4>\n          <div id="detailMap" class="story-detail__map"></div>\n        </div>\n      ':"",h=u?"fas fa-heart":"far fa-heart",p=u?"Remove from Favorites":"Add to Favorites";return'\n      <section class="detail">\n        <div class="detail__header">\n          <h2 class="detail__title">Story Details</h2>\n          <div class="detail__actions">\n            <button id="favoriteButton" class="'.concat(u?"button favorite-button favorited":"button favorite-button",'" title="').concat(p,'">\n              <i class="').concat(h,'"></i> ').concat(u?"Favorited":"Add to Favorites",'\n            </button>\n            <a href="#/" class="button secondary">\n              <i class="fas fa-arrow-left"></i> Back to Home\n            </a>\n          </div>\n        </div>\n        \n        <article class="story-detail">\n          <div class="story-detail__image-container">\n            <img \n              src="').concat(a.photoUrl,'" \n              alt="Story by ').concat(a.name,'"\n              class="story-detail__image"\n            />\n          </div>\n          \n          <div class="story-detail__content">\n            <div class="story-detail__meta">\n              <div class="story-detail__author">\n                <i class="fas fa-user"></i>\n                <span>').concat(a.name,'</span>\n              </div>\n              <div class="story-detail__date">\n                <i class="fas fa-calendar-alt"></i>\n                <span>').concat((c=a.createdAt,l=new Date(c),new Intl.DateTimeFormat("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(l)),'</span>\n              </div>\n            </div>\n            \n            <h3 class="story-detail__title">Story by ').concat(a.name,'</h3>\n            \n            <div class="story-detail__description">\n              ').concat(a.description,"\n            </div>\n            \n            ").concat(f,"\n          </div>\n        </article>\n      </section>\n      \n      <style>\n        .detail__header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 2rem;\n          flex-wrap: wrap;\n          gap: 1rem;\n        }\n        \n        .detail__actions {\n          display: flex;\n          gap: 1rem;\n          align-items: center;\n        }\n        \n        .favorite-button {\n          background-color: #6b7280;\n          color: white;\n          border: 2px solid #6b7280;\n          transition: all 0.3s ease;\n        }\n        \n        .favorite-button:hover {\n          background-color: #ef4444;\n          border-color: #ef4444;\n        }\n        \n        .favorite-button.favorited {\n          background-color: #ef4444;\n          border-color: #ef4444;\n        }\n        \n        .favorite-button.favorited:hover {\n          background-color: #dc2626;\n          border-color: #dc2626;\n        }\n        \n        @media (max-width: 768px) {\n          .detail__header {\n            flex-direction: column;\n            align-items: stretch;\n          }\n          \n          .detail__actions {\n            justify-content: center;\n          }\n        }\n      </style>\n    ")};function ze(t){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ze(t)}function We(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ve(n.key),n)}}function Ve(t){var e=function(t,e){if("object"!=ze(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ze(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ze(e)?e:e+""}const Ke=function(){return t=function t(e){var r=e.isLoading,n=void 0!==r&&r,o=e.story,i=void 0===o?null:o,a=e.error,s=void 0===a?null:a,u=e.isFavorited,c=void 0!==u&&u,l=e.container;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._isLoading=n,this._story=i,this._error=s,this._isFavorited=c,this._container=l,this._retryHandler=null,this._favoriteHandler=null},(e=[{key:"render",value:function(){this._container&&(this._container.innerHTML=Ye({isLoading:this._isLoading,story:this._story,error:this._error,isFavorited:this._isFavorited}),this._bindEvents(),this._initializeMap())}},{key:"_bindEvents",value:function(){var t=document.querySelector("#retryButton");t&&this._retryHandler&&t.addEventListener("click",this._retryHandler);var e=document.querySelector("#favoriteButton");e&&this._favoriteHandler&&e.addEventListener("click",this._favoriteHandler)}},{key:"_initializeMap",value:function(){if(this._story&&this._story.lat&&this._story.lon&&!this._isLoading&&!this._error){var t=document.querySelector("#detailMap");if(t)try{var e=parseFloat(this._story.lat),r=parseFloat(this._story.lon);if(isNaN(e)||isNaN(r))return void(t.innerHTML='\n          <div class="map-placeholder">\n            <p><i class="fas fa-map-marker-alt"></i> Location coordinates are invalid</p>\n          </div>\n        ');t.innerHTML='\n        <div class="map-placeholder">\n          <div class="map-info">\n            <h4><i class="fas fa-map-marker-alt"></i> Story Location</h4>\n            <p><strong>Latitude:</strong> '.concat(e,"</p>\n            <p><strong>Longitude:</strong> ").concat(r,'</p>\n            <a \n              href="https://www.google.com/maps?q=').concat(e,",").concat(r,'" \n              target="_blank" \n              rel="noopener noreferrer"\n              class="button secondary"\n            >\n              <i class="fas fa-external-link-alt"></i> View on Google Maps\n            </a>\n          </div>\n        </div>\n        \n        <style>\n          .map-placeholder {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            border-radius: 12px;\n            padding: 2rem;\n            text-align: center;\n            color: white;\n            min-height: 200px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n          }\n          \n          .map-info h4 {\n            margin-bottom: 1rem;\n            font-size: 1.25rem;\n          }\n          \n          .map-info p {\n            margin: 0.5rem 0;\n            opacity: 0.9;\n          }\n          \n          .map-info .button {\n            margin-top: 1rem;\n          }\n        </style>\n      ')}catch(e){t.innerHTML='\n        <div class="map-placeholder">\n          <p><i class="fas fa-exclamation-triangle"></i> Unable to load map</p>\n        </div>\n      '}}}},{key:"setRetryHandler",value:function(t){this._retryHandler=t}},{key:"setFavoriteHandler",value:function(t){this._favoriteHandler=t}},{key:"cleanup",value:function(){this._retryHandler=null,this._favoriteHandler=null}}])&&We(t.prototype,e),r&&We(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Je(t){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Je(t)}function Qe(){Qe=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Je(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Je(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function $e(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ze(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){$e(i,n,o,a,s,"next",t)}function s(t){$e(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tr(n.key),n)}}function tr(t){var e=function(t,e){if("object"!=Je(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Je(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Je(e)?e:e+""}var er=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._params=e,this._storyId=e.id,this._view=null,this._container=document.querySelector("#pageContent"),this._isLoading=!1,this._error=null,this._story=null,this._isFavorited=!1,this._fetchStory=this._fetchStory.bind(this),this._handleRetry=this._handleRetry.bind(this),this._handleToggleFavorite=this._handleToggleFavorite.bind(this)},e=[{key:"init",value:function(){var t=Ze(Qe().mark((function t(){return Qe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._storyId){t.next=4;break}return this._error="Story ID is required",this._renderError(),t.abrupt("return");case 4:return this._renderLoading(),Ae("#pageContent",{name:"detail-transition",duration:400}),t.next=8,this._fetchStory();case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_fetchStory",value:(o=Ze(Qe().mark((function t(){var e;return Qe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._isLoading=!0,this._error=null,this._renderLoading(),t.next=6,ft.getStoryById(this._storyId);case 6:return e=t.sent,this._story=e.story,t.next=10,Dt.isFavorited(this._storyId);case 10:this._isFavorited=t.sent,this._isLoading=!1,this._renderView(),t.next=21;break;case 15:t.prev=15,t.t0=t.catch(0),this._isLoading=!1,this._error=t.t0.message||"Failed to load story details. Please try again.",this._renderError();case 21:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(){return o.apply(this,arguments)})},{key:"_handleToggleFavorite",value:(n=Ze(Qe().mark((function t(){var e;return Qe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._story){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,Dt.toggleFavorite(this._story);case 5:e=t.sent,this._isFavorited="added"===e.action,this._renderView(),this._showToastMessage(e.message,"success"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),this._showToastMessage("Failed to update favorite. Please try again.","error");case 15:case"end":return t.stop()}}),t,this,[[2,11]])}))),function(){return n.apply(this,arguments)})},{key:"_showToastMessage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div");if(r.className="toast toast-".concat(e),r.innerHTML='\n      <div class="toast-content">\n        <i class="fas '.concat("success"===e?"fa-check-circle":"fa-exclamation-circle",'"></i>\n        <span>').concat(t,"</span>\n      </div>\n    "),!document.querySelector("#toast-styles")){var n=document.createElement("style");n.id="toast-styles",n.textContent="\n        .toast {\n          position: fixed;\n          top: 20px;\n          right: 20px;\n          padding: 12px 16px;\n          border-radius: 8px;\n          color: white;\n          font-weight: 500;\n          z-index: 10000;\n          animation: slideInRight 0.3s ease-out;\n        }\n        .toast-success {\n          background-color: #10b981;\n        }\n        .toast-error {\n          background-color: #ef4444;\n        }\n        .toast-content {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n        @keyframes slideInRight {\n          from {\n            transform: translateX(100%);\n            opacity: 0;\n          }\n          to {\n            transform: translateX(0);\n            opacity: 1;\n          }\n        }\n      ",document.head.appendChild(n)}document.body.appendChild(r),setTimeout((function(){r.style.animation="slideInRight 0.3s ease-out reverse",setTimeout((function(){r.parentNode&&r.parentNode.removeChild(r)}),300)}),3e3)}},{key:"_renderLoading",value:function(){this._view=new Ke({isLoading:!0,story:null,error:null,isFavorited:!1,container:this._container}),this._view.render()}},{key:"_renderError",value:function(){this._view=new Ke({isLoading:!1,story:null,error:this._error,isFavorited:!1,container:this._container}),this._view.render(),this._view.setRetryHandler(this._handleRetry)}},{key:"_renderView",value:function(){this._view=new Ke({isLoading:!1,story:this._story,error:null,isFavorited:this._isFavorited,container:this._container}),this._view.render(),this._view.setFavoriteHandler(this._handleToggleFavorite)}},{key:"_handleRetry",value:function(){this._fetchStory()}},{key:"cleanup",value:function(){this._view&&this._view.cleanup()}}],e&&Xe(t.prototype,e),r&&Xe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();const rr=er;const nr=function(t){var e=t.isLoading,r=void 0!==e&&e,n=r?'<i class="fas fa-spinner fa-spin"></i> Posting...':'<i class="fas fa-paper-plane"></i> Post Story';return'\n      <section class="add-story">\n        <div class="add-story__header">\n          <h2 class="add-story__title">Add New Story</h2>\n          <a href="#/" class="button secondary">\n            <i class="fas fa-arrow-left"></i> Back to Home\n          </a>\n        </div>\n        \n        <form id="addStoryForm" class="add-story-form">\n          <div class="form-group">\n            <label for="description" class="form-label">Description</label>\n            <textarea \n              id="description" \n              name="description" \n              class="form-textarea" \n              placeholder="Share your story..." \n              required\n              '.concat(r?"disabled":"",'\n            ></textarea>\n          </div>\n          \n          <div class="form-group">\n            <label class="form-label">Photo</label>\n            <div class="photo-capture">\n              <div class="photo-capture__preview-container">\n                <video id="cameraPreview" class="photo-capture__camera" autoplay playsinline></video>\n                <canvas id="photoCanvas" class="photo-capture__canvas"></canvas>\n                <div id="photoPreview" class="photo-capture__preview"></div>\n              </div>\n              \n              <div class="photo-capture__actions">\n                <button \n                  type="button" \n                  id="startCameraButton" \n                  class="button photo-capture__button"\n                  ').concat(r?"disabled":"",'\n                >\n                  <i class="fas fa-camera"></i> Open Camera\n                </button>\n                \n                <button \n                  type="button" \n                  id="takePictureButton" \n                  class="button photo-capture__button" \n                  disabled\n                >\n                  <i class="fas fa-camera-retro"></i> Take Photo\n                </button>\n                \n                <button \n                  type="button" \n                  id="switchCameraButton" \n                  class="button photo-capture__button" \n                  disabled\n                >\n                  <i class="fas fa-sync"></i> Switch Camera\n                </button>\n                \n                <button \n                  type="button" \n                  id="resetPhotoButton" \n                  class="button photo-capture__button" \n                  disabled\n                >\n                  <i class="fas fa-trash"></i> Reset\n                </button>\n              </div>\n              \n              <div class="photo-capture__file-input">\n                <label for="photoInput" class="form-label">Or upload a photo:</label>\n                <input \n                  type="file" \n                  id="photoInput" \n                  name="photo" \n                  accept="image/*" \n                  class="form-input"\n                  ').concat(r?"disabled":"",'\n                />\n              </div>\n            </div>\n          </div>\n          \n          <div class="form-group">\n            <label class="form-label">Location (Optional)</label>\n            <div class="location-picker">\n              <div id="locationMap" class="location-picker__map"></div>\n              \n              <div class="location-picker__actions">\n                <button \n                  type="button" \n                  id="getUserLocationButton" \n                  class="button location-picker__button"\n                  ').concat(r?"disabled":"",'\n                >\n                  <i class="fas fa-map-marker-alt"></i> Use My Location\n                </button>\n                \n                <p class="location-picker__hint">\n                  <i class="fas fa-info-circle"></i> \n                  Or click on the map to select a location\n                </p>\n                \n                <div id="selectedLocation" class="location-picker__selected">\n                  No location selected\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <div class="form-actions">\n            <button \n              type="submit" \n              id="submitButton" \n              class="button"\n              ').concat(r?"disabled":"","\n            >\n              ").concat(n,"\n            </button>\n          </div>\n        </form>\n      </section>\n    ")};function or(t){return or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},or(t)}function ir(){ir=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==or(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(or(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function ar(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function sr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ar(Object(r),!0).forEach((function(e){ur(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ar(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ur(t,e,r){return(e=hr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cr(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function lr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){cr(i,n,o,a,s,"next",t)}function s(t){cr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function fr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hr(n.key),n)}}function hr(t){var e=function(t,e){if("object"!=or(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=or(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==or(e)?e:e+""}const pr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._stream=null,this._videoElement=null,this._canvasElement=null},e=[{key:"initCamera",value:(i=lr(ir().mark((function t(e){var r,n,o=arguments;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:{},e){t.next=3;break}throw new Error("Video element is required");case 3:return this._videoElement=e,n=sr(sr({},{video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}},audio:!1}),r),t.prev=6,this.stopCamera(),t.next=10,navigator.mediaDevices.getUserMedia(n);case 10:return this._stream=t.sent,this._videoElement.srcObject=this._stream,t.next=14,this._videoElement.play();case 14:return t.abrupt("return",this._stream);case 17:throw t.prev=17,t.t0=t.catch(6),new Error("Could not access camera: ".concat(t.t0.message));case 21:case"end":return t.stop()}}),t,this,[[6,17]])}))),function(t){return i.apply(this,arguments)})},{key:"stopCamera",value:function(){this._stream&&(this._stream.getTracks().forEach((function(t){return t.stop()})),this._stream=null),this._videoElement&&(this._videoElement.srcObject=null)}},{key:"takePhoto",value:function(t){if(!t)throw new Error("Canvas element is required");if(!this._stream||!this._videoElement)throw new Error("Camera not initialized. Call initCamera first.");this._canvasElement=t;var e=this._videoElement.videoWidth,r=this._videoElement.videoHeight;return this._canvasElement.width=e,this._canvasElement.height=r,this._canvasElement.getContext("2d").drawImage(this._videoElement,0,0,e,r),this._getBlobFromCanvas()}},{key:"getPhotoFile",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"photo.jpg";if(!this._canvasElement)throw new Error("No photo has been taken. Call takePhoto first.");return this._getBlobFromCanvas().then((function(e){return new File([e],t,{type:"image/jpeg"})}))}},{key:"switchCamera",value:(o=lr(ir().mark((function t(){var e,r,n,o;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._videoElement){t.next=2;break}throw new Error("Camera not initialized. Call initCamera first.");case 2:return e=this._stream.getVideoTracks()[0],r=e.getSettings(),n="user"===r.facingMode?"environment":"user",o={video:{facingMode:n,width:{ideal:1280},height:{ideal:720}},audio:!1},t.abrupt("return",this.initCamera(this._videoElement,o));case 7:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"_getBlobFromCanvas",value:function(){var t=this;return new Promise((function(e){t._canvasElement.toBlob((function(t){return e(t)}),"image/jpeg",.8)}))}}],r=[{key:"isCameraSupported",value:(n=lr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){t.next=2;break}return t.abrupt("return",!1);case 2:return t.prev=2,t.next=5,navigator.mediaDevices.getUserMedia({video:!0});case 5:return t.sent.getTracks().forEach((function(t){return t.stop()})),t.abrupt("return",!0);case 10:return t.prev=10,t.t0=t.catch(2),t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,null,[[2,10]])}))),function(){return n.apply(this,arguments)})}],e&&fr(t.prototype,e),r&&fr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}();function dr(t){return dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dr(t)}function vr(){vr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==dr(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(dr(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function yr(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function mr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){yr(i,n,o,a,s,"next",t)}function s(t){yr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function gr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,br(n.key),n)}}function br(t){var e=function(t,e){if("object"!=dr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=dr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==dr(e)?e:e+""}const wr=function(){return t=function t(e){var r=e.isLoading,n=void 0!==r&&r,o=e.container;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._isLoading=n,this._container=o,this._mapHelper=new Se,this._cameraHelper=new pr,this._selectedLocation=null,this._photoFile=null,this._isCameraActive=!1,this._submitHandler=null,this._bindMethods()},e=[{key:"_bindMethods",value:function(){this._initCamera=this._initCamera.bind(this),this._stopCamera=this._stopCamera.bind(this),this._takePhoto=this._takePhoto.bind(this),this._switchCamera=this._switchCamera.bind(this),this._onLocationSelected=this._onLocationSelected.bind(this),this._getUserLocation=this._getUserLocation.bind(this),this._resetPhoto=this._resetPhoto.bind(this),this._handleFileInput=this._handleFileInput.bind(this)}},{key:"render",value:function(){this._container.innerHTML=nr({isLoading:this._isLoading}),this._initMap(),this._attachEventListeners()}},{key:"_initMap",value:function(){var t=document.getElementById("locationMap");t&&(this._mapHelper.initMap(t),this._mapHelper.setupLocationSelector(this._onLocationSelected))}},{key:"_attachEventListeners",value:function(){var t=this,e={startCameraButton:document.getElementById("startCameraButton"),takePictureButton:document.getElementById("takePictureButton"),switchCameraButton:document.getElementById("switchCameraButton"),resetPhotoButton:document.getElementById("resetPhotoButton"),getUserLocationButton:document.getElementById("getUserLocationButton"),photoInput:document.getElementById("photoInput"),form:document.getElementById("addStoryForm")};e.startCameraButton&&e.startCameraButton.addEventListener("click",this._initCamera),e.takePictureButton&&e.takePictureButton.addEventListener("click",this._takePhoto),e.switchCameraButton&&e.switchCameraButton.addEventListener("click",this._switchCamera),e.resetPhotoButton&&e.resetPhotoButton.addEventListener("click",this._resetPhoto),e.getUserLocationButton&&e.getUserLocationButton.addEventListener("click",this._getUserLocation),e.photoInput&&e.photoInput.addEventListener("change",this._handleFileInput),e.form&&e.form.addEventListener("submit",(function(e){e.preventDefault(),t._validateForm()&&"function"==typeof t._submitHandler&&t._submitHandler(t._getFormData())}))}},{key:"_initCamera",value:(a=mr(vr().mark((function t(){var e;return vr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isCameraActive){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,e=document.getElementById("cameraPreview")){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,this._cameraHelper.initCamera(e);case 8:this._isCameraActive=!0,this._updateCameraUI(!0),this._showVideoPreview(),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),alert("Could not access camera: ".concat(t.t0.message));case 17:case"end":return t.stop()}}),t,this,[[2,13]])}))),function(){return a.apply(this,arguments)})},{key:"_stopCamera",value:function(){this._isCameraActive&&(this._cameraHelper.stopCamera(),this._isCameraActive=!1,this._updateCameraUI(!1))}},{key:"_takePhoto",value:(i=mr(vr().mark((function t(){var e;return vr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isCameraActive){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,e=document.getElementById("photoCanvas")){t.next=6;break}return t.abrupt("return");case 6:return this._cameraHelper.takePhoto(e),t.next=9,this._cameraHelper.getPhotoFile();case 9:this._photoFile=t.sent,this._showPhotoPreview(),this._updatePhotoUI(!0),this._stopCamera(),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(2),alert("Could not take photo: ".concat(t.t0.message));case 19:case"end":return t.stop()}}),t,this,[[2,15]])}))),function(){return i.apply(this,arguments)})},{key:"_switchCamera",value:(o=mr(vr().mark((function t(){return vr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isCameraActive){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,this._cameraHelper.switchCamera();case 5:t.next=11;break;case 7:t.prev=7,t.t0=t.catch(2),alert("Could not switch camera: ".concat(t.t0.message));case 11:case"end":return t.stop()}}),t,this,[[2,7]])}))),function(){return o.apply(this,arguments)})},{key:"_onLocationSelected",value:function(t){this._selectedLocation=t,this._updateLocationUI()}},{key:"_getUserLocation",value:(n=mr(vr().mark((function t(){return vr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._mapHelper.getUserLocation();case 3:this._selectedLocation=t.sent,this._updateLocationUI(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),alert("Could not get your location: ".concat(t.t0.message));case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return n.apply(this,arguments)})},{key:"_resetPhoto",value:function(){var t=document.getElementById("photoPreview"),e=document.getElementById("photoCanvas"),r=document.getElementById("photoInput");t&&(t.style.backgroundImage="none"),e&&e.getContext("2d").clearRect(0,0,e.width,e.height),r&&(r.value=""),this._photoFile=null,this._updatePhotoUI(!1)}},{key:"_handleFileInput",value:function(t){var e=this,r=t.target.files[0];if(r){if(!r.type.startsWith("image/"))return alert("Please select an image file"),void(t.target.value="");this._photoFile=r;var n=new FileReader;n.onload=function(t){var r=document.getElementById("photoPreview");r&&(r.style.backgroundImage="url(".concat(t.target.result,")"),e._showPhotoPreview())},n.readAsDataURL(r),this._updatePhotoUI(!0)}}},{key:"_validateForm",value:function(){var t=document.getElementById("description");return t&&t.value.trim()?!!this._photoFile||(alert("Please take or upload a photo for your story"),!1):(alert("Please enter a description for your story"),!1)}},{key:"_getFormData",value:function(){var t={description:document.getElementById("description").value.trim(),photo:this._photoFile};return this._selectedLocation&&(t.lat=this._selectedLocation.lat,t.lon=this._selectedLocation.lon),t}},{key:"_showVideoPreview",value:function(){var t={videoElement:document.getElementById("cameraPreview"),photoPreview:document.getElementById("photoPreview"),canvas:document.getElementById("photoCanvas")};t.videoElement&&t.photoPreview&&t.canvas&&(t.videoElement.style.display="block",t.photoPreview.style.display="none",t.canvas.style.display="none")}},{key:"_showPhotoPreview",value:function(){var t={videoElement:document.getElementById("cameraPreview"),photoPreview:document.getElementById("photoPreview"),canvas:document.getElementById("photoCanvas")};if(t.videoElement&&t.photoPreview&&t.canvas){t.videoElement.style.display="none",t.photoPreview.style.display="block";var e=t.canvas.toDataURL("image/jpeg");t.photoPreview.style.backgroundImage="url(".concat(e,")")}}},{key:"_updateCameraUI",value:function(t){var e={startCameraButton:document.getElementById("startCameraButton"),takePictureButton:document.getElementById("takePictureButton"),switchCameraButton:document.getElementById("switchCameraButton")};e.startCameraButton&&e.takePictureButton&&e.switchCameraButton&&(e.startCameraButton.disabled=t,e.takePictureButton.disabled=!t,e.switchCameraButton.disabled=!t)}},{key:"_updatePhotoUI",value:function(t){var e=document.getElementById("resetPhotoButton"),r=document.getElementById("startCameraButton");e&&r&&(e.disabled=!t,r.disabled=t)}},{key:"_updateLocationUI",value:function(){var t=document.getElementById("selectedLocation");if(t)if(this._selectedLocation){var e=this._selectedLocation,r=e.lat,n=e.lon;t.innerHTML='\n        <i class="fas fa-check-circle"></i>\n        Location selected: <br>\n        <strong>Latitude:</strong> '.concat(r.toFixed(6),", \n        <strong>Longitude:</strong> ").concat(n.toFixed(6),"\n      "),t.classList.add("location-picker__selected--active")}else t.textContent="No location selected",t.classList.remove("location-picker__selected--active")}},{key:"showSuccessMessage",value:function(){var t=document.getElementById("addStoryForm");if(t){var e=document.createElement("div");e.className="success-message",e.innerHTML='\n      <i class="fas fa-check-circle"></i>\n      <p>Your story has been posted successfully!</p>\n      <p>Redirecting to home page...</p>\n    ',t.innerHTML="",t.appendChild(e)}}},{key:"setSubmitHandler",value:function(t){"function"==typeof t&&(this._submitHandler=t)}},{key:"setLoading",value:function(t){this._isLoading=t;var e=document.getElementById("submitButton");e&&(e.disabled=t,e.innerHTML=t?'<i class="fas fa-spinner fa-spin"></i> Posting...':'<i class="fas fa-paper-plane"></i> Post Story'),this._container.querySelectorAll("button, input, textarea").forEach((function(e){"takePictureButton"!==e.id&&"switchCameraButton"!==e.id&&"resetPhotoButton"!==e.id&&(e.disabled=t)}))}},{key:"cleanup",value:function(){this._stopCamera()}}],e&&gr(t.prototype,e),r&&gr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a}();function _r(t){return _r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_r(t)}function xr(){xr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==_r(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(_r(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function kr(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Er(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){kr(i,n,o,a,s,"next",t)}function s(t){kr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Sr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Or(n.key),n)}}function Or(t){var e=function(t,e){if("object"!=_r(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_r(e)?e:e+""}var Pr=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._params=e,this._view=null,this._container=document.querySelector("#pageContent"),this._isLoading=!1,this._handleSubmit=this._handleSubmit.bind(this)},e=[{key:"init",value:function(){var t=Er(xr().mark((function t(){return xr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Pt.isAuthenticated()){t.next=3;break}return g().fire({title:"Authentication Required",text:"Please login to add a new story",icon:"warning",confirmButtonColor:"#2563EB"}).then((function(){window.location.hash="#/login"})),t.abrupt("return");case 3:Ae("#pageContent",{name:"add-story-transition",duration:400}),this._renderView();case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_renderView",value:function(){this._view=new wr({isLoading:this._isLoading,container:this._container}),this._view.render(),this._view.setSubmitHandler(this._handleSubmit)}},{key:"_handleSubmit",value:(n=Er(xr().mark((function t(e){var r;return xr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isLoading){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,this._isLoading=!0,this._view&&this._view.setLoading(!0),r=Pt.isAuthenticated(),t.next=8,ft.addStory(e,r);case 8:t.sent,this._view&&this._view.showSuccessMessage(),g().fire({title:"Story Posted!",text:"Your story has been successfully shared",icon:"success",timer:2e3,timerProgressBar:!0,showConfirmButton:!1}),setTimeout((function(){window.location.hash="#/"}),2e3),t.next=20;break;case 14:t.prev=14,t.t0=t.catch(2),g().fire({title:"Failed to Post Story",text:t.t0.message||"An error occurred while posting your story",icon:"error",confirmButtonColor:"#2563EB"}),this._isLoading=!1,this._view&&this._view.setLoading(!1);case 20:case"end":return t.stop()}}),t,this,[[2,14]])}))),function(t){return n.apply(this,arguments)})},{key:"cleanup",value:function(){this._view&&this._view.cleanup()}}],e&&Sr(t.prototype,e),r&&Sr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const jr=Pr;function Tr(t){return Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tr(t)}function Fr(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Lr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Lr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ir(){Ir=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Tr(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Tr(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Cr(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Nr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Cr(i,n,o,a,s,"next",t)}function s(t){Cr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Ar(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Br(n.key),n)}}function Br(t){var e=function(t,e){if("object"!=Tr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Tr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Tr(e)?e:e+""}var Gr=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._params=e,this._view=null,this._confirmationResolve=null,this._isLoading=!1},e=[{key:"init",value:function(){var t=Nr(Ir().mark((function t(){return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,document.querySelector("#pageContent").innerHTML='\n  <div class="favorite-page">\n    <div class="page-header">\n      <div class="header-content">\n        <h1 class="page-title">\n          <i class="fas fa-heart"></i>\n          My Favorite Stories\n        </h1>\n        <div class="header-actions">\n          <div class="favorites-count">\n            <span class="count-badge">0</span>\n            <span class="count-label">Favorites</span>\n          </div>\n          <div class="header-buttons">\n            <button class="btn btn-outline" id="refreshFavorites">\n              <i class="fas fa-sync-alt"></i>\n              Refresh\n            </button>\n            <div class="dropdown">\n              <button class="btn btn-outline dropdown-toggle" id="moreActions">\n                <i class="fas fa-ellipsis-v"></i>\n                More\n              </button>\n              <div class="dropdown-menu">\n                <button class="dropdown-item" id="exportFavorites">\n                  <i class="fas fa-download"></i>\n                  Export Favorites\n                </button>\n                <label class="dropdown-item" for="importFavorites">\n                  <i class="fas fa-upload"></i>\n                  Import Favorites\n                  <input type="file" id="importFavorites" accept=".json" style="display: none;">\n                </label>\n                <div class="dropdown-divider"></div>\n                <button class="dropdown-item text-danger" id="clearAllFavorites">\n                  <i class="fas fa-trash-alt"></i>\n                  Clear All Favorites\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="page-content">\n      <div class="loading-state" id="loadingState" style="display: none;">\n        <div class="loading-spinner">\n          <i class="fas fa-spinner fa-spin"></i>\n        </div>\n        <p>Loading your favorite stories...</p>\n      </div>\n\n      <div class="empty-state" id="emptyState" style="display: none;">\n        <div class="empty-icon">\n          <i class="fas fa-heart"></i>\n        </div>\n        <h3>No Favorite Stories Yet</h3>\n        <p>Stories you mark as favorites will appear here. Start exploring and save your favorite stories!</p>\n        <a href="/#/home" class="btn btn-primary">\n          <i class="fas fa-compass"></i>\n          Explore Stories\n        </a>\n      </div>\n\n      <div class="error-state" id="errorState" style="display: none;">\n        <div class="error-icon">\n          <i class="fas fa-exclamation-triangle"></i>\n        </div>\n        <h3>Failed to Load Favorites</h3>\n        <p class="error-message">Something went wrong while loading your favorite stories.</p>\n        <button class="btn btn-primary" id="retryLoad">\n          <i class="fas fa-redo"></i>\n          Try Again\n        </button>\n      </div>\n\n      <div class="favorites-container" id="favoritesContainer">\n        <div class="favorites-grid" id="favoritesGrid">\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class="modal" id="confirmationModal" style="display: none;">\n    <div class="modal-overlay"></div>\n    <div class="modal-content">\n      <div class="modal-header">\n        <h3 class="modal-title" id="confirmationTitle">Confirm Action</h3>\n        <button class="modal-close" id="closeConfirmation">\n          <i class="fas fa-times"></i>\n        </button>\n      </div>\n      <div class="modal-body">\n        <p class="modal-message" id="confirmationMessage">Are you sure you want to perform this action?</p>\n      </div>\n      <div class="modal-footer">\n        <button class="btn btn-secondary" id="cancelConfirmation">Cancel</button>\n        <button class="btn btn-danger" id="confirmAction">Confirm</button>\n      </div>\n    </div>\n  </div>\n\n  <div class="toast-container" id="toastContainer">\n  </div>\n',this._initializeElements(),this._bindEvents(),t.next=7,this._initView();case 7:t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),this._showErrorPage(t.t0.message);case 13:case"end":return t.stop()}}),t,this,[[0,9]])})));return function(){return t.apply(this,arguments)}}()},{key:"_initializeElements",value:function(){this._loadingState=document.querySelector("#loadingState"),this._emptyState=document.querySelector("#emptyState"),this._errorState=document.querySelector("#errorState"),this._favoritesContainer=document.querySelector("#favoritesContainer"),this._favoritesGrid=document.querySelector("#favoritesGrid"),this._favoritesCount=document.querySelector(".count-badge"),this._confirmationModal=document.querySelector("#confirmationModal"),this._toastContainer=document.querySelector("#toastContainer")}},{key:"_initView",value:(c=Nr(Ir().mark((function t(){return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._loadFavorites();case 2:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"_bindEvents",value:function(){var t,e,r,n,o,i=this;null===(t=document.querySelector("#refreshFavorites"))||void 0===t||t.addEventListener("click",Nr(Ir().mark((function t(){return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i._loadFavorites();case 2:case"end":return t.stop()}}),t)})))),null===(e=document.querySelector("#exportFavorites"))||void 0===e||e.addEventListener("click",Nr(Ir().mark((function t(){return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i._handleExportFavorites();case 2:case"end":return t.stop()}}),t)})))),null===(r=document.querySelector("#importFavorites"))||void 0===r||r.addEventListener("change",function(){var t=Nr(Ir().mark((function t(e){var r,n;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(r=e.target.files[0])&&((n=new FileReader).onload=function(){var t=Nr(Ir().mark((function t(r){return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i._handleImportFavorites(r.target.result);case 2:e.target.value="";case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n.readAsText(r));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),null===(n=document.querySelector("#clearAllFavorites"))||void 0===n||n.addEventListener("click",Nr(Ir().mark((function t(){return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i._handleClearAllFavorites();case 2:case"end":return t.stop()}}),t)})))),null===(o=document.querySelector("#retryLoad"))||void 0===o||o.addEventListener("click",Nr(Ir().mark((function t(){return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i._loadFavorites();case 2:case"end":return t.stop()}}),t)})))),this._bindModalEvents(),this._bindDropdownEvents()}},{key:"_bindModalEvents",value:function(){var t=this,e=this._confirmationModal;if(e){var r=e.querySelector(".modal-overlay"),n=e.querySelector("#closeConfirmation"),o=e.querySelector("#cancelConfirmation"),i=e.querySelector("#confirmAction");[r,n,o].forEach((function(e){null==e||e.addEventListener("click",(function(){t._hideConfirmationModal(!1)}))})),null==i||i.addEventListener("click",(function(){t._hideConfirmationModal(!0)})),document.addEventListener("keydown",(function(r){"Escape"===r.key&&e.classList.contains("active")&&t._hideConfirmationModal(!1)}))}}},{key:"_bindDropdownEvents",value:function(){var t=document.querySelector(".dropdown"),e=document.querySelector("#moreActions");null==e||e.addEventListener("click",(function(e){e.stopPropagation(),null==t||t.classList.toggle("active")})),document.addEventListener("click",(function(e){t&&!t.contains(e.target)&&t.classList.remove("active")}))}},{key:"_bindDynamicEvents",value:function(){var t=this;document.querySelectorAll(".btn-remove-favorite").forEach((function(e){e.addEventListener("click",function(){var e=Nr(Ir().mark((function e(r){var n;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),!(n=r.target.closest(".btn-remove-favorite").dataset.storyId)){e.next=5;break}return e.next=5,t._handleRemoveFavorite(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),document.querySelectorAll(".btn-share").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();var r=e.target.closest(".btn-share").dataset.storyId;r&&t._shareStory(r)}))}))}},{key:"_shareStory",value:function(t){var e=this,r="".concat(window.location.origin,"/#/detail/").concat(t);navigator.share?navigator.share({title:"Check out this story",url:r}).catch((function(t){})):navigator.clipboard.writeText(r).then((function(){e._showSuccessMessage("Story link copied to clipboard!")})).catch((function(){e._showErrorMessage("Failed to copy link to clipboard.")}))}},{key:"_loadFavorites",value:(u=Nr(Ir().mark((function t(){var e;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isLoading){t.next=2;break}return t.abrupt("return");case 2:return this._isLoading=!0,t.prev=3,this._showLoadingState(),t.next=8,Dt.getFavorites();case 8:(e=t.sent)&&0!==e.length?(this._renderFavorites(e),this._updateFavoritesCount(e.length)):this._showEmptyState(),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(3),this._showErrorState(t.t0.message);case 16:return t.prev=16,this._isLoading=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[3,12,16,19]])}))),function(){return u.apply(this,arguments)})},{key:"_renderFavorites",value:function(t){var e=this;this._favoritesGrid&&(this._favoritesGrid.innerHTML="",t.forEach((function(t){var r=document.createElement("div");r.innerHTML=function(t){return'\n  <div class="story-item" data-story-id="'.concat(t.id,'">\n    <div class="story-image">\n      <img src="').concat(t.photoUrl||"/images/placeholder.jpg",'" \n           alt="').concat(t.name,'" \n           onerror="this.src=\'/images/placeholder.jpg\'">\n    </div>\n    <div class="story-content">\n      <div class="story-header">\n        <h3 class="story-title">').concat(t.name,'</h3>\n        <div class="story-actions">\n          <button class="btn-remove-favorite" \n                  data-story-id="').concat(t.id,'" \n                  title="Remove from favorites">\n            <i class="fas fa-heart-broken"></i>\n          </button>\n        </div>\n      </div>\n      <p class="story-description">').concat(t.description,'</p>\n      <div class="story-meta">\n        <span class="story-date">\n          <i class="fas fa-calendar-alt"></i>\n          ').concat(new Date(t.createdAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}),'\n        </span>\n        <span class="story-saved-date">\n          <i class="fas fa-heart"></i>\n          Saved on ').concat(new Date(t.savedAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}),'\n        </span>\n      </div>\n      <div class="story-actions-bottom">\n        <a href="/#/detail/').concat(t.id,'" class="btn btn-primary">\n          <i class="fas fa-eye"></i>\n          View Details\n        </a>\n        <button class="btn btn-secondary btn-share" data-story-id="').concat(t.id,'">\n          <i class="fas fa-share-alt"></i>\n          Share\n        </button>\n      </div>\n    </div>\n  </div>\n')}(t),e._favoritesGrid.appendChild(r.firstElementChild)})),this._bindDynamicEvents(),this._showFavoritesContent())}},{key:"_updateFavoritesCount",value:function(t){this._favoritesCount&&(this._favoritesCount.textContent=t)}},{key:"_handleRemoveFavorite",value:(s=Nr(Ir().mark((function t(e){return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._showConfirmationModal("Remove Favorite","Are you sure you want to remove this story from your favorites?");case 3:if(!t.sent){t.next=10;break}return t.next=7,Dt.removeFavorite(e);case 7:return this._showSuccessMessage("Story removed from favorites!"),t.next=10,this._loadFavorites();case 10:t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),this._showErrorMessage("Failed to remove favorite. Please try again.");case 16:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(t){return s.apply(this,arguments)})},{key:"_handleClearAllFavorites",value:(a=Nr(Ir().mark((function t(){return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._showConfirmationModal("Clear All Favorites","Are you sure you want to remove all stories from your favorites? This action cannot be undone.");case 3:if(!t.sent){t.next=10;break}return t.next=7,Dt.clearAllFavorites();case 7:return this._showSuccessMessage("All favorites cleared!"),t.next=10,this._loadFavorites();case 10:t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),this._showErrorMessage("Failed to clear favorites. Please try again.");case 16:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return a.apply(this,arguments)})},{key:"_handleExportFavorites",value:(i=Nr(Ir().mark((function t(){var e,r,n,o;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Dt.getFavorites();case 3:if((e=t.sent)&&0!==e.length){t.next=7;break}return this._showWarningMessage("No favorites to export."),t.abrupt("return");case 7:r=JSON.stringify(e,null,2),n=new Blob([r],{type:"application/json"}),(o=document.createElement("a")).href=URL.createObjectURL(n),o.download="favorites-".concat((new Date).toISOString().split("T")[0],".json"),o.click(),URL.revokeObjectURL(o.href),this._showSuccessMessage("Favorites exported successfully!"),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(0),this._showErrorMessage("Failed to export favorites. Please try again.");case 21:case"end":return t.stop()}}),t,this,[[0,17]])}))),function(){return i.apply(this,arguments)})},{key:"_handleImportFavorites",value:(o=Nr(Ir().mark((function t(e){var r,n,o,i,a;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=JSON.parse(e),Array.isArray(r)){t.next=4;break}throw new Error("Invalid file format. Expected an array of favorites.");case 4:n=0,o=Fr(r),t.prev=6,o.s();case 8:if((i=o.n()).done){t.next=16;break}if(a=i.value,!this._isValidFavorite(a)){t.next=14;break}return t.next=13,Dt.addFavorite(a);case 13:n++;case 14:t.next=8;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(6),o.e(t.t0);case 21:return t.prev=21,o.f(),t.finish(21);case 24:if(!(n>0)){t.next=30;break}return this._showSuccessMessage("Successfully imported ".concat(n," favorites!")),t.next=28,this._loadFavorites();case 28:t.next=31;break;case 30:this._showWarningMessage("No valid favorites found in the file.");case 31:t.next=37;break;case 33:t.prev=33,t.t1=t.catch(0),this._showErrorMessage("Failed to import favorites. Please check the file format.");case 37:case"end":return t.stop()}}),t,this,[[0,33],[6,18,21,24]])}))),function(t){return o.apply(this,arguments)})},{key:"_isValidFavorite",value:function(t){return t&&"object"===Tr(t)&&t.id&&t.title&&t.description}},{key:"_showConfirmationModal",value:(n=Nr(Ir().mark((function t(e,r){var n=this;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._confirmationModal){t.next=2;break}return t.abrupt("return",!1);case 2:return t.abrupt("return",new Promise((function(t){n._confirmationResolve=t;var o=n._confirmationModal.querySelector("#confirmationTitle"),i=n._confirmationModal.querySelector("#confirmationMessage");o&&(o.textContent=e),i&&(i.textContent=r),n._confirmationModal.classList.add("active"),document.body.style.overflow="hidden"})));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"_hideConfirmationModal",value:function(t){this._confirmationModal&&(this._confirmationModal.classList.remove("active"),document.body.style.overflow="",this._confirmationResolve&&(this._confirmationResolve(t),this._confirmationResolve=null))}},{key:"_showLoadingState",value:function(){var t;this._hideAllStates(),null===(t=this._loadingState)||void 0===t||t.classList.add("active")}},{key:"_showEmptyState",value:function(){var t;this._hideAllStates(),null===(t=this._emptyState)||void 0===t||t.classList.add("active")}},{key:"_showErrorState",value:function(t){if(this._hideAllStates(),this._errorState){this._errorState.classList.add("active");var e=this._errorState.querySelector(".error-message");e&&(e.textContent=t||"An error occurred while loading favorites.")}}},{key:"_showFavoritesContent",value:function(){var t;this._hideAllStates(),null===(t=this._favoritesContainer)||void 0===t||t.classList.add("active")}},{key:"_hideAllStates",value:function(){[this._loadingState,this._emptyState,this._errorState,this._favoritesContainer].forEach((function(t){return null==t?void 0:t.classList.remove("active")}))}},{key:"_showErrorPage",value:function(t){var e='\n      <div class="error-page">\n        <div class="error-icon"></div>\n        <h2>Something went wrong</h2>\n        <p>'.concat(t,'</p>\n        <button class="btn btn-primary" onclick="location.reload()">\n          Reload Page\n        </button>\n      </div>\n    ');document.querySelector("#pageContent").innerHTML=e}},{key:"_showToast",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";if(this._toastContainer){var n=document.createElement("div");n.innerHTML=function(t,e){return'\n  <div class="toast toast-'.concat(t,'" data-toast>\n    <div class="toast-icon">\n      <i class="fas fa-').concat("success"===t?"check-circle":"error"===t?"exclamation-circle":"info-circle",'"></i>\n    </div>\n    <div class="toast-content">\n      <p class="toast-message">').concat(e,'</p>\n    </div>\n    <button class="toast-close">\n      <i class="fas fa-times"></i>\n    </button>\n  </div>\n')}(t,r);var o=n.firstElementChild;this._toastContainer.appendChild(o),setTimeout((function(){o.classList.add("show")}),100),setTimeout((function(){e._hideToast(o)}),3e3),o.addEventListener("click",(function(){e._hideToast(o)}))}}},{key:"_hideToast",value:function(t){t.classList.remove("show"),setTimeout((function(){t.parentNode&&t.parentNode.removeChild(t)}),300)}},{key:"_showSuccessMessage",value:function(t){this._showToast(t,"success")}},{key:"_showErrorMessage",value:function(t){this._showToast(t,"error")}},{key:"_showWarningMessage",value:function(t){this._showToast(t,"warning")}},{key:"_showInfoMessage",value:function(t){this._showToast(t,"info")}},{key:"destroy",value:function(){this._isLoading=!1,this._confirmationResolve=null,document.removeEventListener("keydown",this._handleEscapeKey),document.removeEventListener("click",this._handleDocumentClick)}}],e&&Ar(t.prototype,e),r&&Ar(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s,u,c}();const Mr=Gr;const Dr=function(t){var e=t.error,r=void 0===e?null:e,n=t.isLoading,o=void 0!==n&&n,i=r?'\n        <div class="auth-error">\n          <i class="fas fa-exclamation-circle"></i>\n          <p>'.concat(r,"</p>\n        </div>\n      "):"",a=o?'<i class="fas fa-spinner fa-spin"></i> Logging in...':'<i class="fas fa-sign-in-alt"></i> Login';return'\n      <section class="auth">\n        <div class="auth-container">\n          <h2 class="auth__title">Login</h2>\n          \n          '.concat(i,'\n          \n          <form id="loginForm" class="auth-form">\n            <div class="form-group">\n              <label for="email" class="form-label">Email</label>\n              <input \n                type="email" \n                id="email" \n                name="email" \n                class="form-input" \n                placeholder="your.email@example.com" \n                required\n                ').concat(o?"disabled":"",'\n              />\n            </div>\n            \n            <div class="form-group">\n              <label for="password" class="form-label">Password</label>\n              <input \n                type="password" \n                id="password" \n                name="password" \n                class="form-input" \n                placeholder="Your password" \n                required\n                minlength="8"\n                ').concat(o?"disabled":"",'\n              />\n            </div>\n            \n            <div class="form-actions">\n              <button \n                type="submit" \n                id="loginButton" \n                class="button"\n                ').concat(o?"disabled":"","\n              >\n                ").concat(a,'\n              </button>\n            </div>\n          </form>\n          \n          <div class="auth-footer">\n            <p>Don\'t have an account?</p>\n            <a href="#/register" class="auth-link">Register here</a>\n          </div>\n        </div>\n      </section>\n    ')};function Rr(t){return Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rr(t)}function Hr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ur(n.key),n)}}function Ur(t){var e=function(t,e){if("object"!=Rr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Rr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Rr(e)?e:e+""}const qr=function(){return t=function t(e){var r=e.error,n=void 0===r?null:r,o=e.isLoading,i=void 0!==o&&o,a=e.container;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._error=n,this._isLoading=i,this._container=a,this._loginHandler=null},e=[{key:"render",value:function(){this._container.innerHTML=Dr({error:this._error,isLoading:this._isLoading}),this._attachEventListeners()}},{key:"_attachEventListeners",value:function(){var t=this,e=document.getElementById("loginForm");e&&!this._isLoading&&e.addEventListener("submit",(function(e){if(e.preventDefault(),t._validateForm()){var r=document.getElementById("email").value.trim(),n=document.getElementById("password").value;t._loginHandler&&t._loginHandler({email:r,password:n})}}))}},{key:"_validateForm",value:function(){var t=document.getElementById("email"),e=document.getElementById("password");return t.validity.valid?!(e.value.length<8&&(this._showFieldError(e,"Password must be at least 8 characters long"),1)):(this._showFieldError(t,"Please enter a valid email address"),!1)}},{key:"_showFieldError",value:function(t,e){t.classList.add("form-input--error");var r=t.nextElementSibling;r&&r.classList.contains("form-error")||((r=document.createElement("p")).className="form-error",t.parentNode.insertBefore(r,t.nextSibling)),r.textContent=e,t.addEventListener("input",(function(){t.classList.remove("form-input--error"),r&&r.parentNode&&r.parentNode.removeChild(r)}),{once:!0})}},{key:"setLoginHandler",value:function(t){this._loginHandler=t}},{key:"setLoading",value:function(t){this._isLoading=t;var e=document.getElementById("loginButton");e&&(e.disabled=t,e.innerHTML=t?'<i class="fas fa-spinner fa-spin"></i> Logging in...':'<i class="fas fa-sign-in-alt"></i> Login'),this._container.querySelectorAll(".form-input").forEach((function(e){e.disabled=t}))}},{key:"cleanup",value:function(){var t=document.getElementById("loginForm");t&&t.removeEventListener("submit",this._handleSubmit)}}],e&&Hr(t.prototype,e),r&&Hr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Yr(t){return Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yr(t)}function zr(){zr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Yr(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Yr(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Wr(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Vr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Wr(i,n,o,a,s,"next",t)}function s(t){Wr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Kr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Jr(n.key),n)}}function Jr(t){var e=function(t,e){if("object"!=Yr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Yr(e)?e:e+""}var Qr=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._params=e,this._view=null,this._container=document.querySelector("#pageContent"),this._error=null,this._isLoading=!1,this._handleLogin=this._handleLogin.bind(this)},e=[{key:"init",value:function(){var t=Vr(zr().mark((function t(){return zr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Pt.isAuthenticated()){t.next=3;break}return window.location.hash="#/",t.abrupt("return");case 3:Ae("#pageContent",{name:"login-transition",duration:400}),this._renderView();case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_renderView",value:function(){this._view=new qr({error:this._error,isLoading:this._isLoading,container:this._container}),this._view.render(),this._view.setLoginHandler(this._handleLogin)}},{key:"_handleLogin",value:(n=Vr(zr().mark((function t(e){return zr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isLoading){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,this._isLoading=!0,this._view&&this._view.setLoading(!0),t.next=7,Pt.login(e);case 7:g().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:function(t){t.addEventListener("mouseenter",g().stopTimer),t.addEventListener("mouseleave",g().resumeTimer)}}).fire({icon:"success",title:"Login berhasil"}),window.location.hash="#/",t.next=18;break;case 12:t.prev=12,t.t0=t.catch(2),this._error=t.t0.message||"Login failed. Please check your credentials and try again.",this._isLoading=!1,this._renderView();case 18:return t.prev=18,this._isLoading=!1,this._view&&this._view.setLoading(!1),t.finish(18);case 22:case"end":return t.stop()}}),t,this,[[2,12,18,22]])}))),function(t){return n.apply(this,arguments)})},{key:"cleanup",value:function(){this._view&&this._view.cleanup()}}],e&&Kr(t.prototype,e),r&&Kr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const $r=Qr;const Zr=function(t){var e=t.error,r=void 0===e?null:e,n=t.isLoading,o=void 0!==n&&n,i=r?'\n        <div class="auth-error">\n          <i class="fas fa-exclamation-circle"></i>\n          <p>'.concat(r,"</p>\n        </div>\n      "):"",a=o?'<i class="fas fa-spinner fa-spin"></i> Registering...':'<i class="fas fa-user-plus"></i> Register';return'\n      <section class="auth">\n        <div class="auth-container">\n          <h2 class="auth__title">Register</h2>\n          \n          '.concat(i,'\n          \n          <form id="registerForm" class="auth-form">\n            <div class="form-group">\n              <label for="name" class="form-label">Name</label>\n              <input \n                type="text" \n                id="name" \n                name="name" \n                class="form-input" \n                placeholder="Your name" \n                required\n                ').concat(o?"disabled":"",'\n              />\n            </div>\n            \n            <div class="form-group">\n              <label for="email" class="form-label">Email</label>\n              <input \n                type="email" \n                id="email" \n                name="email" \n                class="form-input" \n                placeholder="your.email@example.com" \n                required\n                ').concat(o?"disabled":"",'\n              />\n            </div>\n            \n            <div class="form-group">\n              <label for="password" class="form-label">Password</label>\n              <input \n                type="password" \n                id="password" \n                name="password" \n                class="form-input" \n                placeholder="Min. 8 characters" \n                required\n                minlength="8"\n                ').concat(o?"disabled":"",'\n              />\n              <p class="form-hint">Password must be at least 8 characters</p>\n            </div>\n            \n            <div class="form-group">\n              <label for="confirmPassword" class="form-label">Confirm Password</label>\n              <input \n                type="password" \n                id="confirmPassword" \n                name="confirmPassword" \n                class="form-input" \n                placeholder="Confirm your password" \n                required\n                minlength="8"\n                ').concat(o?"disabled":"",'\n              />\n            </div>\n            \n            <div class="form-actions">\n              <button \n                type="submit" \n                id="registerButton" \n                class="button"\n                ').concat(o?"disabled":"","\n              >\n                ").concat(a,'\n              </button>\n            </div>\n          </form>\n          \n          <div class="auth-footer">\n            <p>Already have an account?</p>\n            <a href="#/login" class="auth-link">Login here</a>\n          </div>\n        </div>\n      </section>\n    ')};function Xr(t){return Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xr(t)}function tn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,en(n.key),n)}}function en(t){var e=function(t,e){if("object"!=Xr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Xr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Xr(e)?e:e+""}const rn=function(){return t=function t(e){var r=e.error,n=void 0===r?null:r,o=e.isLoading,i=void 0!==o&&o,a=e.container;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._error=n,this._isLoading=i,this._container=a,this._registerHandler=null},e=[{key:"render",value:function(){this._container.innerHTML=Zr({error:this._error,isLoading:this._isLoading}),this._attachEventListeners()}},{key:"_attachEventListeners",value:function(){var t=this,e=document.getElementById("registerForm");e&&!this._isLoading&&e.addEventListener("submit",this._handleSubmit=function(e){if(e.preventDefault(),t._validateForm()){var r=document.getElementById("name").value.trim(),n=document.getElementById("email").value.trim(),o=document.getElementById("password").value;t._registerHandler&&t._registerHandler({name:r,email:n,password:o})}})}},{key:"_validateForm",value:function(){var t=document.getElementById("name"),e=document.getElementById("email"),r=document.getElementById("password"),n=document.getElementById("confirmPassword");return t.value.trim()?e.validity.valid?r.value.length<8?(this._showFieldError(r,"Password must be at least 8 characters long"),!1):r.value===n.value||(this._showFieldError(n,"Passwords do not match"),!1):(this._showFieldError(e,"Please enter a valid email address"),!1):(this._showFieldError(t,"Please enter your name"),!1)}},{key:"_showFieldError",value:function(t,e){t.classList.add("form-input--error");var r=t.nextElementSibling;r&&r.classList.contains("form-error")||((r=document.createElement("p")).className="form-error",t.parentNode.insertBefore(r,t.nextSibling)),r.textContent=e,t.addEventListener("input",(function(){t.classList.remove("form-input--error"),r&&r.parentNode&&r.parentNode.removeChild(r)}),{once:!0})}},{key:"setRegisterHandler",value:function(t){this._registerHandler=t}},{key:"setLoading",value:function(t){this._isLoading=t;var e=document.getElementById("registerButton");e&&(e.disabled=t,e.innerHTML=t?'<i class="fas fa-spinner fa-spin"></i> Registering...':'<i class="fas fa-user-plus"></i> Register'),this._container.querySelectorAll(".form-input").forEach((function(e){e.disabled=t}))}},{key:"showSuccessMessage",value:function(){var t=document.getElementById("registerForm");if(t){var e=document.createElement("div");e.className="success-message",e.innerHTML='\n      <i class="fas fa-check-circle"></i>\n      <p>Registration successful!</p>\n      <p>Redirecting to login page...</p>\n    ',t.innerHTML="",t.appendChild(e)}}},{key:"cleanup",value:function(){var t=document.getElementById("registerForm");t&&t.removeEventListener("submit",this._handleSubmit)}}],e&&tn(t.prototype,e),r&&tn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function nn(t){return nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nn(t)}function on(){on=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==nn(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(nn(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function an(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function sn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){an(i,n,o,a,s,"next",t)}function s(t){an(i,n,o,a,s,"throw",t)}a(void 0)}))}}function un(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cn(n.key),n)}}function cn(t){var e=function(t,e){if("object"!=nn(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=nn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==nn(e)?e:e+""}var ln=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._params=e,this._view=null,this._container=document.querySelector("#pageContent"),this._error=null,this._isLoading=!1,this._handleRegister=this._handleRegister.bind(this)},e=[{key:"init",value:function(){var t=sn(on().mark((function t(){return on().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Pt.isAuthenticated()){t.next=3;break}return g().fire({title:"Already Logged In",text:"You are already logged in. Please log out first to register a new account.",icon:"info",confirmButtonColor:"#2563EB"}).then((function(){window.location.hash="#/"})),t.abrupt("return");case 3:Ae("#pageContent",{name:"register-transition",duration:400}),this._renderView();case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_renderView",value:function(){this._view=new rn({error:this._error,isLoading:this._isLoading,container:this._container}),this._view.render(),this._view.setRegisterHandler(this._handleRegister)}},{key:"_handleRegister",value:(n=sn(on().mark((function t(e){return on().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isLoading){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,this._isLoading=!0,this._view&&this._view.setLoading(!0),t.next=7,Pt.register(e);case 7:this._view&&this._view.showSuccessMessage(),g().fire({title:"Registration Successful!",text:"Your account has been created. You can now log in.",icon:"success",confirmButtonColor:"#2563EB",confirmButtonText:"Login Now"}).then((function(){window.location.hash="#/login"})),t.next=17;break;case 11:t.prev=11,t.t0=t.catch(2),this._error=t.t0.message||"Registration failed. Please try again.",this._isLoading=!1,this._renderView();case 17:return t.prev=17,this._isLoading=!1,this._view&&this._view.setLoading(!1),t.finish(17);case 21:case"end":return t.stop()}}),t,this,[[2,11,17,21]])}))),function(t){return n.apply(this,arguments)})},{key:"cleanup",value:function(){this._view&&this._view.cleanup()}}],e&&un(t.prototype,e),r&&un(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function fn(t){return fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fn(t)}function hn(){hn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==fn(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(fn(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function pn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return dn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function vn(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function yn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){vn(i,n,o,a,s,"next",t)}function s(t){vn(i,n,o,a,s,"throw",t)}a(void 0)}))}}function mn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gn(n.key),n)}}function gn(t){var e=function(t,e){if("object"!=fn(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=fn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==fn(e)?e:e+""}var bn={"/":qe,"/detail/:id":rr,"/add":jr,"/favorites":Mr,"/login":$r,"/register":ln},wn=["mainContent","pageContent"];const _n=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._currentPage=null,this._routes=bn,this._loadPage=this._loadPage.bind(this),this.navigate=this.navigate.bind(this)},e=[{key:"init",value:function(){window.addEventListener("hashchange",this._loadPage),this._loadPage()}},{key:"_loadPage",value:(n=yn(hn().mark((function t(){var e,r,n,o,i,a,s,u=this;return hn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.location.hash.slice(1)||"/",!wn.includes(e)){t.next=5;break}return(r=document.getElementById(e))&&(r.hasAttribute("tabindex")||r.setAttribute("tabindex","-1"),r.focus(),r.scrollIntoView()),t.abrupt("return");case 5:n=null,o={},i=hn().mark((function t(){var r,i,c,l,f,h,p;return hn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=pn(s[a],2),i=r[0],c=r[1],l=u._convertRouteToRegex(i),!(f=e.match(l))){t.next=7;break}return i.includes(":")&&(h=i.split("/").filter((function(t){return t.startsWith(":")})).map((function(t){return t.slice(1)})),p=f.slice(1),h.forEach((function(t,e){o[t]=p[e]}))),n=c,t.abrupt("return",1);case 7:case"end":return t.stop()}}),t)})),a=0,s=Object.entries(this._routes);case 9:if(!(a<s.length)){t.next=16;break}return t.delegateYield(i(),"t0",11);case 11:if(!t.t0){t.next=13;break}return t.abrupt("break",16);case 13:a++,t.next=9;break;case 16:if(this._currentPage&&"function"==typeof this._currentPage.cleanup&&this._currentPage.cleanup(),!n){t.next=32;break}if(!this._isProtectedRoute(e)||this._isAuthenticated()){t.next=21;break}return g().fire({title:"Login Required",text:"Please login to access this page",icon:"info",confirmButtonColor:"#2563EB"}).then((function(){u.navigate("/login")})),t.abrupt("return");case 21:return t.prev=21,t.next=24,Ne(yn(hn().mark((function t(){return hn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u._currentPage=new n(o),t.next=3,u._currentPage.init();case 3:case"end":return t.stop()}}),t)}))));case 24:t.next=30;break;case 26:t.prev=26,t.t1=t.catch(21),document.querySelector("#pageContent").innerHTML='\n          <div class="error-container">\n            <i class="fas fa-exclamation-circle error-icon"></i>\n            <h2>Oops! Something went wrong</h2>\n            <p class="error-message">'.concat(t.t1.message,'</p>\n            <button class="button" onclick="window.location.reload()">\n              <i class="fas fa-redo"></i> Try Again\n            </button>\n          </div>\n        ');case 30:t.next=33;break;case 32:document.querySelector("#pageContent").innerHTML='\n        <div class="error-container">\n          <i class="fas fa-search error-icon"></i>\n          <h2>Page Not Found</h2>\n          <p class="error-message">The page you\'re looking for doesn\'t exist.</p>\n          <button class="button" onclick="window.location.hash = \'#\'">\n            <i class="fas fa-home"></i> Go to Homepage\n          </button>\n        </div>\n      ';case 33:case"end":return t.stop()}}),t,this,[[21,26]])}))),function(){return n.apply(this,arguments)})},{key:"navigate",value:function(t){window.location.hash=t}},{key:"_isProtectedRoute",value:function(t){return["/add","/detail","/favorites"].some((function(e){return t.startsWith(e)}))}},{key:"_isAuthenticated",value:function(){return Pt.isAuthenticated()}},{key:"_convertRouteToRegex",value:function(t){var e=t.replace(/\//g,"\\/").replace(/:\w+/g,"([^/]+)");return new RegExp("^".concat(e,"$"))}}],e&&mn(t.prototype,e),r&&mn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function xn(t){return xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xn(t)}function kn(){kn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=_(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new E(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==xn(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function x(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function E(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(xn(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function En(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Sn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){En(i,n,o,a,s,"next",t)}function s(t){En(i,n,o,a,s,"throw",t)}a(void 0)}))}}function On(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pn(n.key),n)}}function Pn(t){var e=function(t,e){if("object"!=xn(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=xn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xn(e)?e:e+""}document.addEventListener("DOMContentLoaded",(function(){var t=document.querySelector(".skip-link");t&&t.addEventListener("click",(function(t){t.preventDefault();var e=document.getElementById("mainContent");e&&(e.hasAttribute("tabindex")||e.setAttribute("tabindex","-1"),e.focus(),e.scrollIntoView())}));var e=document.getElementById("appBar"),r=document.createElement("app-bar");e.appendChild(r),(new _n).init()}));var jn=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._deferredPrompt=null,this._setupEventListeners()},e=[{key:"_setupEventListeners",value:function(){var t=this;window.addEventListener("beforeinstallprompt",(function(e){e.preventDefault(),t._deferredPrompt=e,t._showInstallPromotion()})),window.addEventListener("appinstalled",(function(){t._hideInstallPromotion(),t._deferredPrompt=null,t._showSuccessfulInstallMessage()}))}},{key:"_showInstallPromotion",value:function(){var t=this;if(!this._isAlreadyInstalled()){var e=document.getElementById("install-button");e?(e.style.display="block",e.addEventListener("click",(function(){return t.promptInstall()}))):this._showInstallToast()}}},{key:"_hideInstallPromotion",value:function(){var t=document.getElementById("install-button");t&&(t.style.display="none")}},{key:"_showInstallToast",value:function(){var t=this;setTimeout((function(){g().fire({title:"Pasang Aplikasi?",text:"Pasang aplikasi ini ke layar utama untuk pengalaman yang lebih baik",icon:"info",showCancelButton:!0,confirmButtonColor:"#2563EB",cancelButtonColor:"#6B7280",confirmButtonText:"Pasang Sekarang",cancelButtonText:"Nanti Saja"}).then((function(e){e.isConfirmed&&t.promptInstall()}))}),3e3)}},{key:"_showSuccessfulInstallMessage",value:function(){g().fire({title:"Pemasangan Berhasil!",text:"Aplikasi telah terpasang di layar utama Anda",icon:"success",confirmButtonColor:"#2563EB"})}},{key:"_isAlreadyInstalled",value:function(){return window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone}},{key:"promptInstall",value:(n=Sn(kn().mark((function t(){return kn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._deferredPrompt){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,this._deferredPrompt.prompt(),t.next=7,this._deferredPrompt.userChoice;case 7:t.sent.outcome,this._deferredPrompt=null,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3);case 15:case"end":return t.stop()}}),t,this,[[3,12]])}))),function(){return n.apply(this,arguments)})},{key:"canInstall",value:function(){return!!this._deferredPrompt}}],e&&On(t.prototype,e),r&&On(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}());function Tn(){return Fn.apply(this,arguments)}function Fn(){return(Fn=Sn(kn().mark((function t(){var e;return kn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S();case 3:if(!(e=t.sent)){t.next=8;break}return t.next=7,bt.init();case 7:case 8:return window.addEventListener("offline",(function(){})),window.addEventListener("online",(function(){ft.syncOfflineQueue()})),window.webPushHelper=bt,window.swRegistration=e,t.abrupt("return",e);case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",null);case 19:case"end":return t.stop()}}),t,null,[[0,15]])})))).apply(this,arguments)}function Ln(){return In.apply(this,arguments)}function In(){return(In=Sn(kn().mark((function t(){var e,r;return kn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=3,r=0;case 2:if(!(r<e)){t.next=39;break}return t.prev=3,t.next=7,tt._checkDatabaseHealth();case 7:return t.next=9,tt.getAllStories();case 9:return t.sent,window.StoryIdb=tt,t.abrupt("return",!0);case 15:if(t.prev=15,t.t0=t.catch(3),r++,!t.t0.message||!t.t0.message.includes("object stores was not found")){t.next=31;break}return t.prev=21,t.next=24,tt.resetDatabase();case 24:return t.abrupt("continue",2);case 28:t.prev=28,t.t1=t.catch(21);case 31:if(r!==e){t.next=35;break}return g().fire({title:"Database Error",text:"There was an issue initializing the local database. Some features may not work properly. Please try refreshing the page.",icon:"warning",confirmButtonColor:"#2563EB",confirmButtonText:"Refresh Page"}).then((function(t){t.isConfirmed&&window.location.reload()})),t.abrupt("return",!1);case 35:return t.next=37,new Promise((function(t){return setTimeout(t,1e3*r)}));case 37:t.next=2;break;case 39:case"end":return t.stop()}}),t,null,[[3,15],[21,28]])})))).apply(this,arguments)}function Cn(){return(Cn=Sn(kn().mark((function t(){return kn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,Tn();case 4:return t.next=6,Ln();case 6:t.sent&&navigator.onLine&&ft.syncOfflineQueue(),window.installablePWA=jn,t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),g().fire({title:"Initialization Error",text:"There was a critical error starting the application. Please refresh the page and try again.",icon:"error",confirmButtonColor:"#2563EB",confirmButtonText:"Refresh Page"}).then((function(){window.location.reload()}));case 16:case"end":return t.stop()}}),t,null,[[1,12]])})))).apply(this,arguments)}window.addEventListener("error",(function(t){t.error&&t.error.message&&t.error.message.includes("object stores was not found")&&tt.resetDatabase().then((function(){window.location.reload()})).catch((function(t){}))})),document.addEventListener("DOMContentLoaded",(function(){return Cn.apply(this,arguments)}))}},r={};function n(t){var o=r[t];if(void 0!==o)return o.exports;var i=r[t]={id:t,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.exports}n.m=e,t=[],n.O=(e,r,o,i)=>{if(!r){var a=1/0;for(l=0;l<t.length;l++){for(var[r,o,i]=t[l],s=!0,u=0;u<r.length;u++)(!1&i||a>=i)&&Object.keys(n.O).every((t=>n.O[t](r[u])))?r.splice(u--,1):(s=!1,i<a&&(a=i));if(s){t.splice(l--,1);var c=o();void 0!==c&&(e=c)}}return e}i=i||0;for(var l=t.length;l>0&&t[l-1][2]>i;l--)t[l]=t[l-1];t[l]=[r,o,i]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),(()=>{var t={524:0};n.O.j=e=>0===t[e];var e=(e,r)=>{var o,i,[a,s,u]=r,c=0;if(a.some((e=>0!==t[e]))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(u)var l=u(n)}for(e&&e(r);c<a.length;c++)i=a[c],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(l)},r=self.webpackChunkdicoding_story=self.webpackChunkdicoding_story||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})(),n.nc=void 0;var o=n.O(void 0,[868],(()=>n(958)));o=n.O(o)})();
//# sourceMappingURL=app.12c041f4decf5aa6e5ac.js.map